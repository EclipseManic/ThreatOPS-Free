2025-10-27 07:59:35,700 - run - INFO - Mode: simulation
2025-10-27 07:59:37,749 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 07:59:37,758 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 07:59:37,759 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 07:59:37,759 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 07:59:37,770 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 07:59:37,770 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 07:59:37,772 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 07:59:37,772 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 07:59:37,772 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 07:59:37,773 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 07:59:37,773 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 07:59:37,773 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 07:59:37,773 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 07:59:37,773 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 07:59:37,774 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 07:59:37,774 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 07:59:37,775 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 07:59:37,775 - run - INFO - Initialization complete
2025-10-27 07:59:37,776 - run - INFO - Running attack simulation
2025-10-27 07:59:37,777 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-27 07:59:37,777 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-27 07:59:37,777 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-27 07:59:37,778 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-27 07:59:37,779 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-27 07:59:37,779 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-27 07:59:37,780 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-27 07:59:37,780 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-27 07:59:37,781 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-27 07:59:37,781 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-27 07:59:37,783 - detection.threat_detector - INFO - Rule engine generated 31 alerts
2025-10-27 07:59:37,783 - detection.threat_detector - INFO - Training ML model...
2025-10-27 07:59:37,784 - detection.threat_detector - WARNING - Not enough samples for training: 390 < 1000
2025-10-27 07:59:37,784 - detection.threat_detector - INFO - ML detector generated 0 alerts
2025-10-27 07:59:37,785 - detection.threat_detector - INFO - Total unique alerts generated: 27
2025-10-27 07:59:37,785 - enrichment.intel_enricher - INFO - Enriching 27 alerts with threat intelligence...
2025-10-27 07:59:37,788 - enrichment.intel_enricher - INFO - Enriched 27 alerts
2025-10-27 07:59:37,788 - scoring.risk_scorer - INFO - Scoring 27 alerts...
2025-10-27 07:59:37,789 - scoring.risk_scorer - INFO - Scored 27 alerts
2025-10-27 07:59:37,790 - run - INFO - Simulation produced 27 scored alerts
2025-10-27 07:59:37,790 - run - INFO - Mode: test — running pytest
2025-10-27 07:59:41,284 - run - INFO - Mode: dashboard
2025-10-27 07:59:41,284 - run - INFO - Starting dashboard (blocking)
2025-10-27 07:59:42,257 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:00:01,861 - run - INFO - Interrupted by user
2025-10-27 08:00:20,402 - run - INFO - Mode: simulation
2025-10-27 08:00:22,219 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:00:22,314 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:00:22,315 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:00:22,315 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:00:22,328 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:00:22,328 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:00:22,330 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:00:22,331 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:00:22,331 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:00:22,331 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:00:22,331 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:00:22,331 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:00:22,332 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:00:22,332 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:00:22,333 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:00:22,333 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:00:22,333 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:00:22,333 - run - INFO - Initialization complete
2025-10-27 08:00:22,335 - run - INFO - Running attack simulation
2025-10-27 08:00:22,338 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-27 08:00:22,339 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-27 08:00:22,339 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-27 08:00:22,340 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-27 08:00:22,340 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-27 08:00:22,340 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-27 08:00:22,341 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-27 08:00:22,341 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-27 08:00:22,342 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-27 08:00:22,342 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-27 08:00:22,343 - detection.threat_detector - INFO - Rule engine generated 29 alerts
2025-10-27 08:00:22,343 - detection.threat_detector - INFO - Training ML model...
2025-10-27 08:00:22,345 - detection.threat_detector - WARNING - Not enough samples for training: 390 < 1000
2025-10-27 08:00:22,345 - detection.threat_detector - INFO - ML detector generated 0 alerts
2025-10-27 08:00:22,346 - detection.threat_detector - INFO - Total unique alerts generated: 21
2025-10-27 08:00:22,346 - enrichment.intel_enricher - INFO - Enriching 21 alerts with threat intelligence...
2025-10-27 08:00:22,349 - enrichment.intel_enricher - INFO - Enriched 21 alerts
2025-10-27 08:00:22,350 - scoring.risk_scorer - INFO - Scoring 21 alerts...
2025-10-27 08:00:22,350 - scoring.risk_scorer - INFO - Scored 21 alerts
2025-10-27 08:00:22,351 - run - INFO - Simulation produced 21 scored alerts
2025-10-27 08:00:22,351 - run - INFO - Mode: test — running pytest
2025-10-27 08:00:25,343 - run - INFO - Mode: dashboard
2025-10-27 08:00:25,343 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:00:25,730 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:00:45,972 - run - INFO - Interrupted by user
2025-10-27 08:08:57,441 - run - INFO - Mode: dashboard
2025-10-27 08:08:59,524 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:08:59,588 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:08:59,589 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:08:59,589 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:08:59,598 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:08:59,599 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:08:59,600 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:08:59,600 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:08:59,600 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:08:59,600 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:08:59,601 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:08:59,601 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:08:59,601 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:08:59,601 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:08:59,601 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:08:59,601 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:08:59,602 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:08:59,602 - run - INFO - Initialization complete
2025-10-27 08:08:59,602 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:08:59,985 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:09:20,787 - run - INFO - Interrupted by user
2025-10-27 08:10:17,285 - run - INFO - Mode: dashboard
2025-10-27 08:10:19,403 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:10:19,419 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:10:19,420 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:10:19,420 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:10:19,429 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:10:19,429 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:10:19,431 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:10:19,431 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:10:19,431 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:10:19,432 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:10:19,432 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:10:19,432 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:10:19,433 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:10:19,433 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:10:19,434 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:10:19,434 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:10:19,434 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:10:19,434 - run - INFO - Initialization complete
2025-10-27 08:10:19,435 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:10:19,886 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:10:38,578 - run - INFO - Interrupted by user
2025-10-27 08:15:23,651 - run - INFO - Mode: dashboard
2025-10-27 08:15:26,531 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:15:26,544 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:15:26,544 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:15:26,544 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:15:26,554 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:15:26,554 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:15:26,555 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:15:26,555 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:15:26,556 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:15:26,558 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:15:26,558 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:15:26,558 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:15:26,558 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:15:26,559 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:15:26,559 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:15:26,560 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:15:26,560 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:15:26,561 - run - INFO - Initialization complete
2025-10-27 08:15:26,561 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:15:27,031 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:15:47,496 - run - INFO - Interrupted by user
2025-10-27 08:16:37,233 - run - INFO - Mode: dashboard
2025-10-27 08:16:39,106 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:16:39,120 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:16:39,120 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:16:39,120 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:16:39,126 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:16:39,126 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:16:39,127 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:16:39,128 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:16:39,128 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:16:39,128 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:16:39,128 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:16:39,128 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:16:39,128 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:16:39,128 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:16:39,128 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:16:39,128 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:16:39,128 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:16:39,128 - run - INFO - Initialization complete
2025-10-27 08:16:39,129 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:16:39,492 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:17:27,030 - run - INFO - Interrupted by user
2025-10-27 08:18:18,356 - run - INFO - Mode: simulation
2025-10-27 08:18:36,472 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:18:36,482 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:18:36,482 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:18:36,482 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:18:36,516 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:18:36,516 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:18:36,518 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:18:36,518 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:18:36,518 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:18:36,519 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:18:36,519 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:18:36,519 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:18:36,519 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:18:36,519 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:18:36,520 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:18:36,521 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:18:36,522 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:18:36,522 - run - INFO - Initialization complete
2025-10-27 08:18:36,523 - run - INFO - Running attack simulation
2025-10-27 08:18:36,524 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-27 08:18:36,525 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-27 08:18:36,525 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-27 08:18:36,527 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-27 08:18:36,528 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-27 08:18:36,528 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-27 08:18:36,529 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-27 08:18:36,529 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-27 08:18:36,530 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-27 08:18:36,530 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-27 08:18:36,532 - detection.threat_detector - INFO - Rule engine generated 25 alerts
2025-10-27 08:18:36,532 - detection.threat_detector - INFO - Training ML model...
2025-10-27 08:18:36,534 - detection.threat_detector - WARNING - Not enough samples for training: 390 < 1000
2025-10-27 08:18:36,534 - detection.threat_detector - INFO - ML detector generated 0 alerts
2025-10-27 08:18:36,534 - detection.threat_detector - INFO - Total unique alerts generated: 19
2025-10-27 08:18:36,534 - enrichment.intel_enricher - INFO - Enriching 19 alerts with threat intelligence...
2025-10-27 08:18:36,538 - enrichment.intel_enricher - INFO - Enriched 19 alerts
2025-10-27 08:18:36,538 - scoring.risk_scorer - INFO - Scoring 19 alerts...
2025-10-27 08:18:36,539 - scoring.risk_scorer - INFO - Scored 19 alerts
2025-10-27 08:18:36,540 - run - INFO - Simulation produced 19 scored alerts
2025-10-27 08:18:36,541 - run - INFO - Mode: test — running pytest
2025-10-27 08:18:40,097 - run - INFO - Mode: dashboard
2025-10-27 08:18:40,097 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:18:40,597 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:18:58,236 - run - INFO - Interrupted by user
2025-10-27 08:19:32,167 - run - INFO - Mode: dashboard
2025-10-27 08:19:33,957 - run - ERROR - Fatal error while running: unexpected indent (app.py, line 203)
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 252, in main
    soc = ThreatOpsSOC()
  File "D:\Cusor AI\threat_ops\run.py", line 109, in __init__
    from dashboard.app import SOCDashboard
  File "D:\Cusor AI\threat_ops\dashboard\__init__.py", line 3, in <module>
    from .app import SOCDashboard
  File "D:\Cusor AI\threat_ops\dashboard\app.py", line 203
    html = alerts_chart.to_html(include_plotlyjs='cdn', full_html=False, config={})
IndentationError: unexpected indent
2025-10-27 08:20:09,302 - run - INFO - Mode: dashboard
2025-10-27 08:20:12,249 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:20:12,265 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:20:12,266 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:20:12,266 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:20:12,285 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:20:12,285 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:20:12,287 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:20:12,287 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:20:12,288 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:20:12,288 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:20:12,288 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:20:12,288 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:20:12,289 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:20:12,289 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:20:12,290 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:20:12,290 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:20:12,291 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:20:12,291 - run - INFO - Initialization complete
2025-10-27 08:20:12,293 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:20:13,084 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:21:26,843 - run - INFO - Interrupted by user
2025-10-27 08:23:21,986 - run - INFO - Mode: dashboard
2025-10-27 08:23:24,359 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:23:24,372 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:23:24,372 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:23:24,372 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:23:24,383 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:23:24,383 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:23:24,385 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:23:24,385 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:23:24,385 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:23:24,386 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:23:24,386 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:23:24,386 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:23:24,386 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:23:24,386 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:23:24,387 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:23:24,387 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:23:24,388 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:23:24,388 - run - INFO - Initialization complete
2025-10-27 08:23:24,388 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:23:24,791 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:23:39,114 - run - INFO - Interrupted by user
2025-10-27 08:24:45,784 - run - INFO - Mode: dashboard
2025-10-27 08:24:48,071 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:24:48,100 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:24:48,100 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:24:48,101 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:24:48,108 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:24:48,108 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:24:48,109 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:24:48,109 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:24:48,109 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:24:48,110 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:24:48,110 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:24:48,110 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:24:48,110 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:24:48,110 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:24:48,111 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:24:48,111 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:24:48,112 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:24:48,112 - run - INFO - Initialization complete
2025-10-27 08:24:48,113 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:24:48,556 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:25:02,736 - run - INFO - Interrupted by user
2025-10-27 08:25:26,229 - run - INFO - Mode: dashboard
2025-10-27 08:25:29,518 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:25:29,582 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:25:29,582 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:25:29,583 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:25:29,596 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:25:29,597 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:25:29,599 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:25:29,599 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:25:29,599 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:25:29,600 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:25:29,600 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:25:29,600 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:25:29,600 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:25:29,600 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:25:29,601 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:25:29,601 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:25:29,602 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:25:29,602 - run - INFO - Initialization complete
2025-10-27 08:25:29,603 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:25:30,070 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:25:46,570 - run - INFO - Interrupted by user
2025-10-27 08:27:59,900 - run - INFO - Mode: dashboard
2025-10-27 08:28:02,113 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:28:02,126 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:28:02,126 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:28:02,126 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:28:02,137 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:28:02,138 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:28:02,139 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:28:02,139 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:28:02,139 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:28:02,140 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:28:02,140 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:28:02,140 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:28:02,140 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:28:02,140 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:28:02,141 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:28:02,141 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:28:02,142 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:28:02,142 - run - INFO - Initialization complete
2025-10-27 08:28:02,143 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:28:02,601 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:28:21,751 - run - INFO - Interrupted by user
2025-10-27 08:35:35,183 - run - INFO - Mode: simulation
2025-10-27 08:35:37,156 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-27 08:35:37,164 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-27 08:35:37,164 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:35:37,164 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-27 08:35:37,172 - run - INFO - Initializing ThreatOps SOC components...
2025-10-27 08:35:37,172 - collectors.log_collector - INFO - Initializing log collector...
2025-10-27 08:35:37,173 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-27 08:35:37,173 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-27 08:35:37,173 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-27 08:35:37,174 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-27 08:35:37,174 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-27 08:35:37,174 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-27 08:35:37,174 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-27 08:35:37,174 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-27 08:35:37,174 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-27 08:35:37,175 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-27 08:35:37,175 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-27 08:35:37,175 - run - INFO - Initialization complete
2025-10-27 08:35:37,176 - run - INFO - Running attack simulation
2025-10-27 08:35:37,177 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-27 08:35:37,177 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-27 08:35:37,178 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-27 08:35:37,179 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-27 08:35:37,180 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-27 08:35:37,181 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-27 08:35:37,182 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-27 08:35:37,182 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-27 08:35:37,182 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-27 08:35:37,183 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-27 08:35:37,184 - detection.threat_detector - INFO - Rule engine generated 29 alerts
2025-10-27 08:35:37,184 - detection.threat_detector - INFO - Training ML model...
2025-10-27 08:35:37,185 - detection.threat_detector - WARNING - Not enough samples for training: 390 < 1000
2025-10-27 08:35:37,185 - detection.threat_detector - INFO - ML detector generated 0 alerts
2025-10-27 08:35:37,186 - detection.threat_detector - INFO - Total unique alerts generated: 23
2025-10-27 08:35:37,186 - enrichment.intel_enricher - INFO - Enriching 23 alerts with threat intelligence...
2025-10-27 08:35:37,188 - enrichment.intel_enricher - INFO - Enriched 23 alerts
2025-10-27 08:35:37,188 - scoring.risk_scorer - INFO - Scoring 23 alerts...
2025-10-27 08:35:37,189 - scoring.risk_scorer - INFO - Scored 23 alerts
2025-10-27 08:35:37,189 - run - INFO - Simulation produced 23 scored alerts
2025-10-27 08:35:37,189 - run - INFO - Mode: test — running pytest
2025-10-27 08:35:40,481 - run - INFO - Mode: dashboard
2025-10-27 08:35:40,481 - run - INFO - Starting dashboard (blocking)
2025-10-27 08:35:40,873 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-27 08:38:04,447 - run - INFO - Interrupted by user
2025-10-28 05:51:51,388 - run - INFO - Mode: simulation
2025-10-28 05:51:56,494 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 05:51:56,514 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 05:51:56,515 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 05:51:56,515 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 05:51:56,536 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 05:51:56,536 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 05:51:56,538 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 05:51:56,539 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 05:51:56,539 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 05:51:56,539 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 05:51:56,540 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 05:51:56,540 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 05:51:56,540 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 05:51:56,541 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 05:51:56,542 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 05:51:56,542 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 05:51:56,542 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 05:51:56,543 - run - INFO - Initialization complete
2025-10-28 05:51:56,544 - run - INFO - Running attack simulation
2025-10-28 05:51:56,545 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 05:51:56,546 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 05:51:56,546 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 05:51:56,547 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 05:51:56,548 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 05:51:56,549 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 05:51:56,549 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 05:51:56,550 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 05:51:56,550 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 05:51:56,551 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 05:51:56,551 - detection.threat_detector - INFO - Filtered 17 whitelisted log entries
2025-10-28 05:51:56,554 - detection.threat_detector - INFO - Rule engine generated 30 alerts
2025-10-28 05:51:56,554 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 05:51:56,555 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 05:51:56,776 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 05:51:56,798 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 05:51:56,802 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 05:51:56,830 - detection.threat_detector - INFO - Total unique alerts generated: 59
2025-10-28 05:51:56,831 - enrichment.intel_enricher - INFO - Enriching 59 alerts with threat intelligence...
2025-10-28 05:51:56,856 - enrichment.intel_enricher - INFO - Enriched 59 alerts
2025-10-28 05:51:56,857 - scoring.risk_scorer - INFO - Scoring 59 alerts...
2025-10-28 05:51:56,859 - scoring.risk_scorer - INFO - Scored 59 alerts
2025-10-28 05:51:56,860 - run - INFO - Simulation produced 59 scored alerts
2025-10-28 05:51:56,861 - run - INFO - Mode: test — running pytest
2025-10-28 05:52:02,442 - run - INFO - Mode: dashboard
2025-10-28 05:52:02,443 - run - INFO - Starting dashboard (blocking)
2025-10-28 05:52:03,211 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-28 05:53:54,208 - run - INFO - Interrupted by user
2025-10-28 05:56:06,862 - run - INFO - Mode: simulation
2025-10-28 05:56:10,292 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 05:56:10,457 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 05:56:10,457 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 05:56:10,458 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 05:56:10,475 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 05:56:10,475 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 05:56:10,477 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 05:56:10,477 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 05:56:10,477 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 05:56:10,477 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 05:56:10,477 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 05:56:10,478 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 05:56:10,478 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 05:56:10,478 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 05:56:10,478 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 05:56:10,479 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 05:56:10,479 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 05:56:10,480 - run - INFO - Initialization complete
2025-10-28 05:56:10,481 - run - INFO - Running attack simulation
2025-10-28 05:56:10,482 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 05:56:10,483 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 05:56:10,484 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 05:56:10,486 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 05:56:10,487 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 05:56:10,488 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 05:56:10,490 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 05:56:10,490 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 05:56:10,491 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 05:56:10,491 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 05:56:10,492 - detection.threat_detector - INFO - Filtered 14 whitelisted log entries
2025-10-28 05:56:10,496 - detection.threat_detector - INFO - Rule engine generated 26 alerts
2025-10-28 05:56:10,497 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 05:56:10,498 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 05:56:10,668 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 05:56:10,688 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 05:56:10,689 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 05:56:10,690 - detection.threat_detector - INFO - Total unique alerts generated: 58
2025-10-28 05:56:10,690 - enrichment.intel_enricher - INFO - Enriching 58 alerts with threat intelligence...
2025-10-28 05:56:10,712 - enrichment.intel_enricher - INFO - Enriched 58 alerts
2025-10-28 05:56:10,712 - scoring.risk_scorer - INFO - Scoring 58 alerts...
2025-10-28 05:56:10,716 - scoring.risk_scorer - INFO - Scored 58 alerts
2025-10-28 05:56:10,717 - run - INFO - Simulation produced 58 scored alerts
2025-10-28 05:56:10,718 - run - INFO - Run completed successfully
2025-10-28 05:56:40,917 - run - INFO - Mode: simulation
2025-10-28 05:56:44,383 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 05:56:44,440 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 05:56:44,442 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 05:56:44,442 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 05:56:44,460 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 05:56:44,460 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 05:56:44,463 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 05:56:44,463 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 05:56:44,464 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 05:56:44,464 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 05:56:44,465 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 05:56:44,465 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 05:56:44,465 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 05:56:44,466 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 05:56:44,466 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 05:56:44,466 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 05:56:44,467 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 05:56:44,468 - run - INFO - Initialization complete
2025-10-28 05:56:44,471 - run - INFO - Running attack simulation
2025-10-28 05:56:44,475 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 05:56:44,475 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 05:56:44,476 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 05:56:44,478 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 05:56:44,479 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 05:56:44,480 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 05:56:44,481 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 05:56:44,482 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 05:56:44,482 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 05:56:44,483 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 05:56:44,484 - detection.threat_detector - INFO - Filtered 14 whitelisted log entries
2025-10-28 05:56:44,486 - detection.threat_detector - INFO - Rule engine generated 35 alerts
2025-10-28 05:56:44,487 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 05:56:44,488 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 05:56:44,657 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 05:56:44,682 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 05:56:44,683 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 05:56:44,683 - detection.threat_detector - INFO - Total unique alerts generated: 62
2025-10-28 05:56:44,684 - enrichment.intel_enricher - INFO - Enriching 62 alerts with threat intelligence...
2025-10-28 05:56:44,712 - enrichment.intel_enricher - INFO - Enriched 62 alerts
2025-10-28 05:56:44,713 - scoring.risk_scorer - INFO - Scoring 62 alerts...
2025-10-28 05:56:44,715 - scoring.risk_scorer - INFO - Scored 62 alerts
2025-10-28 05:56:44,717 - run - INFO - Simulation produced 62 scored alerts
2025-10-28 05:56:44,717 - run - INFO - Run completed successfully
2025-10-28 06:01:22,379 - run - INFO - Mode: simulation
2025-10-28 06:01:25,875 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 06:01:25,927 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 06:01:25,928 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:01:25,928 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:01:25,943 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 06:01:25,944 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 06:01:25,946 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 06:01:25,946 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 06:01:25,946 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 06:01:25,947 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 06:01:25,947 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 06:01:25,947 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 06:01:25,947 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 06:01:25,948 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 06:01:25,948 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 06:01:25,948 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 06:01:25,949 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 06:01:25,949 - run - INFO - Initialization complete
2025-10-28 06:01:25,952 - run - INFO - Running attack simulation
2025-10-28 06:01:25,953 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 06:01:25,954 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 06:01:25,954 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 06:01:25,955 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 06:01:25,956 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 06:01:25,956 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 06:01:25,957 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 06:01:25,957 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 06:01:25,958 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 06:01:25,958 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 06:01:25,959 - detection.threat_detector - INFO - Filtered 16 whitelisted log entries
2025-10-28 06:01:25,961 - detection.threat_detector - INFO - Rule engine generated 23 alerts
2025-10-28 06:01:25,962 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 06:01:25,962 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 06:01:26,144 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 06:01:26,162 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 06:01:26,162 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 06:01:26,163 - detection.threat_detector - INFO - Total unique alerts generated: 53
2025-10-28 06:01:26,164 - enrichment.intel_enricher - INFO - Enriching 53 alerts with threat intelligence...
2025-10-28 06:01:26,189 - enrichment.intel_enricher - INFO - Enriched 53 alerts
2025-10-28 06:01:26,191 - scoring.risk_scorer - INFO - Scoring 53 alerts...
2025-10-28 06:01:26,193 - scoring.risk_scorer - INFO - Scored 53 alerts
2025-10-28 06:01:26,194 - run - INFO - Simulation produced 53 scored alerts
2025-10-28 06:01:26,196 - run - INFO - Run completed successfully
2025-10-28 06:01:42,080 - run - INFO - Mode: simulation
2025-10-28 06:01:45,623 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 06:01:45,733 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 06:01:45,734 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:01:45,735 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:01:45,749 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 06:01:45,749 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 06:01:45,751 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 06:01:45,752 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 06:01:45,752 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 06:01:45,752 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 06:01:45,753 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 06:01:45,754 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 06:01:45,755 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 06:01:45,755 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 06:01:45,757 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 06:01:45,757 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 06:01:45,758 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 06:01:45,759 - run - INFO - Initialization complete
2025-10-28 06:01:45,761 - run - INFO - Running attack simulation
2025-10-28 06:01:45,767 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 06:01:45,767 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 06:01:45,768 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 06:01:45,769 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 06:01:45,770 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 06:01:45,773 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 06:01:45,774 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 06:01:45,774 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 06:01:45,776 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 06:01:45,776 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 06:01:45,777 - detection.threat_detector - INFO - Filtered 20 whitelisted log entries
2025-10-28 06:01:45,778 - detection.threat_detector - INFO - Rule engine generated 26 alerts
2025-10-28 06:01:45,779 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 06:01:45,779 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 06:01:45,957 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 06:01:45,977 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 06:01:45,978 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 06:01:45,978 - detection.threat_detector - INFO - Total unique alerts generated: 56
2025-10-28 06:01:45,979 - enrichment.intel_enricher - INFO - Enriching 56 alerts with threat intelligence...
2025-10-28 06:01:46,000 - enrichment.intel_enricher - INFO - Enriched 56 alerts
2025-10-28 06:01:46,001 - scoring.risk_scorer - INFO - Scoring 56 alerts...
2025-10-28 06:01:46,004 - scoring.risk_scorer - INFO - Scored 56 alerts
2025-10-28 06:01:46,006 - run - INFO - Simulation produced 56 scored alerts
2025-10-28 06:01:46,007 - run - INFO - Mode: test — running pytest
2025-10-28 06:01:51,392 - run - INFO - Mode: dashboard
2025-10-28 06:01:51,392 - run - INFO - Starting dashboard (blocking)
2025-10-28 06:01:52,023 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-28 06:05:03,853 - run - INFO - Interrupted by user
2025-10-28 06:08:28,400 - run - INFO - Mode: simulation
2025-10-28 06:08:28,403 - run - ERROR - Fatal error while running: No module named 'yaml'
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 308, in main
    soc = ThreatOpsSOC()
  File "D:\Cusor AI\threat_ops\run.py", line 103, in __init__
    from config.settings import Settings
  File "D:\Cusor AI\threat_ops\config\__init__.py", line 3, in <module>
    from .settings import Settings, LogSourceConfig, DetectionRuleConfig, APIConfig, MLConfig, RiskScoringConfig
  File "D:\Cusor AI\threat_ops\config\settings.py", line 4, in <module>
    import yaml
ModuleNotFoundError: No module named 'yaml'
2025-10-28 06:08:49,171 - run - INFO - Installing dependencies from requirements.txt (this may take a while)
2025-10-28 06:10:01,871 - run - INFO - Mode: simulation
2025-10-28 06:10:05,644 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 06:10:05,687 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 06:10:05,688 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:10:05,688 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:10:05,700 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 06:10:05,700 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 06:10:05,702 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 06:10:05,702 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 06:10:05,702 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 06:10:05,702 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 06:10:05,702 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 06:10:05,702 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 06:10:05,702 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 06:10:05,703 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 06:10:05,703 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 06:10:05,703 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 06:10:05,703 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 06:10:05,704 - reporting.report_generator - INFO - Initializing report generator...
2025-10-28 06:10:05,704 - reporting.report_generator - INFO - Report generator initialized successfully
2025-10-28 06:10:05,704 - run - INFO - Initialization complete
2025-10-28 06:10:05,706 - run - INFO - Running attack simulation
2025-10-28 06:10:05,707 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 06:10:05,707 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 06:10:05,708 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 06:10:05,708 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 06:10:05,709 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 06:10:05,709 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 06:10:05,710 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 06:10:05,710 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 06:10:05,710 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 06:10:05,710 - run - INFO - Generated 390 simulated log entries
2025-10-28 06:10:05,718 - collectors.log_collector - INFO - Saved 390 logs to data\logs\simulated_logs.json
2025-10-28 06:10:05,718 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 06:10:05,718 - detection.threat_detector - INFO - Filtered 11 whitelisted log entries
2025-10-28 06:10:05,719 - detection.threat_detector - INFO - Rule engine generated 30 alerts
2025-10-28 06:10:05,719 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 06:10:05,720 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 06:10:05,934 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 06:10:05,951 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 06:10:05,952 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 06:10:05,952 - detection.threat_detector - INFO - Total unique alerts generated: 61
2025-10-28 06:10:05,952 - run - INFO - Detected 61 alerts
2025-10-28 06:10:05,952 - enrichment.intel_enricher - INFO - Enriching 61 alerts with threat intelligence...
2025-10-28 06:10:05,971 - enrichment.intel_enricher - INFO - Enriched 61 alerts
2025-10-28 06:10:05,972 - run - INFO - Enriched 61 alerts with threat intelligence
2025-10-28 06:10:05,972 - scoring.risk_scorer - INFO - Scoring 61 alerts...
2025-10-28 06:10:05,974 - scoring.risk_scorer - INFO - Scored 61 alerts
2025-10-28 06:10:05,974 - run - INFO - Scored 61 alerts with risk scores
2025-10-28 06:10:05,981 - run - INFO - Saved 61 alerts to data\alerts\alerts_20251028_061005.json
2025-10-28 06:10:05,983 - run - INFO - Simulation produced 61 scored alerts
2025-10-28 06:10:05,984 - run - INFO - Generating report for simulated threats...
2025-10-28 06:10:05,984 - run - INFO - Generating report
2025-10-28 06:10:05,985 - reporting.report_generator - INFO - Generating daily SOC report...
2025-10-28 06:10:06,994 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:10:06,998 - run - ERROR - Fatal error while running: 'dict' object has no attribute 'title'
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 316, in main
    report_path = asyncio.run(soc.generate_report())
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\run.py", line 220, in generate_report
    path = await self.report_generator.generate_daily_report()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\reporting\report_generator.py", line 984, in generate_daily_report
    pdf_content = self.pdf_generator.generate_report(report_data)
  File "D:\Cusor AI\threat_ops\reporting\report_generator.py", line 526, in generate_report
    content.append(Paragraph(f"<b>{rec.title}</b> - {rec.priority}", self.styles['Normal']))
                                   ^^^^^^^^^
AttributeError: 'dict' object has no attribute 'title'
2025-10-28 06:10:37,055 - run - INFO - Mode: simulation
2025-10-28 06:10:40,984 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 06:10:41,000 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 06:10:41,001 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:10:41,001 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:10:41,011 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 06:10:41,011 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 06:10:41,012 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 06:10:41,012 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 06:10:41,012 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 06:10:41,012 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 06:10:41,013 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 06:10:41,013 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 06:10:41,013 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 06:10:41,013 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 06:10:41,013 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 06:10:41,013 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 06:10:41,013 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 06:10:41,013 - reporting.report_generator - INFO - Initializing report generator...
2025-10-28 06:10:41,014 - reporting.report_generator - INFO - Report generator initialized successfully
2025-10-28 06:10:41,014 - run - INFO - Initialization complete
2025-10-28 06:10:41,016 - run - INFO - Running attack simulation
2025-10-28 06:10:41,018 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 06:10:41,018 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 06:10:41,019 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 06:10:41,019 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 06:10:41,020 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 06:10:41,020 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 06:10:41,021 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 06:10:41,021 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 06:10:41,021 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 06:10:41,021 - run - INFO - Generated 390 simulated log entries
2025-10-28 06:10:41,027 - collectors.log_collector - INFO - Saved 390 logs to data\logs\simulated_logs.json
2025-10-28 06:10:41,027 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 06:10:41,027 - detection.threat_detector - INFO - Filtered 20 whitelisted log entries
2025-10-28 06:10:41,029 - detection.threat_detector - INFO - Rule engine generated 28 alerts
2025-10-28 06:10:41,029 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 06:10:41,029 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 06:10:41,190 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 06:10:41,207 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 06:10:41,207 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 06:10:41,207 - detection.threat_detector - INFO - Total unique alerts generated: 59
2025-10-28 06:10:41,207 - run - INFO - Detected 59 alerts
2025-10-28 06:10:41,208 - enrichment.intel_enricher - INFO - Enriching 59 alerts with threat intelligence...
2025-10-28 06:10:41,229 - enrichment.intel_enricher - INFO - Enriched 59 alerts
2025-10-28 06:10:41,229 - run - INFO - Enriched 59 alerts with threat intelligence
2025-10-28 06:10:41,230 - scoring.risk_scorer - INFO - Scoring 59 alerts...
2025-10-28 06:10:41,232 - scoring.risk_scorer - INFO - Scored 59 alerts
2025-10-28 06:10:41,232 - run - INFO - Scored 59 alerts with risk scores
2025-10-28 06:10:41,241 - run - INFO - Saved 59 alerts to data\alerts\alerts_20251028_061041.json
2025-10-28 06:10:41,242 - run - INFO - Simulation produced 59 scored alerts
2025-10-28 06:10:41,242 - run - INFO - Generating report for simulated threats...
2025-10-28 06:10:41,243 - run - INFO - Generating report
2025-10-28 06:10:41,243 - reporting.report_generator - INFO - Generating daily SOC report...
2025-10-28 06:10:42,425 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:10:42,448 - reporting.report_generator - INFO - Daily report generated: ['data\\reports\\daily_summary_20251028_004041.html', 'data\\reports\\daily_summary_20251028_004041.pdf', 'data\\reports\\daily_summary_20251028_004041.json']
2025-10-28 06:10:42,451 - run - INFO - Report generated at: data\reports\daily_summary_20251028_004041.html
2025-10-28 06:10:42,451 - run - INFO - Run completed successfully
2025-10-28 06:12:23,307 - run - INFO - Mode: simulation
2025-10-28 06:12:27,333 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 06:12:27,390 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 06:12:27,391 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:12:27,391 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:12:27,402 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 06:12:27,403 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 06:12:27,404 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 06:12:27,404 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 06:12:27,404 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 06:12:27,404 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 06:12:27,405 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 06:12:27,405 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 06:12:27,405 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 06:12:27,405 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 06:12:27,405 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 06:12:27,405 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 06:12:27,406 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 06:12:27,406 - reporting.report_generator - INFO - Initializing report generator...
2025-10-28 06:12:27,406 - reporting.report_generator - INFO - Report generator initialized successfully
2025-10-28 06:12:27,406 - run - INFO - Initialization complete
2025-10-28 06:12:27,408 - run - INFO - Running attack simulation
2025-10-28 06:12:27,408 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 06:12:27,409 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 06:12:27,409 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 06:12:27,410 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 06:12:27,410 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 06:12:27,410 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 06:12:27,411 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 06:12:27,411 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 06:12:27,411 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 06:12:27,411 - run - INFO - Generated 390 simulated log entries
2025-10-28 06:12:27,418 - collectors.log_collector - INFO - Saved 390 logs to data\logs\simulated_logs.json
2025-10-28 06:12:27,426 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251028_061227_20251028_061227.json
2025-10-28 06:12:27,426 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 06:12:27,426 - detection.threat_detector - INFO - Filtered 10 whitelisted log entries
2025-10-28 06:12:27,427 - detection.threat_detector - INFO - Rule engine generated 23 alerts
2025-10-28 06:12:27,427 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 06:12:27,428 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 06:12:27,584 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 06:12:27,605 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 06:12:27,605 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 06:12:27,606 - detection.threat_detector - INFO - Total unique alerts generated: 55
2025-10-28 06:12:27,606 - run - INFO - Detected 55 alerts
2025-10-28 06:12:27,606 - enrichment.intel_enricher - INFO - Enriching 55 alerts with threat intelligence...
2025-10-28 06:12:27,625 - enrichment.intel_enricher - INFO - Enriched 55 alerts
2025-10-28 06:12:27,625 - run - INFO - Enriched 55 alerts with threat intelligence
2025-10-28 06:12:27,625 - scoring.risk_scorer - INFO - Scoring 55 alerts...
2025-10-28 06:12:27,626 - scoring.risk_scorer - INFO - Scored 55 alerts
2025-10-28 06:12:27,626 - run - INFO - Scored 55 alerts with risk scores
2025-10-28 06:12:27,632 - run - INFO - Saved 55 alerts to data\alerts\alerts_20251028_061227.json
2025-10-28 06:12:27,633 - run - INFO - Simulation produced 55 scored alerts
2025-10-28 06:12:27,633 - run - INFO - Generating report for simulated threats...
2025-10-28 06:12:27,634 - run - INFO - Generating report
2025-10-28 06:12:27,634 - reporting.report_generator - INFO - Generating daily SOC report...
2025-10-28 06:12:27,757 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:12:27,793 - reporting.report_generator - INFO - Daily report generated: ['data\\reports\\daily_summary_20251028_004227.html', 'data\\reports\\daily_summary_20251028_004227.pdf', 'data\\reports\\daily_summary_20251028_004227.json']
2025-10-28 06:12:27,795 - run - INFO - Report generated at: data\reports\daily_summary_20251028_004227.html
2025-10-28 06:12:27,795 - run - INFO - Run completed successfully
2025-10-28 06:13:23,471 - run - INFO - Mode: simulation
2025-10-28 06:13:27,328 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 06:13:27,382 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 06:13:27,382 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:13:27,383 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:13:27,394 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 06:13:27,394 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 06:13:27,395 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 06:13:27,396 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 06:13:27,396 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 06:13:27,396 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 06:13:27,396 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 06:13:27,396 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 06:13:27,396 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 06:13:27,397 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 06:13:27,397 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 06:13:27,397 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 06:13:27,397 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 06:13:27,398 - reporting.report_generator - INFO - Initializing report generator...
2025-10-28 06:13:27,398 - reporting.report_generator - INFO - Report generator initialized successfully
2025-10-28 06:13:27,398 - run - INFO - Initialization complete
2025-10-28 06:13:27,400 - run - INFO - Running attack simulation
2025-10-28 06:13:27,401 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 06:13:27,402 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 06:13:27,403 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 06:13:27,405 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 06:13:27,406 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 06:13:27,406 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 06:13:27,407 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 06:13:27,407 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 06:13:27,407 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 06:13:27,408 - run - INFO - Generated 390 simulated log entries
2025-10-28 06:13:27,419 - collectors.log_collector - INFO - Saved 390 logs to data\logs\simulated_logs.json
2025-10-28 06:13:27,426 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251028_061327_20251028_061327.json
2025-10-28 06:13:27,426 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 06:13:27,427 - detection.threat_detector - INFO - Filtered 15 whitelisted log entries
2025-10-28 06:13:27,429 - detection.threat_detector - INFO - Rule engine generated 30 alerts
2025-10-28 06:13:27,429 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 06:13:27,431 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 06:13:27,589 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 06:13:27,616 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 06:13:27,616 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 06:13:27,617 - detection.threat_detector - INFO - Total unique alerts generated: 59
2025-10-28 06:13:27,617 - run - INFO - Detected 59 alerts
2025-10-28 06:13:27,618 - enrichment.intel_enricher - INFO - Enriching 59 alerts with threat intelligence...
2025-10-28 06:13:27,635 - enrichment.intel_enricher - INFO - Enriched 59 alerts
2025-10-28 06:13:27,636 - run - INFO - Enriched 59 alerts with threat intelligence
2025-10-28 06:13:27,636 - scoring.risk_scorer - INFO - Scoring 59 alerts...
2025-10-28 06:13:27,639 - scoring.risk_scorer - INFO - Scored 59 alerts
2025-10-28 06:13:27,644 - run - INFO - Scored 59 alerts with risk scores
2025-10-28 06:13:27,652 - run - INFO - Saved 59 alerts to data\alerts\alerts_20251028_061327.json
2025-10-28 06:13:27,653 - run - INFO - Simulation produced 59 scored alerts
2025-10-28 06:13:27,654 - run - INFO - Generating report for simulated threats...
2025-10-28 06:13:27,656 - run - INFO - Generating report
2025-10-28 06:13:27,656 - reporting.report_generator - INFO - Generating daily SOC report...
2025-10-28 06:13:27,795 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:13:27,859 - reporting.report_generator - INFO - Daily report generated: ['data\\reports\\daily_summary_20251028_004327.html', 'data\\reports\\daily_summary_20251028_004327.pdf', 'data\\reports\\daily_summary_20251028_004327.json']
2025-10-28 06:13:27,861 - run - INFO - Report generated at: data\reports\daily_summary_20251028_004327.html
2025-10-28 06:13:27,862 - run - INFO - Mode: test — running pytest
2025-10-28 06:13:33,728 - run - INFO - Mode: dashboard
2025-10-28 06:13:33,729 - run - INFO - Starting dashboard (blocking)
2025-10-28 06:13:34,621 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-28 06:14:00,318 - run - INFO - Mode: simulation
2025-10-28 06:14:34,444 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 06:14:34,504 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 06:14:34,505 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:14:34,505 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:14:34,523 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 06:14:34,523 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 06:14:34,525 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 06:14:34,525 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 06:14:34,525 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 06:14:34,526 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 06:14:34,526 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 06:14:34,526 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 06:14:34,526 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 06:14:34,526 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 06:14:34,527 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 06:14:34,527 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 06:14:34,528 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 06:14:34,528 - reporting.report_generator - INFO - Initializing report generator...
2025-10-28 06:14:34,528 - reporting.report_generator - INFO - Report generator initialized successfully
2025-10-28 06:14:34,529 - run - INFO - Initialization complete
2025-10-28 06:14:34,531 - run - INFO - Running attack simulation
2025-10-28 06:14:34,533 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 06:14:34,533 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 06:14:34,534 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 06:14:34,536 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 06:14:34,537 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 06:14:34,537 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 06:14:34,539 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 06:14:34,539 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 06:14:34,539 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 06:14:34,540 - run - INFO - Generated 390 simulated log entries
2025-10-28 06:14:34,557 - collectors.log_collector - INFO - Saved 390 logs to data\logs\simulated_logs.json
2025-10-28 06:14:34,557 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 06:14:34,557 - detection.threat_detector - INFO - Filtered 21 whitelisted log entries
2025-10-28 06:14:34,561 - detection.threat_detector - INFO - Rule engine generated 18 alerts
2025-10-28 06:14:34,561 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 06:14:34,562 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 06:14:34,897 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 06:14:34,931 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 06:14:34,932 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 06:14:34,932 - detection.threat_detector - INFO - Total unique alerts generated: 49
2025-10-28 06:14:34,933 - run - INFO - Detected 49 alerts
2025-10-28 06:14:34,933 - enrichment.intel_enricher - INFO - Enriching 49 alerts with threat intelligence...
2025-10-28 06:14:34,982 - enrichment.intel_enricher - INFO - Enriched 49 alerts
2025-10-28 06:14:34,983 - run - INFO - Enriched 49 alerts with threat intelligence
2025-10-28 06:14:34,983 - scoring.risk_scorer - INFO - Scoring 49 alerts...
2025-10-28 06:14:34,987 - scoring.risk_scorer - INFO - Scored 49 alerts
2025-10-28 06:14:34,987 - run - INFO - Scored 49 alerts with risk scores
2025-10-28 06:14:35,002 - run - INFO - Saved 49 alerts to data\alerts\alerts_20251028_061434.json
2025-10-28 06:14:35,003 - run - INFO - Simulation produced 49 scored alerts
2025-10-28 06:14:35,004 - run - INFO - Generating report for simulated threats...
2025-10-28 06:14:35,005 - run - INFO - Generating report
2025-10-28 06:14:35,006 - reporting.report_generator - INFO - Generating daily SOC report...
2025-10-28 06:14:35,205 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:14:35,326 - reporting.report_generator - INFO - Daily report generated: ['data\\reports\\daily_summary_20251028_004435.html', 'data\\reports\\daily_summary_20251028_004435.pdf', 'data\\reports\\daily_summary_20251028_004435.json']
2025-10-28 06:14:35,331 - run - INFO - Report generated at: data\reports\daily_summary_20251028_004435.html
2025-10-28 06:14:35,331 - run - INFO - Run completed successfully
2025-10-28 06:16:02,280 - run - INFO - Interrupted by user
2025-10-28 06:17:37,073 - run - INFO - Mode: simulation
2025-10-28 06:17:40,593 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-28 06:17:40,647 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-28 06:17:40,648 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:17:40,648 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:17:40,661 - run - INFO - Initializing ThreatOps SOC components...
2025-10-28 06:17:40,662 - collectors.log_collector - INFO - Initializing log collector...
2025-10-28 06:17:40,665 - collectors.log_collector - INFO - Log collector initialized successfully
2025-10-28 06:17:40,665 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-28 06:17:40,666 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-28 06:17:40,666 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-28 06:17:40,667 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-28 06:17:40,667 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-28 06:17:40,667 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-28 06:17:40,668 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-28 06:17:40,669 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-28 06:17:40,669 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-28 06:17:40,670 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-28 06:17:40,670 - reporting.report_generator - INFO - Initializing report generator...
2025-10-28 06:17:40,671 - reporting.report_generator - INFO - Report generator initialized successfully
2025-10-28 06:17:40,671 - run - INFO - Initialization complete
2025-10-28 06:17:40,674 - run - INFO - Running attack simulation
2025-10-28 06:17:40,677 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-28 06:17:40,678 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-28 06:17:40,679 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-28 06:17:40,680 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-28 06:17:40,681 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-28 06:17:40,682 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-28 06:17:40,683 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-28 06:17:40,684 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-28 06:17:40,684 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-28 06:17:40,686 - run - INFO - Generated 390 simulated log entries
2025-10-28 06:17:40,712 - collectors.log_collector - INFO - Saved 390 logs to data\logs\simulated_logs.json
2025-10-28 06:17:40,725 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251028_061740_20251028_061740.json
2025-10-28 06:17:40,726 - detection.threat_detector - INFO - Analyzing 390 log entries...
2025-10-28 06:17:40,726 - detection.threat_detector - INFO - Filtered 11 whitelisted log entries
2025-10-28 06:17:40,729 - detection.threat_detector - INFO - Rule engine generated 36 alerts
2025-10-28 06:17:40,730 - detection.threat_detector - INFO - Training ML model and building behavioral baseline...
2025-10-28 06:17:40,730 - detection.threat_detector - INFO - Built baseline for 10 users and 10 hosts
2025-10-28 06:17:40,914 - detection.threat_detector - INFO - ML model trained successfully
2025-10-28 06:17:40,934 - detection.threat_detector - INFO - ML detector generated 39 anomaly alerts
2025-10-28 06:17:40,935 - detection.threat_detector - INFO - ML detector generated 39 alerts
2025-10-28 06:17:40,935 - detection.threat_detector - INFO - Total unique alerts generated: 59
2025-10-28 06:17:40,936 - run - INFO - Detected 59 alerts
2025-10-28 06:17:40,936 - enrichment.intel_enricher - INFO - Enriching 59 alerts with threat intelligence...
2025-10-28 06:17:40,958 - enrichment.intel_enricher - INFO - Enriched 59 alerts
2025-10-28 06:17:40,959 - run - INFO - Enriched 59 alerts with threat intelligence
2025-10-28 06:17:40,959 - scoring.risk_scorer - INFO - Scoring 59 alerts...
2025-10-28 06:17:40,961 - scoring.risk_scorer - INFO - Scored 59 alerts
2025-10-28 06:17:40,961 - run - INFO - Scored 59 alerts with risk scores
2025-10-28 06:17:41,015 - run - INFO - Saved 59 alerts to data\alerts\alerts_20251028_061740.json
2025-10-28 06:17:41,016 - run - INFO - Simulation produced 59 scored alerts
2025-10-28 06:17:41,016 - run - INFO - Generating report for simulated threats...
2025-10-28 06:17:41,038 - run - INFO - Generating report
2025-10-28 06:17:41,039 - reporting.report_generator - INFO - Generating daily SOC report...
2025-10-28 06:17:42,157 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-28 06:17:42,206 - reporting.report_generator - INFO - Daily report generated: ['data\\reports\\daily_summary_20251028_004741.html', 'data\\reports\\daily_summary_20251028_004741.pdf', 'data\\reports\\daily_summary_20251028_004741.json']
2025-10-28 06:17:42,210 - run - INFO - Report generated at: data\reports\daily_summary_20251028_004741.html
2025-10-28 06:17:42,210 - run - INFO - Mode: test — running pytest
2025-10-28 06:17:47,037 - run - INFO - Mode: dashboard
2025-10-28 06:17:47,037 - run - INFO - Starting dashboard (blocking)
2025-10-28 06:17:47,686 - run - INFO - Spawning Streamlit to serve the dashboard: D:\Cusor AI\threat_ops\.venv\Scripts\python.exe -m streamlit run D:\Cusor AI\threat_ops\run_streamlit.py -- --mode dashboard
2025-10-28 06:20:18,567 - run - INFO - Interrupted by user
2025-10-29 14:26:31,805 - run - INFO - ============================================================
2025-10-29 14:26:31,806 - run - INFO - ThreatOps SIEM Pipeline
2025-10-29 14:26:31,806 - run - INFO - ============================================================
2025-10-29 14:26:33,631 - detection.threat_detector - WARNING - opensearch-py not available, OpenSearch integration disabled
2025-10-29 14:26:36,222 - enrichment.intel_enricher - WARNING - opensearch-py not available, OpenSearch integration disabled
2025-10-29 14:26:36,226 - scoring.risk_scorer - WARNING - opensearch-py not available, OpenSearch integration disabled
2025-10-29 14:26:36,227 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-29 14:26:36,227 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-29 14:26:36,287 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-29 14:26:36,287 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-29 14:26:36,294 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-29 14:26:36,294 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-29 14:26:36,295 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-29 14:26:36,295 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-29 14:26:36,295 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-29 14:26:36,295 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-29 14:26:36,296 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-29 14:26:36,296 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-29 14:26:36,296 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-29 14:26:36,297 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-29 14:26:36,298 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-29 14:26:36,298 - run - INFO - Initialization complete
2025-10-29 14:26:36,300 - run - INFO - Mode: Attack Simulation
2025-10-29 14:26:36,301 - run - INFO - === Running Attack Simulation ===
2025-10-29 14:26:36,301 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-29 14:26:36,302 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-29 14:26:36,302 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-29 14:26:36,303 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-29 14:26:36,304 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-29 14:26:36,304 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-29 14:26:36,305 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-29 14:26:36,306 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-29 14:26:36,306 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-29 14:26:36,306 - run - INFO - Generated 390 simulated attack log entries
2025-10-29 14:26:36,313 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-29 14:26:36,321 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251029_142636_20251029_142636.json
2025-10-29 14:26:36,530 - run - INFO - ============================================================
2025-10-29 14:26:36,530 - run - INFO - Run completed successfully
2025-10-29 14:26:36,531 - run - INFO - ============================================================
2025-10-29 14:33:32,622 - run - INFO - ============================================================
2025-10-29 14:33:32,665 - run - INFO - ThreatOps SIEM Pipeline
2025-10-29 14:33:32,666 - run - INFO - ============================================================
2025-10-29 14:33:55,752 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-29 14:33:55,753 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-29 14:33:55,764 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-29 14:33:55,764 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-29 14:33:55,766 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-29 14:33:55,766 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-29 14:33:55,766 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-29 14:33:55,766 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-29 14:33:55,767 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-29 14:33:55,767 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-29 14:33:55,767 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-29 14:33:55,767 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-29 14:33:55,767 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-29 14:33:55,767 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-29 14:33:55,767 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-29 14:33:55,768 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-29 14:33:55,768 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-29 14:33:55,768 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-29 14:33:55,768 - run - INFO - Initialization complete
2025-10-29 14:33:55,769 - run - INFO - Mode: Attack Simulation
2025-10-29 14:33:55,769 - run - INFO - === Running Attack Simulation ===
2025-10-29 14:33:55,770 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-29 14:33:55,770 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-29 14:33:55,771 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-29 14:33:55,772 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-29 14:33:55,772 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-29 14:33:55,772 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-29 14:33:55,773 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-29 14:33:55,773 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-29 14:33:55,773 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-29 14:33:55,773 - run - INFO - Generated 390 simulated attack log entries
2025-10-29 14:33:55,782 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-29 14:33:55,789 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251029_143355_20251029_143355.json
2025-10-29 14:33:55,789 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-29 14:33:55,790 - run - INFO - ============================================================
2025-10-29 14:33:55,790 - run - INFO - Run completed successfully
2025-10-29 14:33:55,790 - run - INFO - ============================================================
2025-10-30 08:21:27,985 - run - INFO - ============================================================
2025-10-30 08:21:27,987 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 08:21:27,987 - run - INFO - ============================================================
2025-10-30 08:21:29,123 - detection.threat_detector - WARNING - opensearch-py not available, OpenSearch integration disabled
2025-10-30 08:21:38,005 - run - INFO - Interrupted by user
2025-10-30 08:21:49,327 - run - INFO - ============================================================
2025-10-30 08:21:49,327 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 08:21:49,327 - run - INFO - ============================================================
2025-10-30 08:22:02,518 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 08:22:02,518 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 08:22:02,529 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:22:02,530 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:22:02,531 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 08:22:02,532 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 08:22:02,532 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 08:22:02,532 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 08:22:02,533 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 08:22:02,535 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 08:22:02,536 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 08:22:02,536 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 08:22:02,537 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 08:22:02,537 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 08:22:02,537 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 08:22:02,537 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 08:22:02,538 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 08:22:02,538 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 08:22:02,538 - run - INFO - Initialization complete
2025-10-30 08:22:02,539 - run - INFO - Mode: Attack Simulation
2025-10-30 08:22:02,541 - run - INFO - === Running Attack Simulation ===
2025-10-30 08:22:02,543 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 08:22:02,544 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 08:22:02,545 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 08:22:02,545 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 08:22:02,546 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 08:22:02,547 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 08:22:02,548 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 08:22:02,549 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 08:22:02,549 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 08:22:02,549 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 08:22:02,554 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 08:22:02,558 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_082202_20251030_082202.json
2025-10-30 08:22:02,559 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 08:22:02,560 - run - INFO - ============================================================
2025-10-30 08:22:02,560 - run - INFO - Run completed successfully
2025-10-30 08:22:02,560 - run - INFO - ============================================================
2025-10-30 08:22:14,621 - run - INFO - ============================================================
2025-10-30 08:22:14,622 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 08:22:14,622 - run - INFO - ============================================================
2025-10-30 08:22:16,435 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 08:22:16,436 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 08:22:16,443 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:22:16,444 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:22:16,446 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 08:22:16,446 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 08:22:16,447 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 08:22:16,447 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 08:22:16,448 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 08:22:16,448 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 08:22:16,449 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 08:22:16,449 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 08:22:16,449 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 08:22:16,450 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 08:22:16,450 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 08:22:16,451 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 08:22:16,451 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 08:22:16,451 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 08:22:16,452 - run - INFO - Initialization complete
2025-10-30 08:22:16,452 - run - INFO - Mode: Full Pipeline
2025-10-30 08:22:16,453 - run - INFO - ========================================
2025-10-30 08:22:16,453 - run - INFO - Running Full SIEM Pipeline
2025-10-30 08:22:16,453 - run - INFO - ========================================
2025-10-30 08:22:16,454 - run - INFO - === Running Threat Detection ===
2025-10-30 08:22:16,481 - opensearch - WARNING - POST https://localhost:9200/filebeat-*/_search [status:N/A request:0.027s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
        sock=sock,
    ...<14 lines>...
        assert_fingerprint=self.assert_fingerprint,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
        sock=sock,
    ...<8 lines>...
        tls_in_tls=tls_in_tls,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 455, in wrap_socket
    return self.sslsocket_class._create(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sock=sock,
        ^^^^^^^^^^
    ...<5 lines>...
        session=session
        ^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1076, in _create
    self.do_handshake()
    ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1372, in do_handshake
    self._sslobj.do_handshake()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
ssl.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)
2025-10-30 08:22:16,603 - opensearch - WARNING - POST https://localhost:9200/filebeat-*/_search [status:N/A request:0.030s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
        sock=sock,
    ...<14 lines>...
        assert_fingerprint=self.assert_fingerprint,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
        sock=sock,
    ...<8 lines>...
        tls_in_tls=tls_in_tls,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 455, in wrap_socket
    return self.sslsocket_class._create(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sock=sock,
        ^^^^^^^^^^
    ...<5 lines>...
        session=session
        ^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1076, in _create
    self.do_handshake()
    ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1372, in do_handshake
    self._sslobj.do_handshake()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
ssl.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)
2025-10-30 08:22:16,630 - opensearch - WARNING - POST https://localhost:9200/filebeat-*/_search [status:N/A request:0.024s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
        sock=sock,
    ...<14 lines>...
        assert_fingerprint=self.assert_fingerprint,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
        sock=sock,
    ...<8 lines>...
        tls_in_tls=tls_in_tls,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 455, in wrap_socket
    return self.sslsocket_class._create(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sock=sock,
        ^^^^^^^^^^
    ...<5 lines>...
        session=session
        ^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1076, in _create
    self.do_handshake()
    ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1372, in do_handshake
    self._sslobj.do_handshake()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
ssl.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)
2025-10-30 08:22:16,667 - opensearch - WARNING - POST https://localhost:9200/filebeat-*/_search [status:N/A request:0.032s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
        sock=sock,
    ...<14 lines>...
        assert_fingerprint=self.assert_fingerprint,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
        sock=sock,
    ...<8 lines>...
        tls_in_tls=tls_in_tls,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 455, in wrap_socket
    return self.sslsocket_class._create(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sock=sock,
        ^^^^^^^^^^
    ...<5 lines>...
        session=session
        ^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1076, in _create
    self.do_handshake()
    ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1372, in do_handshake
    self._sslobj.do_handshake()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
ssl.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)
2025-10-30 08:22:16,672 - detection.threat_detector - ERROR - Error querying OpenSearch: ConnectionError([SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)) caused by: SSLError([SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032))
2025-10-30 08:22:16,672 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 08:22:16,673 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 08:22:16,673 - run - INFO - ============================================================
2025-10-30 08:22:16,673 - run - INFO - Run completed successfully
2025-10-30 08:22:16,674 - run - INFO - ============================================================
2025-10-30 08:28:44,853 - run - INFO - ============================================================
2025-10-30 08:28:44,853 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 08:28:44,853 - run - INFO - ============================================================
2025-10-30 08:28:45,009 - detection.threat_detector - WARNING - opensearch-py not available, OpenSearch integration disabled
2025-10-30 08:28:50,406 - enrichment.intel_enricher - WARNING - opensearch-py not available, OpenSearch integration disabled
2025-10-30 08:28:50,409 - scoring.risk_scorer - WARNING - opensearch-py not available, OpenSearch integration disabled
2025-10-30 08:28:50,410 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 08:28:50,410 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 08:28:50,418 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:28:50,418 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:28:50,423 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 08:28:50,423 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 08:28:50,423 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 08:28:50,424 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 08:28:50,424 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 08:28:50,424 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 08:28:50,424 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 08:28:50,424 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 08:28:50,424 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 08:28:50,424 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 08:28:50,424 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 08:28:50,424 - run - INFO - Initialization complete
2025-10-30 08:28:50,425 - run - INFO - Mode: Attack Simulation
2025-10-30 08:28:50,425 - run - INFO - === Running Attack Simulation ===
2025-10-30 08:28:50,426 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 08:28:50,426 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 08:28:50,426 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 08:28:50,427 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 08:28:50,427 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 08:28:50,427 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 08:28:50,427 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 08:28:50,428 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 08:28:50,428 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 08:28:50,428 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 08:28:50,431 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 08:28:50,434 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_082850_20251030_082850.json
2025-10-30 08:28:50,434 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 08:28:50,435 - run - INFO - ============================================================
2025-10-30 08:28:50,435 - run - INFO - Run completed successfully
2025-10-30 08:28:50,435 - run - INFO - ============================================================
2025-10-30 08:30:56,692 - run - INFO - ============================================================
2025-10-30 08:30:56,692 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 08:30:56,692 - run - INFO - ============================================================
2025-10-30 08:30:58,722 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 08:30:58,722 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 08:30:58,728 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:30:58,729 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:30:58,730 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 08:30:58,730 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 08:30:58,731 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 08:30:58,731 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 08:30:58,731 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 08:30:58,731 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 08:30:58,731 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 08:30:58,731 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 08:30:58,731 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 08:30:58,731 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 08:30:58,732 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 08:30:58,732 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 08:30:58,732 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 08:30:58,732 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 08:30:58,732 - run - INFO - Initialization complete
2025-10-30 08:30:58,733 - run - INFO - Mode: Full Pipeline
2025-10-30 08:30:58,733 - run - INFO - ========================================
2025-10-30 08:30:58,733 - run - INFO - Running Full SIEM Pipeline
2025-10-30 08:30:58,733 - run - INFO - ========================================
2025-10-30 08:30:58,733 - run - INFO - === Running Threat Detection ===
2025-10-30 08:30:58,875 - opensearch - WARNING - POST https://localhost:9200/filebeat-*/_search [status:N/A request:0.141s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
        sock=sock,
    ...<14 lines>...
        assert_fingerprint=self.assert_fingerprint,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
        sock=sock,
    ...<8 lines>...
        tls_in_tls=tls_in_tls,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 455, in wrap_socket
    return self.sslsocket_class._create(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sock=sock,
        ^^^^^^^^^^
    ...<5 lines>...
        session=session
        ^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1076, in _create
    self.do_handshake()
    ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1372, in do_handshake
    self._sslobj.do_handshake()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
ssl.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)
2025-10-30 08:30:58,914 - opensearch - WARNING - POST https://localhost:9200/filebeat-*/_search [status:N/A request:0.033s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
        sock=sock,
    ...<14 lines>...
        assert_fingerprint=self.assert_fingerprint,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
        sock=sock,
    ...<8 lines>...
        tls_in_tls=tls_in_tls,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 455, in wrap_socket
    return self.sslsocket_class._create(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sock=sock,
        ^^^^^^^^^^
    ...<5 lines>...
        session=session
        ^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1076, in _create
    self.do_handshake()
    ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1372, in do_handshake
    self._sslobj.do_handshake()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
ssl.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)
2025-10-30 08:30:58,959 - opensearch - WARNING - POST https://localhost:9200/filebeat-*/_search [status:N/A request:0.041s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
        sock=sock,
    ...<14 lines>...
        assert_fingerprint=self.assert_fingerprint,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
        sock=sock,
    ...<8 lines>...
        tls_in_tls=tls_in_tls,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 455, in wrap_socket
    return self.sslsocket_class._create(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sock=sock,
        ^^^^^^^^^^
    ...<5 lines>...
        session=session
        ^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1076, in _create
    self.do_handshake()
    ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1372, in do_handshake
    self._sslobj.do_handshake()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
ssl.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)
2025-10-30 08:30:58,992 - opensearch - WARNING - POST https://localhost:9200/filebeat-*/_search [status:N/A request:0.031s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
        sock=sock,
    ...<14 lines>...
        assert_fingerprint=self.assert_fingerprint,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
        sock=sock,
    ...<8 lines>...
        tls_in_tls=tls_in_tls,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 455, in wrap_socket
    return self.sslsocket_class._create(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sock=sock,
        ^^^^^^^^^^
    ...<5 lines>...
        session=session
        ^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1076, in _create
    self.do_handshake()
    ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\ssl.py", line 1372, in do_handshake
    self._sslobj.do_handshake()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
ssl.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)
2025-10-30 08:30:58,997 - detection.threat_detector - ERROR - Error querying OpenSearch: ConnectionError([SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032)) caused by: SSLError([SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1032))
2025-10-30 08:30:58,997 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 08:30:58,997 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 08:30:58,997 - run - INFO - ============================================================
2025-10-30 08:30:58,997 - run - INFO - Run completed successfully
2025-10-30 08:30:58,997 - run - INFO - ============================================================
2025-10-30 08:32:01,244 - run - INFO - ============================================================
2025-10-30 08:32:01,244 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 08:32:01,244 - run - INFO - ============================================================
2025-10-30 08:32:03,299 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 08:32:03,299 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 08:32:03,305 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:32:03,305 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:32:03,306 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 08:32:03,306 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 08:32:03,307 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 08:32:03,307 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 08:32:03,307 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 08:32:03,307 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 08:32:03,307 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 08:32:03,307 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 08:32:03,307 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 08:32:03,307 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 08:32:03,307 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 08:32:03,307 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 08:32:03,307 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 08:32:03,308 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 08:32:03,308 - run - INFO - Initialization complete
2025-10-30 08:32:03,308 - run - INFO - Mode: Full Pipeline
2025-10-30 08:32:03,318 - run - INFO - ========================================
2025-10-30 08:32:03,318 - run - INFO - Running Full SIEM Pipeline
2025-10-30 08:32:03,319 - run - INFO - ========================================
2025-10-30 08:32:03,319 - run - INFO - === Running Threat Detection ===
2025-10-30 08:32:03,365 - opensearch - INFO - POST http://localhost:9200/filebeat-*/_search [status:200 request:0.046s]
2025-10-30 08:32:03,365 - detection.threat_detector - INFO - Retrieved 0 logs from OpenSearch
2025-10-30 08:32:03,365 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 08:32:03,365 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 08:32:03,366 - run - INFO - ============================================================
2025-10-30 08:32:03,366 - run - INFO - Run completed successfully
2025-10-30 08:32:03,366 - run - INFO - ============================================================
2025-10-30 08:33:35,023 - run - INFO - ============================================================
2025-10-30 08:33:35,023 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 08:33:35,023 - run - INFO - ============================================================
2025-10-30 08:33:37,173 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 08:33:37,173 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 08:33:37,182 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:33:37,182 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:33:37,183 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 08:33:37,183 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 08:33:37,183 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 08:33:37,183 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 08:33:37,184 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 08:33:37,184 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 08:33:37,184 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 08:33:37,184 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 08:33:37,184 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 08:33:37,184 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 08:33:37,184 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 08:33:37,184 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 08:33:37,184 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 08:33:37,184 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 08:33:37,185 - run - INFO - Initialization complete
2025-10-30 08:33:37,185 - run - INFO - Mode: Attack Simulation
2025-10-30 08:33:37,185 - run - INFO - === Running Attack Simulation ===
2025-10-30 08:33:37,186 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 08:33:37,186 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 08:33:37,186 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 08:33:37,187 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 08:33:37,187 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 08:33:37,187 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 08:33:37,187 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 08:33:37,187 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 08:33:37,187 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 08:33:37,188 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 08:33:37,190 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 08:33:37,194 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_083337_20251030_083337.json
2025-10-30 08:33:37,194 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 08:33:37,194 - run - INFO - ============================================================
2025-10-30 08:33:37,194 - run - INFO - Run completed successfully
2025-10-30 08:33:37,194 - run - INFO - ============================================================
2025-10-30 08:33:49,050 - run - INFO - ============================================================
2025-10-30 08:33:49,050 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 08:33:49,050 - run - INFO - ============================================================
2025-10-30 08:33:50,988 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 08:33:50,989 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 08:33:50,996 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:33:50,996 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:33:50,997 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 08:33:50,998 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 08:33:50,998 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 08:33:50,998 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 08:33:50,998 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 08:33:50,999 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 08:33:50,999 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 08:33:50,999 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 08:33:50,999 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 08:33:50,999 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 08:33:50,999 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 08:33:50,999 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 08:33:50,999 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 08:33:51,000 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 08:33:51,000 - run - INFO - Initialization complete
2025-10-30 08:33:51,001 - run - INFO - Mode: Full Pipeline
2025-10-30 08:33:51,001 - run - INFO - ========================================
2025-10-30 08:33:51,001 - run - INFO - Running Full SIEM Pipeline
2025-10-30 08:33:51,001 - run - INFO - ========================================
2025-10-30 08:33:51,001 - run - INFO - === Running Threat Detection ===
2025-10-30 08:33:51,009 - opensearch - INFO - POST http://localhost:9200/filebeat-*/_search [status:200 request:0.008s]
2025-10-30 08:33:51,009 - detection.threat_detector - INFO - Retrieved 0 logs from OpenSearch
2025-10-30 08:33:51,010 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 08:33:51,010 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 08:33:51,010 - run - INFO - ============================================================
2025-10-30 08:33:51,010 - run - INFO - Run completed successfully
2025-10-30 08:33:51,010 - run - INFO - ============================================================
2025-10-30 08:52:13,671 - run - INFO - ======================================================================
2025-10-30 08:52:13,693 - run - INFO - ======================================================================
2025-10-30 08:52:13,693 - run - INFO - 
2025-10-30 08:52:13,693 - run - ERROR - Fatal error: start_all_services() got an unexpected keyword argument 'with_dashboards'
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 437, in main
    start_all_services(with_dashboards=args.with_dashboards)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: start_all_services() got an unexpected keyword argument 'with_dashboards'
2025-10-30 08:53:40,060 - run - INFO - ======================================================================
2025-10-30 08:53:40,060 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 08:53:40,060 - run - INFO - ======================================================================
2025-10-30 08:53:40,060 - run - INFO - 
2025-10-30 08:53:40,060 - run - ERROR - Fatal error: name 'include_dashboards' is not defined
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 432, in main
    start_all_services(with_dashboards=args.with_dashboards)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\run.py", line 236, in start_all_services
    total_services = 3 if include_dashboards else 2
                          ^^^^^^^^^^^^^^^^^^
NameError: name 'include_dashboards' is not defined
2025-10-30 08:54:44,536 - run - INFO - ======================================================================
2025-10-30 08:54:44,536 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 08:54:44,537 - run - INFO - ======================================================================
2025-10-30 08:54:44,537 - run - INFO - 
2025-10-30 08:54:44,537 - run - INFO - ======================================================================
2025-10-30 08:54:44,537 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 08:54:44,537 - run - INFO - ======================================================================
2025-10-30 08:54:44,554 - run - INFO -   Waiting 60 seconds for initialization...
2025-10-30 08:55:44,952 - run - INFO - 
2025-10-30 08:55:44,953 - run - INFO - ======================================================================
2025-10-30 08:55:44,953 - run - INFO - [2/3] Starting Filebeat...
2025-10-30 08:55:44,953 - run - INFO - ======================================================================
2025-10-30 08:55:44,964 - run - INFO -   Waiting 10 seconds for connection...
2025-10-30 08:55:52,043 - run - INFO - Interrupted by user
2025-10-30 08:56:16,426 - run - INFO - ======================================================================
2025-10-30 08:56:16,427 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 08:56:16,427 - run - INFO - ======================================================================
2025-10-30 08:56:16,427 - run - INFO - 
2025-10-30 08:56:16,427 - run - INFO - ======================================================================
2025-10-30 08:56:16,428 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 08:56:16,428 - run - INFO - ======================================================================
2025-10-30 08:56:16,442 - run - INFO - [OK] OpenSearch started
2025-10-30 08:56:16,442 - run - INFO -   Waiting 60 seconds for initialization...
2025-10-30 08:57:16,698 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-10-30 08:57:16,699 - run - INFO - 
2025-10-30 08:57:16,699 - run - INFO - ======================================================================
2025-10-30 08:57:16,700 - run - INFO - [2/3] Starting Filebeat...
2025-10-30 08:57:16,700 - run - INFO - ======================================================================
2025-10-30 08:57:16,704 - run - INFO - [OK] Filebeat started
2025-10-30 08:57:16,704 - run - INFO -   Waiting 10 seconds for connection...
2025-10-30 08:57:26,705 - run - INFO - 
2025-10-30 08:57:26,705 - run - INFO - ======================================================================
2025-10-30 08:57:26,705 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-10-30 08:57:26,706 - run - INFO - ======================================================================
2025-10-30 08:57:26,746 - run - INFO - [OK] OpenSearch Dashboards started
2025-10-30 08:57:26,746 - run - INFO -   (Will be available at http://localhost:5601)
2025-10-30 08:57:26,746 - run - INFO - 
2025-10-30 08:57:26,747 - run - INFO - ======================================================================
2025-10-30 08:57:26,747 - run - INFO - [OK] All services started successfully!
2025-10-30 08:57:26,747 - run - INFO - ======================================================================
2025-10-30 08:57:26,747 - run - INFO - 
2025-10-30 08:57:26,748 - run - INFO - 
2025-10-30 08:57:26,748 - run - INFO - ======================================================================
2025-10-30 08:57:26,748 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-30 08:57:26,749 - run - INFO - ======================================================================
2025-10-30 08:57:28,562 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 08:57:28,563 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 08:57:28,733 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:57:28,734 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 08:57:28,735 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 08:57:28,735 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 08:57:28,736 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 08:57:28,736 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 08:57:28,736 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 08:57:28,737 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 08:57:28,737 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 08:57:28,737 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 08:57:28,737 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 08:57:28,738 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 08:57:28,738 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 08:57:28,738 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 08:57:28,738 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 08:57:28,739 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 08:57:28,739 - run - INFO - Initialization complete
2025-10-30 08:57:28,740 - run - INFO - [OK] Pipeline initialized
2025-10-30 08:57:28,740 - run - INFO - 
2025-10-30 08:57:28,740 - run - INFO - 
2025-10-30 08:57:28,740 - run - INFO - ======================================================================
2025-10-30 08:57:28,740 - run - INFO - [5/7] Running Attack Simulation...
2025-10-30 08:57:28,741 - run - INFO - ======================================================================
2025-10-30 08:57:28,742 - run - INFO - === Running Attack Simulation ===
2025-10-30 08:57:28,742 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 08:57:28,743 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 08:57:28,744 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 08:57:28,744 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 08:57:28,745 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 08:57:28,745 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 08:57:28,747 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 08:57:28,748 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 08:57:28,749 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 08:57:28,749 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 08:57:28,756 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 08:57:28,763 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_085728_20251030_085728.json
2025-10-30 08:57:28,763 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 08:57:28,764 - run - INFO - [OK] Simulation complete
2025-10-30 08:57:28,764 - run - INFO - 
2025-10-30 08:57:28,764 - run - INFO -   Waiting 15 seconds for Filebeat to collect logs...
2025-10-30 08:57:43,767 - run - INFO - 
2025-10-30 08:57:43,774 - run - INFO - ======================================================================
2025-10-30 08:57:43,780 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-30 08:57:43,780 - run - INFO - ======================================================================
2025-10-30 08:57:43,782 - run - INFO - ========================================
2025-10-30 08:57:43,782 - run - INFO - Running Full SIEM Pipeline
2025-10-30 08:57:43,783 - run - INFO - ========================================
2025-10-30 08:57:43,787 - run - INFO - === Running Threat Detection ===
2025-10-30 08:57:43,816 - opensearch - INFO - POST http://localhost:9200/filebeat-*/_search [status:200 request:0.026s]
2025-10-30 08:57:43,816 - detection.threat_detector - INFO - Retrieved 0 logs from OpenSearch
2025-10-30 08:57:43,817 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 08:57:43,818 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 08:57:43,819 - run - INFO - [OK] Pipeline complete
2025-10-30 08:57:43,820 - run - INFO - 
2025-10-30 08:57:43,824 - run - INFO - 
2025-10-30 08:57:43,824 - run - INFO - ======================================================================
2025-10-30 08:57:43,825 - run - INFO - [7/7] Opening ThreatOps Dashboard...
2025-10-30 08:57:43,826 - run - INFO - ======================================================================
2025-10-30 08:57:43,840 - run - INFO - [OK] Dashboard starting...
2025-10-30 08:57:43,842 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-30 08:57:48,951 - run - INFO - [OK] Dashboard opened in browser
2025-10-30 08:57:48,952 - run - INFO - ======================================================================
2025-10-30 08:57:48,952 - run - INFO - 
2025-10-30 08:57:48,953 - run - INFO - 
2025-10-30 08:57:48,953 - run - INFO - ======================================================================
2025-10-30 08:57:48,954 - run - INFO - COMPLETE! All systems operational!
2025-10-30 08:57:48,954 - run - INFO - ======================================================================
2025-10-30 08:57:48,954 - run - INFO - 
2025-10-30 08:57:48,955 - run - INFO - Services running:
2025-10-30 08:57:48,955 - run - INFO -    OpenSearch:    http://localhost:9200
2025-10-30 08:57:48,955 - run - INFO -    ThreatOps UI:  http://localhost:8501  <- Your main dashboard
2025-10-30 08:57:48,955 - run - INFO -    OpenSearch DB: http://localhost:5601  <- Advanced analytics
2025-10-30 08:57:48,956 - run - INFO - 
2025-10-30 08:57:48,956 - run - INFO - Log Sources Active:
2025-10-30 08:57:48,956 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-30 08:57:48,956 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-30 08:57:48,957 - run - INFO -    [*] Windows System logs (real system events)
2025-10-30 08:57:48,957 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-30 08:57:48,957 - run - INFO - 
2025-10-30 08:57:48,958 - run - INFO - ======================================================================
2025-10-30 08:57:48,958 - run - INFO - 
2025-10-30 09:01:00,483 - run - INFO - ======================================================================
2025-10-30 09:01:00,484 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 09:01:00,484 - run - INFO - ======================================================================
2025-10-30 09:01:00,484 - run - INFO - 
2025-10-30 09:01:00,484 - run - INFO - ======================================================================
2025-10-30 09:01:00,484 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 09:01:00,485 - run - INFO - ======================================================================
2025-10-30 09:01:00,496 - run - INFO - [OK] OpenSearch started
2025-10-30 09:01:00,497 - run - INFO -   Waiting 60 seconds for initialization...
2025-10-30 09:02:00,675 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-10-30 09:02:00,675 - run - INFO - 
2025-10-30 09:02:00,676 - run - INFO - ======================================================================
2025-10-30 09:02:00,676 - run - INFO - [2/3] Starting Filebeat...
2025-10-30 09:02:00,676 - run - INFO - ======================================================================
2025-10-30 09:02:00,682 - run - INFO - [OK] Filebeat started
2025-10-30 09:02:00,682 - run - INFO -   Waiting 10 seconds for connection...
2025-10-30 09:02:10,682 - run - INFO - 
2025-10-30 09:02:10,683 - run - INFO - ======================================================================
2025-10-30 09:02:10,685 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-10-30 09:02:10,685 - run - INFO - ======================================================================
2025-10-30 09:02:10,697 - run - INFO - [OK] OpenSearch Dashboards started
2025-10-30 09:02:10,701 - run - INFO -   (Will be available at http://localhost:5601)
2025-10-30 09:02:10,702 - run - INFO - 
2025-10-30 09:02:10,702 - run - INFO - ======================================================================
2025-10-30 09:02:10,703 - run - INFO - [OK] All services started successfully!
2025-10-30 09:02:10,705 - run - INFO - ======================================================================
2025-10-30 09:02:10,706 - run - INFO - 
2025-10-30 09:02:10,708 - run - INFO - 
2025-10-30 09:02:10,708 - run - INFO - ======================================================================
2025-10-30 09:02:10,708 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-30 09:02:10,709 - run - INFO - ======================================================================
2025-10-30 09:02:12,731 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 09:02:12,731 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 09:02:12,740 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 09:02:12,741 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 09:02:12,742 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 09:02:12,742 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 09:02:12,743 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 09:02:12,743 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 09:02:12,743 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 09:02:12,744 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 09:02:12,744 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 09:02:12,744 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 09:02:12,744 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 09:02:12,744 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 09:02:12,745 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 09:02:12,745 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 09:02:12,745 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 09:02:12,745 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 09:02:12,745 - run - INFO - Initialization complete
2025-10-30 09:02:12,746 - run - INFO - [OK] Pipeline initialized
2025-10-30 09:02:12,746 - run - INFO - 
2025-10-30 09:02:12,746 - run - INFO - 
2025-10-30 09:02:12,746 - run - INFO - ======================================================================
2025-10-30 09:02:12,747 - run - INFO - [5/7] Running Attack Simulation...
2025-10-30 09:02:12,747 - run - INFO - ======================================================================
2025-10-30 09:02:12,748 - run - INFO - === Running Attack Simulation ===
2025-10-30 09:02:12,749 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 09:02:12,749 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 09:02:12,749 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 09:02:12,750 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 09:02:12,750 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 09:02:12,751 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 09:02:12,752 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 09:02:12,753 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 09:02:12,753 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 09:02:12,754 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 09:02:12,762 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 09:02:12,771 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_090212_20251030_090212.json
2025-10-30 09:02:12,771 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 09:02:12,772 - run - INFO - [OK] Simulation complete
2025-10-30 09:02:12,773 - run - INFO - 
2025-10-30 09:02:12,773 - run - INFO -   Waiting 15 seconds for Filebeat to collect logs...
2025-10-30 09:02:27,774 - run - INFO - 
2025-10-30 09:02:27,775 - run - INFO - ======================================================================
2025-10-30 09:02:27,775 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-30 09:02:27,776 - run - INFO - ======================================================================
2025-10-30 09:02:27,777 - run - INFO - ========================================
2025-10-30 09:02:27,778 - run - INFO - Running Full SIEM Pipeline
2025-10-30 09:02:27,778 - run - INFO - ========================================
2025-10-30 09:02:27,779 - run - INFO - === Running Threat Detection ===
2025-10-30 09:02:27,795 - opensearch - INFO - POST http://localhost:9200/filebeat-*/_search [status:200 request:0.014s]
2025-10-30 09:02:27,796 - detection.threat_detector - INFO - Retrieved 0 logs from OpenSearch
2025-10-30 09:02:27,797 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 09:02:27,797 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 09:02:27,799 - run - INFO - [OK] Pipeline complete
2025-10-30 09:02:27,800 - run - INFO - 
2025-10-30 09:02:27,800 - run - INFO - 
2025-10-30 09:02:27,801 - run - INFO - ======================================================================
2025-10-30 09:02:27,801 - run - INFO - [7/7] Opening ThreatOps Dashboard...
2025-10-30 09:02:27,804 - run - INFO - ======================================================================
2025-10-30 09:02:27,812 - run - INFO - [OK] Dashboard starting...
2025-10-30 09:02:27,813 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-30 09:02:32,814 - run - INFO - Opening browser: http://localhost:8501
2025-10-30 09:02:32,894 - run - INFO - [OK] Dashboard opened in browser
2025-10-30 09:02:32,894 - run - INFO - ======================================================================
2025-10-30 09:02:32,894 - run - INFO - 
2025-10-30 09:02:32,895 - run - INFO - 
2025-10-30 09:02:32,895 - run - INFO - ======================================================================
2025-10-30 09:02:32,896 - run - INFO - COMPLETE! All systems operational!
2025-10-30 09:02:32,897 - run - INFO - ======================================================================
2025-10-30 09:02:32,897 - run - INFO - 
2025-10-30 09:02:32,898 - run - INFO - Services running:
2025-10-30 09:02:32,898 - run - INFO -    OpenSearch:    http://localhost:9200
2025-10-30 09:02:32,898 - run - INFO -    ThreatOps UI:  http://localhost:8501  <- Your main dashboard
2025-10-30 09:02:32,898 - run - INFO -    OpenSearch DB: http://localhost:5601  <- Advanced analytics
2025-10-30 09:02:32,899 - run - INFO - 
2025-10-30 09:02:32,899 - run - INFO - Log Sources Active:
2025-10-30 09:02:32,899 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-30 09:02:32,899 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-30 09:02:32,900 - run - INFO -    [*] Windows System logs (real system events)
2025-10-30 09:02:32,900 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-30 09:02:32,900 - run - INFO - 
2025-10-30 09:02:32,900 - run - INFO - ======================================================================
2025-10-30 09:02:32,900 - run - INFO - 
2025-10-30 19:48:15,701 - run - INFO - ======================================================================
2025-10-30 19:48:15,703 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 19:48:15,703 - run - INFO - ======================================================================
2025-10-30 19:48:15,703 - run - INFO - 
2025-10-30 19:48:15,704 - run - INFO - ======================================================================
2025-10-30 19:48:15,704 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 19:48:15,705 - run - INFO - ======================================================================
2025-10-30 19:48:15,760 - run - INFO - [OK] OpenSearch started
2025-10-30 19:48:15,761 - run - INFO -   Waiting 60 seconds for initialization...
2025-10-30 19:49:16,972 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-10-30 19:49:16,973 - run - INFO - 
2025-10-30 19:49:16,973 - run - INFO - ======================================================================
2025-10-30 19:49:16,973 - run - INFO - [2/3] Starting Filebeat...
2025-10-30 19:49:16,974 - run - INFO - ======================================================================
2025-10-30 19:49:17,091 - run - INFO - [OK] Filebeat started
2025-10-30 19:49:17,092 - run - INFO -   Waiting 10 seconds for connection...
2025-10-30 19:49:27,093 - run - INFO - 
2025-10-30 19:49:27,094 - run - INFO - ======================================================================
2025-10-30 19:49:27,094 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-10-30 19:49:27,095 - run - INFO - ======================================================================
2025-10-30 19:49:27,152 - run - INFO - [OK] OpenSearch Dashboards started
2025-10-30 19:49:27,153 - run - INFO -   (Will be available at http://localhost:5601)
2025-10-30 19:49:27,153 - run - INFO - 
2025-10-30 19:49:27,153 - run - INFO - ======================================================================
2025-10-30 19:49:27,154 - run - INFO - [OK] All services started successfully!
2025-10-30 19:49:27,154 - run - INFO - ======================================================================
2025-10-30 19:49:27,154 - run - INFO - 
2025-10-30 19:49:27,155 - run - INFO - 
2025-10-30 19:49:27,155 - run - INFO - ======================================================================
2025-10-30 19:49:27,155 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-30 19:49:27,156 - run - INFO - ======================================================================
2025-10-30 19:49:53,534 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 19:49:53,534 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 19:49:53,600 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 19:49:53,601 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 19:49:53,604 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 19:49:53,604 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 19:49:53,605 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 19:49:53,606 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 19:49:53,607 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 19:49:53,607 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 19:49:53,607 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 19:49:53,607 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 19:49:53,608 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 19:49:53,609 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 19:49:53,609 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 19:49:53,609 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 19:49:53,610 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 19:49:53,611 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 19:49:53,611 - run - INFO - Initialization complete
2025-10-30 19:49:53,612 - run - INFO - [OK] Pipeline initialized
2025-10-30 19:49:53,613 - run - INFO - 
2025-10-30 19:49:53,613 - run - INFO - 
2025-10-30 19:49:53,613 - run - INFO - ======================================================================
2025-10-30 19:49:53,614 - run - INFO - [5/7] Running Attack Simulation...
2025-10-30 19:49:53,614 - run - INFO - ======================================================================
2025-10-30 19:49:53,615 - run - INFO - === Running Attack Simulation ===
2025-10-30 19:49:53,616 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 19:49:53,617 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 19:49:53,617 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 19:49:53,619 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 19:49:53,619 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 19:49:53,620 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 19:49:53,621 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 19:49:53,621 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 19:49:53,622 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 19:49:53,623 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 19:49:53,631 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 19:49:53,640 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_194953_20251030_194953.json
2025-10-30 19:49:53,640 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 19:49:53,642 - run - INFO - [OK] Simulation complete
2025-10-30 19:49:53,642 - run - INFO - 
2025-10-30 19:49:53,642 - run - INFO -   Waiting 15 seconds for Filebeat to collect logs...
2025-10-30 19:50:08,643 - run - INFO - 
2025-10-30 19:50:08,644 - run - INFO - ======================================================================
2025-10-30 19:50:08,644 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-30 19:50:08,645 - run - INFO - ======================================================================
2025-10-30 19:50:08,646 - run - INFO - ========================================
2025-10-30 19:50:08,647 - run - INFO - Running Full SIEM Pipeline
2025-10-30 19:50:08,647 - run - INFO - ========================================
2025-10-30 19:50:08,647 - run - INFO - === Running Threat Detection ===
2025-10-30 19:50:08,686 - opensearch - INFO - POST http://localhost:9200/filebeat-*/_search [status:200 request:0.038s]
2025-10-30 19:50:08,686 - detection.threat_detector - INFO - Retrieved 0 logs from OpenSearch
2025-10-30 19:50:08,687 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 19:50:08,687 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 19:50:08,688 - run - INFO - [OK] Pipeline complete
2025-10-30 19:50:08,688 - run - INFO - 
2025-10-30 19:50:08,689 - run - INFO - 
2025-10-30 19:50:08,689 - run - INFO - ======================================================================
2025-10-30 19:50:08,689 - run - INFO - [7/7] Opening ThreatOps Dashboard...
2025-10-30 19:50:08,690 - run - INFO - ======================================================================
2025-10-30 19:50:08,699 - run - INFO - [OK] Dashboard starting...
2025-10-30 19:50:08,700 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-30 19:50:13,700 - run - INFO - Opening browser: http://localhost:8501
2025-10-30 19:50:13,787 - run - INFO - [OK] Dashboard opened in browser
2025-10-30 19:50:13,787 - run - INFO - ======================================================================
2025-10-30 19:50:13,788 - run - INFO - 
2025-10-30 19:50:13,788 - run - INFO - 
2025-10-30 19:50:13,788 - run - INFO - ======================================================================
2025-10-30 19:50:13,789 - run - INFO - COMPLETE! All systems operational!
2025-10-30 19:50:13,789 - run - INFO - ======================================================================
2025-10-30 19:50:13,789 - run - INFO - 
2025-10-30 19:50:13,790 - run - INFO - Services running:
2025-10-30 19:50:13,790 - run - INFO -    OpenSearch:    http://localhost:9200
2025-10-30 19:50:13,790 - run - INFO -    ThreatOps UI:  http://localhost:8501  <- Your main dashboard
2025-10-30 19:50:13,791 - run - INFO -    OpenSearch DB: http://localhost:5601  <- Advanced analytics
2025-10-30 19:50:13,791 - run - INFO - 
2025-10-30 19:50:13,791 - run - INFO - Log Sources Active:
2025-10-30 19:50:13,792 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-30 19:50:13,792 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-30 19:50:13,792 - run - INFO -    [*] Windows System logs (real system events)
2025-10-30 19:50:13,792 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-30 19:50:13,793 - run - INFO - 
2025-10-30 19:50:13,793 - run - INFO - ======================================================================
2025-10-30 19:50:13,793 - run - INFO - 
2025-10-30 19:55:28,984 - run - INFO - ======================================================================
2025-10-30 19:55:28,985 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 19:55:28,985 - run - INFO - ======================================================================
2025-10-30 19:55:28,985 - run - INFO - 
2025-10-30 19:55:28,986 - run - INFO - ======================================================================
2025-10-30 19:55:28,986 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 19:55:28,987 - run - INFO - ======================================================================
2025-10-30 19:55:29,004 - run - INFO - [OK] OpenSearch started
2025-10-30 19:55:29,005 - run - INFO -   Waiting 60 seconds for initialization...
2025-10-30 19:56:29,706 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-10-30 19:56:29,707 - run - INFO - 
2025-10-30 19:56:29,707 - run - INFO - ======================================================================
2025-10-30 19:56:29,707 - run - INFO - [2/3] Starting Filebeat...
2025-10-30 19:56:29,708 - run - INFO - ======================================================================
2025-10-30 19:56:29,798 - run - INFO - [OK] Filebeat started
2025-10-30 19:56:29,798 - run - INFO -   Waiting 10 seconds for connection...
2025-10-30 19:56:39,799 - run - INFO - 
2025-10-30 19:56:39,800 - run - INFO - ======================================================================
2025-10-30 19:56:39,801 - run - INFO - [3/3] OpenSearch Dashboards - SKIPPED
2025-10-30 19:56:39,801 - run - INFO - ======================================================================
2025-10-30 19:56:39,802 - run - INFO -   (Use --with-dashboards flag to enable advanced analytics)
2025-10-30 19:56:39,802 - run - INFO -   ThreatOps Dashboard will provide security monitoring
2025-10-30 19:56:39,802 - run - INFO - 
2025-10-30 19:56:39,802 - run - INFO - ======================================================================
2025-10-30 19:56:39,803 - run - INFO - [OK] All services started successfully!
2025-10-30 19:56:39,803 - run - INFO - ======================================================================
2025-10-30 19:56:39,804 - run - INFO - 
2025-10-30 19:56:39,805 - run - INFO - 
2025-10-30 19:56:39,805 - run - INFO - ======================================================================
2025-10-30 19:56:39,806 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-30 19:56:39,806 - run - INFO - ======================================================================
2025-10-30 19:57:04,621 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 19:57:04,621 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 19:57:04,715 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 19:57:04,715 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 19:57:04,717 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 19:57:04,718 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 19:57:04,718 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 19:57:04,719 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 19:57:04,720 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 19:57:04,720 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 19:57:04,720 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 19:57:04,720 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 19:57:04,721 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 19:57:04,722 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 19:57:04,723 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 19:57:04,723 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 19:57:04,724 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 19:57:04,724 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 19:57:04,725 - run - INFO - Initialization complete
2025-10-30 19:57:04,726 - run - INFO - [OK] Pipeline initialized
2025-10-30 19:57:04,726 - run - INFO - 
2025-10-30 19:57:04,727 - run - INFO - 
2025-10-30 19:57:04,728 - run - INFO - ======================================================================
2025-10-30 19:57:04,728 - run - INFO - [5/7] Running Attack Simulation...
2025-10-30 19:57:04,729 - run - INFO - ======================================================================
2025-10-30 19:57:04,730 - run - INFO - === Running Attack Simulation ===
2025-10-30 19:57:04,731 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 19:57:04,733 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 19:57:04,733 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 19:57:04,734 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 19:57:04,736 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 19:57:04,737 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 19:57:04,738 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 19:57:04,739 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 19:57:04,739 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 19:57:04,739 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 19:57:04,745 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 19:57:04,751 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_195704_20251030_195704.json
2025-10-30 19:57:04,752 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 19:57:04,754 - run - INFO - [OK] Simulation complete
2025-10-30 19:57:04,754 - run - INFO - 
2025-10-30 19:57:04,755 - run - INFO -   Waiting 15 seconds for Filebeat to collect logs...
2025-10-30 19:57:19,756 - run - INFO - 
2025-10-30 19:57:19,756 - run - INFO - ======================================================================
2025-10-30 19:57:19,757 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-30 19:57:19,757 - run - INFO - ======================================================================
2025-10-30 19:57:19,760 - run - INFO - ========================================
2025-10-30 19:57:19,760 - run - INFO - Running Full SIEM Pipeline
2025-10-30 19:57:19,760 - run - INFO - ========================================
2025-10-30 19:57:19,761 - run - INFO - === Running Threat Detection ===
2025-10-30 19:57:19,776 - opensearch - INFO - POST http://localhost:9200/filebeat-*/_search [status:200 request:0.014s]
2025-10-30 19:57:19,777 - detection.threat_detector - INFO - Retrieved 0 logs from OpenSearch
2025-10-30 19:57:19,778 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 19:57:19,778 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 19:57:19,780 - run - INFO - [OK] Pipeline complete
2025-10-30 19:57:19,780 - run - INFO - 
2025-10-30 19:57:19,781 - run - INFO - 
2025-10-30 19:57:19,781 - run - INFO - ======================================================================
2025-10-30 19:57:19,781 - run - INFO - [7/7] Opening ThreatOps Dashboard...
2025-10-30 19:57:19,782 - run - INFO - ======================================================================
2025-10-30 19:57:19,892 - run - INFO - [OK] Dashboard starting...
2025-10-30 19:57:19,895 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-30 19:57:24,896 - run - INFO - Opening browser: http://localhost:8501
2025-10-30 19:57:25,001 - run - INFO - [OK] Dashboard opened in browser
2025-10-30 19:57:25,021 - run - INFO - ======================================================================
2025-10-30 19:57:25,021 - run - INFO - 
2025-10-30 19:57:25,022 - run - INFO - 
2025-10-30 19:57:25,022 - run - INFO - ======================================================================
2025-10-30 19:57:25,022 - run - INFO - COMPLETE! All systems operational!
2025-10-30 19:57:25,023 - run - INFO - ======================================================================
2025-10-30 19:57:25,023 - run - INFO - 
2025-10-30 19:57:25,023 - run - INFO - Services running:
2025-10-30 19:57:25,023 - run - INFO -    OpenSearch:    http://localhost:9200
2025-10-30 19:57:25,024 - run - INFO -    ThreatOps UI:  http://localhost:8501  <- Your main dashboard
2025-10-30 19:57:25,025 - run - INFO - 
2025-10-30 19:57:25,025 - run - INFO - Log Sources Active:
2025-10-30 19:57:25,027 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-30 19:57:25,028 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-30 19:57:25,028 - run - INFO -    [*] Windows System logs (real system events)
2025-10-30 19:57:25,028 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-30 19:57:25,029 - run - INFO - 
2025-10-30 19:57:25,029 - run - INFO - ======================================================================
2025-10-30 19:57:25,030 - run - INFO - 
2025-10-30 19:57:53,898 - run - INFO - Interrupted by user
2025-10-30 20:11:40,031 - run - INFO - ======================================================================
2025-10-30 20:11:40,032 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 20:11:40,032 - run - INFO - ======================================================================
2025-10-30 20:11:40,032 - run - INFO - 
2025-10-30 20:11:40,033 - run - INFO - ======================================================================
2025-10-30 20:11:40,033 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 20:11:40,034 - run - INFO - ======================================================================
2025-10-30 20:11:40,053 - run - INFO - [OK] OpenSearch started
2025-10-30 20:11:40,053 - run - INFO -   Waiting 60 seconds for initialization...
2025-10-30 20:12:40,874 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-10-30 20:12:40,875 - run - INFO - 
2025-10-30 20:12:40,876 - run - INFO - ======================================================================
2025-10-30 20:12:40,877 - run - INFO - [2/3] Starting Filebeat...
2025-10-30 20:12:40,877 - run - INFO - ======================================================================
2025-10-30 20:12:40,890 - run - INFO - [OK] Filebeat started
2025-10-30 20:12:40,891 - run - INFO -   Waiting 10 seconds for connection...
2025-10-30 20:12:50,892 - run - INFO - 
2025-10-30 20:12:50,893 - run - INFO - ======================================================================
2025-10-30 20:12:50,894 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-10-30 20:12:50,894 - run - INFO - ======================================================================
2025-10-30 20:12:50,921 - run - INFO - [OK] OpenSearch Dashboards started
2025-10-30 20:12:50,922 - run - INFO -   URL: http://localhost:5601
2025-10-30 20:12:50,923 - run - INFO -   Login: root / root
2025-10-30 20:12:50,923 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-10-30 20:12:50,924 - run - INFO - 
2025-10-30 20:12:50,925 - run - INFO - ======================================================================
2025-10-30 20:12:50,925 - run - INFO - [OK] All services started successfully!
2025-10-30 20:12:50,925 - run - INFO - ======================================================================
2025-10-30 20:12:50,926 - run - INFO - 
2025-10-30 20:12:50,928 - run - INFO - 
2025-10-30 20:12:50,928 - run - INFO - ======================================================================
2025-10-30 20:12:50,928 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-30 20:12:50,929 - run - INFO - ======================================================================
2025-10-30 20:12:57,811 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 20:12:57,812 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 20:12:57,886 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:12:57,896 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:12:57,900 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 20:12:57,901 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 20:12:57,904 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 20:12:57,904 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 20:12:57,905 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 20:12:57,908 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 20:12:57,909 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 20:12:57,910 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 20:12:57,910 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 20:12:57,911 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 20:12:57,912 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 20:12:57,914 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 20:12:57,915 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 20:12:57,918 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 20:12:57,920 - run - INFO - Initialization complete
2025-10-30 20:12:57,925 - run - INFO - [OK] Pipeline initialized
2025-10-30 20:12:57,925 - run - INFO - 
2025-10-30 20:12:57,926 - run - INFO - 
2025-10-30 20:12:57,927 - run - INFO - ======================================================================
2025-10-30 20:12:57,927 - run - INFO - [5/7] Running Attack Simulation...
2025-10-30 20:12:57,928 - run - INFO - ======================================================================
2025-10-30 20:12:57,931 - run - INFO - === Running Attack Simulation ===
2025-10-30 20:12:57,935 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 20:12:57,937 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 20:12:57,941 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 20:12:57,944 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 20:12:57,946 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 20:12:57,947 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 20:12:57,949 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 20:12:57,951 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 20:12:57,951 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 20:12:57,952 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 20:12:57,971 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 20:12:57,994 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_201257_20251030_201257.json
2025-10-30 20:12:57,995 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 20:12:57,997 - run - INFO - [OK] Simulation complete
2025-10-30 20:12:57,998 - run - INFO - 
2025-10-30 20:12:57,998 - run - INFO -   Waiting 15 seconds for Filebeat to collect logs...
2025-10-30 20:13:13,000 - run - INFO - 
2025-10-30 20:13:13,002 - run - INFO - ======================================================================
2025-10-30 20:13:13,003 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-30 20:13:13,004 - run - INFO - ======================================================================
2025-10-30 20:13:13,013 - run - INFO - ========================================
2025-10-30 20:13:13,019 - run - INFO - Running Full SIEM Pipeline
2025-10-30 20:13:13,020 - run - INFO - ========================================
2025-10-30 20:13:13,021 - run - INFO - === Running Threat Detection ===
2025-10-30 20:13:13,109 - opensearch - INFO - POST http://localhost:9200/filebeat-*/_search [status:200 request:0.088s]
2025-10-30 20:13:13,111 - detection.threat_detector - INFO - Retrieved 0 logs from OpenSearch
2025-10-30 20:13:13,112 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 20:13:13,113 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 20:13:13,115 - run - INFO - [OK] Pipeline complete
2025-10-30 20:13:13,116 - run - INFO - 
2025-10-30 20:13:13,120 - run - INFO - 
2025-10-30 20:13:13,121 - run - INFO - ======================================================================
2025-10-30 20:13:13,122 - run - INFO - [7/7] Opening ThreatOps Dashboard...
2025-10-30 20:13:13,135 - run - INFO - ======================================================================
2025-10-30 20:13:13,165 - run - INFO - [OK] Dashboard starting...
2025-10-30 20:13:13,167 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-30 20:13:18,169 - run - INFO - Opening browser: http://localhost:8501
2025-10-30 20:13:18,411 - run - INFO - [OK] Dashboard opened in browser
2025-10-30 20:13:18,412 - run - INFO - ======================================================================
2025-10-30 20:13:18,413 - run - INFO - 
2025-10-30 20:13:18,414 - run - INFO - 
2025-10-30 20:13:18,415 - run - INFO - ======================================================================
2025-10-30 20:13:18,418 - run - INFO - COMPLETE! All systems operational!
2025-10-30 20:13:18,418 - run - INFO - ======================================================================
2025-10-30 20:13:18,418 - run - INFO - 
2025-10-30 20:13:18,418 - run - INFO - Services running:
2025-10-30 20:13:18,419 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-10-30 20:13:18,419 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (login: root/root)
2025-10-30 20:13:18,419 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-10-30 20:13:18,420 - run - INFO - 
2025-10-30 20:13:18,421 - run - INFO - Log Sources Active:
2025-10-30 20:13:18,421 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-30 20:13:18,422 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-30 20:13:18,422 - run - INFO -    [*] Windows System logs (real system events)
2025-10-30 20:13:18,422 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-30 20:13:18,422 - run - INFO - 
2025-10-30 20:13:18,423 - run - INFO - ======================================================================
2025-10-30 20:13:18,423 - run - INFO - 
2025-10-30 20:16:29,269 - run - INFO - ======================================================================
2025-10-30 20:16:29,270 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 20:16:29,270 - run - INFO - ======================================================================
2025-10-30 20:16:29,270 - run - INFO - 
2025-10-30 20:16:29,271 - run - INFO - ======================================================================
2025-10-30 20:16:29,271 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 20:16:29,271 - run - INFO - ======================================================================
2025-10-30 20:16:29,288 - run - INFO - [OK] OpenSearch started
2025-10-30 20:16:29,289 - run - INFO -   Waiting 60 seconds for initialization...
2025-10-30 20:17:29,867 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-10-30 20:17:29,868 - run - INFO - 
2025-10-30 20:17:29,868 - run - INFO - ======================================================================
2025-10-30 20:17:29,869 - run - INFO - [2/3] Starting Filebeat...
2025-10-30 20:17:29,869 - run - INFO - ======================================================================
2025-10-30 20:17:29,877 - run - INFO - [OK] Filebeat started
2025-10-30 20:17:29,877 - run - INFO -   Waiting 10 seconds for connection...
2025-10-30 20:17:39,882 - run - INFO - 
2025-10-30 20:17:39,883 - run - INFO - ======================================================================
2025-10-30 20:17:39,884 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-10-30 20:17:39,884 - run - INFO - ======================================================================
2025-10-30 20:17:39,904 - run - INFO - [OK] OpenSearch Dashboards started
2025-10-30 20:17:39,904 - run - INFO -   URL: http://localhost:5601
2025-10-30 20:17:39,904 - run - INFO -   Login: root / root
2025-10-30 20:17:39,905 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-10-30 20:17:39,905 - run - INFO - 
2025-10-30 20:17:39,905 - run - INFO - ======================================================================
2025-10-30 20:17:39,906 - run - INFO - [OK] All services started successfully!
2025-10-30 20:17:39,906 - run - INFO - ======================================================================
2025-10-30 20:17:39,906 - run - INFO - 
2025-10-30 20:17:39,907 - run - INFO - 
2025-10-30 20:17:39,907 - run - INFO - ======================================================================
2025-10-30 20:17:39,907 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-30 20:17:39,907 - run - INFO - ======================================================================
2025-10-30 20:18:02,106 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 20:18:02,107 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 20:18:02,158 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:18:02,158 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:18:02,160 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 20:18:02,160 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 20:18:02,161 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 20:18:02,161 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 20:18:02,164 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 20:18:02,164 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 20:18:02,165 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 20:18:02,165 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 20:18:02,165 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 20:18:02,166 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 20:18:02,166 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 20:18:02,167 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 20:18:02,167 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 20:18:02,168 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 20:18:02,168 - run - INFO - Initialization complete
2025-10-30 20:18:02,169 - run - INFO - [OK] Pipeline initialized
2025-10-30 20:18:02,169 - run - INFO - 
2025-10-30 20:18:02,170 - run - INFO - 
2025-10-30 20:18:02,170 - run - INFO - ======================================================================
2025-10-30 20:18:02,171 - run - INFO - [5/7] Running Attack Simulation...
2025-10-30 20:18:02,171 - run - INFO - ======================================================================
2025-10-30 20:18:02,173 - run - INFO - === Running Attack Simulation ===
2025-10-30 20:18:02,174 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 20:18:02,175 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 20:18:02,176 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 20:18:02,177 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 20:18:02,178 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 20:18:02,179 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 20:18:02,180 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 20:18:02,182 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 20:18:02,182 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 20:18:02,183 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 20:18:02,189 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 20:18:02,195 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_201802_20251030_201802.json
2025-10-30 20:18:02,196 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 20:18:02,197 - run - INFO - [OK] Simulation complete
2025-10-30 20:18:02,198 - run - INFO - 
2025-10-30 20:18:02,198 - run - INFO -   Waiting 45 seconds for Filebeat to collect and index logs...
2025-10-30 20:18:47,199 - run - INFO - 
2025-10-30 20:18:47,199 - run - INFO - ======================================================================
2025-10-30 20:18:47,201 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-30 20:18:47,202 - run - INFO - ======================================================================
2025-10-30 20:18:47,212 - run - INFO - ========================================
2025-10-30 20:18:47,214 - run - INFO - Running Full SIEM Pipeline
2025-10-30 20:18:47,214 - run - INFO - ========================================
2025-10-30 20:18:47,215 - run - INFO - === Running Threat Detection ===
2025-10-30 20:18:47,459 - opensearch - INFO - POST http://localhost:9200/filebeat-*/_search [status:200 request:0.241s]
2025-10-30 20:18:47,460 - detection.threat_detector - INFO - Retrieved 0 logs from OpenSearch
2025-10-30 20:18:47,460 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 20:18:47,460 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 20:18:47,461 - run - INFO - [OK] Pipeline complete
2025-10-30 20:18:47,462 - run - INFO - 
2025-10-30 20:18:47,462 - run - INFO - 
2025-10-30 20:18:47,462 - run - INFO - ======================================================================
2025-10-30 20:18:47,463 - run - INFO - [7/7] Opening ThreatOps Dashboard...
2025-10-30 20:18:47,466 - run - INFO - ======================================================================
2025-10-30 20:18:47,478 - run - INFO - [OK] Dashboard starting...
2025-10-30 20:18:47,479 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-30 20:18:52,480 - run - INFO - Opening browser: http://localhost:8501
2025-10-30 20:18:52,611 - run - INFO - [OK] Dashboard opened in browser
2025-10-30 20:18:52,612 - run - INFO - ======================================================================
2025-10-30 20:18:52,612 - run - INFO - 
2025-10-30 20:18:52,613 - run - INFO - 
2025-10-30 20:18:52,614 - run - INFO - ======================================================================
2025-10-30 20:18:52,614 - run - INFO - COMPLETE! All systems operational!
2025-10-30 20:18:52,614 - run - INFO - ======================================================================
2025-10-30 20:18:52,615 - run - INFO - 
2025-10-30 20:18:52,615 - run - INFO - Services running:
2025-10-30 20:18:52,616 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-10-30 20:18:52,616 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (login: root/root)
2025-10-30 20:18:52,617 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-10-30 20:18:52,617 - run - INFO - 
2025-10-30 20:18:52,618 - run - INFO - Log Sources Active:
2025-10-30 20:18:52,618 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-30 20:18:52,618 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-30 20:18:52,619 - run - INFO -    [*] Windows System logs (real system events)
2025-10-30 20:18:52,619 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-30 20:18:52,619 - run - INFO - 
2025-10-30 20:18:52,620 - run - INFO - ======================================================================
2025-10-30 20:18:52,620 - run - INFO - 
2025-10-30 20:28:49,029 - run - INFO - ============================================================
2025-10-30 20:28:49,029 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 20:28:49,029 - run - INFO - ============================================================
2025-10-30 20:28:52,976 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 20:28:52,976 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 20:28:53,034 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:28:53,035 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:28:53,037 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 20:28:53,037 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 20:28:53,038 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 20:28:53,039 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 20:28:53,040 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 20:28:53,040 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 20:28:53,040 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 20:28:53,045 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 20:28:53,045 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 20:28:53,047 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 20:28:53,047 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 20:28:53,048 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 20:28:53,048 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 20:28:53,050 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 20:28:53,050 - run - INFO - Initialization complete
2025-10-30 20:28:53,052 - run - INFO - Mode: Attack Simulation
2025-10-30 20:28:53,053 - run - INFO - === Running Attack Simulation ===
2025-10-30 20:28:53,055 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 20:28:53,056 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 20:28:53,057 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 20:28:53,059 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 20:28:53,061 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 20:28:53,062 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 20:28:53,063 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 20:28:53,064 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 20:28:53,064 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 20:28:53,065 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 20:28:53,072 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 20:28:53,083 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_202853_20251030_202853.json
2025-10-30 20:28:53,084 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 20:28:53,086 - run - INFO - ============================================================
2025-10-30 20:28:53,086 - run - INFO - Run completed successfully
2025-10-30 20:28:53,087 - run - INFO - ============================================================
2025-10-30 20:31:29,196 - run - INFO - ======================================================================
2025-10-30 20:31:29,197 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 20:31:29,197 - run - INFO - ======================================================================
2025-10-30 20:31:29,198 - run - INFO - 
2025-10-30 20:31:29,198 - run - INFO - ======================================================================
2025-10-30 20:31:29,198 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 20:31:29,199 - run - INFO - ======================================================================
2025-10-30 20:31:29,218 - run - INFO - [OK] OpenSearch started
2025-10-30 20:31:29,219 - run - INFO -   Waiting 60 seconds for initialization...
2025-10-30 20:32:29,486 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-10-30 20:32:29,487 - run - INFO - 
2025-10-30 20:32:29,487 - run - INFO - ======================================================================
2025-10-30 20:32:29,487 - run - INFO - [2/3] Starting Filebeat...
2025-10-30 20:32:29,488 - run - INFO - ======================================================================
2025-10-30 20:32:29,499 - run - INFO - [OK] Filebeat started
2025-10-30 20:32:29,499 - run - INFO -   Waiting 10 seconds for connection...
2025-10-30 20:32:39,500 - run - INFO - 
2025-10-30 20:32:39,501 - run - INFO - ======================================================================
2025-10-30 20:32:39,501 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-10-30 20:32:39,502 - run - INFO - ======================================================================
2025-10-30 20:32:39,535 - run - INFO - [OK] OpenSearch Dashboards started
2025-10-30 20:32:39,536 - run - INFO -   URL: http://localhost:5601
2025-10-30 20:32:39,538 - run - INFO -   Login: root / root
2025-10-30 20:32:39,539 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-10-30 20:32:39,540 - run - INFO - 
2025-10-30 20:32:39,541 - run - INFO - ======================================================================
2025-10-30 20:32:39,541 - run - INFO - [OK] All services started successfully!
2025-10-30 20:32:39,541 - run - INFO - ======================================================================
2025-10-30 20:32:39,541 - run - INFO - 
2025-10-30 20:32:39,543 - run - INFO - 
2025-10-30 20:32:39,543 - run - INFO - ======================================================================
2025-10-30 20:32:39,543 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-30 20:32:39,544 - run - INFO - ======================================================================
2025-10-30 20:32:43,008 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 20:32:43,008 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 20:32:43,062 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:32:43,062 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:32:43,064 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 20:32:43,065 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 20:32:43,066 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 20:32:43,066 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 20:32:43,066 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 20:32:43,067 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 20:32:43,067 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 20:32:43,067 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 20:32:43,067 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 20:32:43,068 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 20:32:43,068 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 20:32:43,068 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 20:32:43,069 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 20:32:43,069 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 20:32:43,071 - run - INFO - Initialization complete
2025-10-30 20:32:43,072 - run - INFO - [OK] Pipeline initialized
2025-10-30 20:32:43,072 - run - INFO - 
2025-10-30 20:32:43,072 - run - INFO - 
2025-10-30 20:32:43,072 - run - INFO - ======================================================================
2025-10-30 20:32:43,072 - run - INFO - [5/7] Running Attack Simulation...
2025-10-30 20:32:43,073 - run - INFO - ======================================================================
2025-10-30 20:32:43,073 - run - INFO - === Running Attack Simulation ===
2025-10-30 20:32:43,075 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 20:32:43,076 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 20:32:43,078 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 20:32:43,079 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 20:32:43,080 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 20:32:43,082 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 20:32:43,083 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 20:32:43,083 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 20:32:43,084 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 20:32:43,084 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 20:32:43,090 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 20:32:43,098 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_203243_20251030_203243.json
2025-10-30 20:32:43,099 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 20:32:43,100 - run - INFO - [OK] Simulation complete
2025-10-30 20:32:43,100 - run - INFO - 
2025-10-30 20:32:43,100 - run - INFO -   Waiting 45 seconds for Filebeat to collect and index logs...
2025-10-30 20:33:28,102 - run - INFO - 
2025-10-30 20:33:28,102 - run - INFO - ======================================================================
2025-10-30 20:33:28,103 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-30 20:33:28,103 - run - INFO - ======================================================================
2025-10-30 20:33:28,106 - run - INFO - ========================================
2025-10-30 20:33:28,106 - run - INFO - Running Full SIEM Pipeline
2025-10-30 20:33:28,107 - run - INFO - ========================================
2025-10-30 20:33:28,107 - run - INFO - === Running Threat Detection ===
2025-10-30 20:33:28,154 - opensearch - INFO - POST http://localhost:9200/filebeat-*/_search [status:200 request:0.046s]
2025-10-30 20:33:28,155 - detection.threat_detector - INFO - Retrieved 0 logs from OpenSearch
2025-10-30 20:33:28,155 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 20:33:28,155 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 20:33:28,156 - run - INFO - [OK] Pipeline complete
2025-10-30 20:33:28,157 - run - INFO - 
2025-10-30 20:33:28,157 - run - INFO - 
2025-10-30 20:33:28,158 - run - INFO - ======================================================================
2025-10-30 20:33:28,158 - run - INFO - [7/7] Opening ThreatOps Dashboard...
2025-10-30 20:33:28,158 - run - INFO - ======================================================================
2025-10-30 20:33:28,170 - run - INFO - [OK] Dashboard starting...
2025-10-30 20:33:28,170 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-30 20:33:33,172 - run - INFO - Opening browser: http://localhost:8501
2025-10-30 20:33:33,283 - run - INFO - [OK] Dashboard opened in browser
2025-10-30 20:33:33,284 - run - INFO - ======================================================================
2025-10-30 20:33:33,285 - run - INFO - 
2025-10-30 20:33:33,286 - run - INFO - 
2025-10-30 20:33:33,286 - run - INFO - ======================================================================
2025-10-30 20:33:33,287 - run - INFO - COMPLETE! All systems operational!
2025-10-30 20:33:33,287 - run - INFO - ======================================================================
2025-10-30 20:33:33,288 - run - INFO - 
2025-10-30 20:33:33,288 - run - INFO - Services running:
2025-10-30 20:33:33,289 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-10-30 20:33:33,289 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (login: root/root)
2025-10-30 20:33:33,290 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-10-30 20:33:33,290 - run - INFO - 
2025-10-30 20:33:33,290 - run - INFO - Log Sources Active:
2025-10-30 20:33:33,290 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-30 20:33:33,290 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-30 20:33:33,291 - run - INFO -    [*] Windows System logs (real system events)
2025-10-30 20:33:33,291 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-30 20:33:33,291 - run - INFO - 
2025-10-30 20:33:33,292 - run - INFO - ======================================================================
2025-10-30 20:33:33,292 - run - INFO - 
2025-10-30 20:37:36,684 - run - INFO - ============================================================
2025-10-30 20:37:36,685 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 20:37:36,685 - run - INFO - ============================================================
2025-10-30 20:37:41,055 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 20:37:41,056 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 20:37:41,114 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:37:41,115 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:37:41,117 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 20:37:41,118 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 20:37:41,121 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 20:37:41,121 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 20:37:41,122 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 20:37:41,122 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 20:37:41,123 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 20:37:41,123 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 20:37:41,123 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 20:37:41,124 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 20:37:41,124 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 20:37:41,124 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 20:37:41,125 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 20:37:41,126 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 20:37:41,126 - run - INFO - Initialization complete
2025-10-30 20:37:41,127 - run - INFO - Mode: Attack Simulation
2025-10-30 20:37:41,129 - run - INFO - === Running Attack Simulation ===
2025-10-30 20:37:41,130 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 20:37:41,131 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 20:37:41,134 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 20:37:41,138 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 20:37:41,139 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 20:37:41,140 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 20:37:41,141 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 20:37:41,142 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 20:37:41,143 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 20:37:41,143 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 20:37:41,151 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 20:37:41,160 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_203741_20251030_203741.json
2025-10-30 20:37:41,161 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 20:37:41,162 - run - INFO - ============================================================
2025-10-30 20:37:41,163 - run - INFO - Run completed successfully
2025-10-30 20:37:41,163 - run - INFO - ============================================================
2025-10-30 20:41:38,141 - run - INFO - ============================================================
2025-10-30 20:41:38,142 - run - INFO - ThreatOps SIEM Pipeline
2025-10-30 20:41:38,142 - run - INFO - ============================================================
2025-10-30 20:41:41,611 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 20:41:41,611 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 20:41:41,664 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:41:41,665 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:41:41,667 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 20:41:41,668 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 20:41:41,669 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 20:41:41,671 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 20:41:41,672 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 20:41:41,673 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 20:41:41,674 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 20:41:41,675 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 20:41:41,675 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 20:41:41,676 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 20:41:41,676 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 20:41:41,677 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 20:41:41,677 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 20:41:41,679 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 20:41:41,679 - run - INFO - Initialization complete
2025-10-30 20:41:41,680 - run - INFO - Mode: Full Pipeline
2025-10-30 20:41:41,682 - run - INFO - ========================================
2025-10-30 20:41:41,682 - run - INFO - Running Full SIEM Pipeline
2025-10-30 20:41:41,682 - run - INFO - ========================================
2025-10-30 20:41:41,682 - run - INFO - === Running Threat Detection ===
2025-10-30 20:41:41,765 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.082s]
2025-10-30 20:41:41,766 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-10-30 20:41:41,766 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 20:41:41,766 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 20:41:41,767 - run - INFO - ============================================================
2025-10-30 20:41:41,768 - run - INFO - Run completed successfully
2025-10-30 20:41:41,768 - run - INFO - ============================================================
2025-10-30 20:52:39,500 - run - INFO - ======================================================================
2025-10-30 20:52:39,501 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 20:52:39,501 - run - INFO - ======================================================================
2025-10-30 20:52:39,502 - run - INFO - 
2025-10-30 20:52:39,502 - run - INFO - ======================================================================
2025-10-30 20:52:39,502 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 20:52:39,502 - run - INFO - ======================================================================
2025-10-30 20:52:39,517 - run - INFO - [OK] OpenSearch started
2025-10-30 20:52:39,518 - run - INFO -   Waiting 60 seconds for initialization...
2025-10-30 20:53:40,332 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-10-30 20:53:40,332 - run - INFO - 
2025-10-30 20:53:40,333 - run - INFO - ======================================================================
2025-10-30 20:53:40,333 - run - INFO - [2/3] Starting Filebeat...
2025-10-30 20:53:40,333 - run - INFO - ======================================================================
2025-10-30 20:53:40,346 - run - INFO - [OK] Filebeat started
2025-10-30 20:53:40,347 - run - INFO -   Waiting 10 seconds for connection...
2025-10-30 20:53:50,348 - run - INFO - 
2025-10-30 20:53:50,348 - run - INFO - ======================================================================
2025-10-30 20:53:50,348 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-10-30 20:53:50,349 - run - INFO - ======================================================================
2025-10-30 20:53:50,373 - run - INFO - [OK] OpenSearch Dashboards started
2025-10-30 20:53:50,374 - run - INFO -   URL: http://localhost:5601
2025-10-30 20:53:50,375 - run - INFO -   Login: root / root
2025-10-30 20:53:50,375 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-10-30 20:53:50,375 - run - INFO - 
2025-10-30 20:53:50,376 - run - INFO - ======================================================================
2025-10-30 20:53:50,376 - run - INFO - [OK] All services started successfully!
2025-10-30 20:53:50,376 - run - INFO - ======================================================================
2025-10-30 20:53:50,377 - run - INFO - 
2025-10-30 20:53:50,377 - run - INFO - 
2025-10-30 20:53:50,378 - run - INFO - ======================================================================
2025-10-30 20:53:50,378 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-30 20:53:50,378 - run - INFO - ======================================================================
2025-10-30 20:53:54,254 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 20:53:54,255 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 20:53:54,308 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:53:54,309 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 20:53:54,310 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 20:53:54,311 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 20:53:54,311 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 20:53:54,312 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 20:53:54,313 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 20:53:54,313 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 20:53:54,313 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 20:53:54,314 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 20:53:54,314 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 20:53:54,315 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 20:53:54,315 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 20:53:54,315 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 20:53:54,316 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 20:53:54,317 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 20:53:54,317 - run - INFO - Initialization complete
2025-10-30 20:53:54,318 - run - INFO - [OK] Pipeline initialized
2025-10-30 20:53:54,318 - run - INFO - 
2025-10-30 20:53:54,319 - run - INFO - 
2025-10-30 20:53:54,319 - run - INFO - ======================================================================
2025-10-30 20:53:54,319 - run - INFO - [5/7] Running Attack Simulation...
2025-10-30 20:53:54,320 - run - INFO - ======================================================================
2025-10-30 20:53:54,321 - run - INFO - === Running Attack Simulation ===
2025-10-30 20:53:54,322 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 20:53:54,323 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 20:53:54,324 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 20:53:54,326 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 20:53:54,327 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 20:53:54,327 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 20:53:54,328 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 20:53:54,329 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 20:53:54,330 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 20:53:54,330 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 20:53:54,339 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 20:53:54,346 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_205354_20251030_205354.json
2025-10-30 20:53:54,346 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 20:53:54,347 - run - INFO - [OK] Simulation complete
2025-10-30 20:53:54,348 - run - INFO - 
2025-10-30 20:53:54,348 - run - INFO -   Waiting 45 seconds for Filebeat to collect and index logs...
2025-10-30 20:54:39,349 - run - INFO - 
2025-10-30 20:54:39,350 - run - INFO - ======================================================================
2025-10-30 20:54:39,351 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-30 20:54:39,351 - run - INFO - ======================================================================
2025-10-30 20:54:39,354 - run - INFO - ========================================
2025-10-30 20:54:39,355 - run - INFO - Running Full SIEM Pipeline
2025-10-30 20:54:39,355 - run - INFO - ========================================
2025-10-30 20:54:39,355 - run - INFO - === Running Threat Detection ===
2025-10-30 20:54:39,484 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.128s]
2025-10-30 20:54:39,485 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-10-30 20:54:39,486 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 20:54:39,487 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 20:54:39,488 - run - INFO - [OK] Pipeline complete
2025-10-30 20:54:39,488 - run - INFO - 
2025-10-30 20:54:39,488 - run - INFO - 
2025-10-30 20:54:39,489 - run - INFO - ======================================================================
2025-10-30 20:54:39,489 - run - INFO - [7/7] Opening ThreatOps Dashboard...
2025-10-30 20:54:39,489 - run - INFO - ======================================================================
2025-10-30 20:54:39,504 - run - INFO - [OK] Dashboard starting...
2025-10-30 20:54:39,505 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-30 20:54:44,506 - run - INFO - Opening browser: http://localhost:8501
2025-10-30 20:54:44,610 - run - INFO - [OK] Dashboard opened in browser
2025-10-30 20:54:44,611 - run - INFO - ======================================================================
2025-10-30 20:54:44,612 - run - INFO - 
2025-10-30 20:54:44,612 - run - INFO - 
2025-10-30 20:54:44,612 - run - INFO - ======================================================================
2025-10-30 20:54:44,613 - run - INFO - COMPLETE! All systems operational!
2025-10-30 20:54:44,613 - run - INFO - ======================================================================
2025-10-30 20:54:44,613 - run - INFO - 
2025-10-30 20:54:44,613 - run - INFO - Services running:
2025-10-30 20:54:44,614 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-10-30 20:54:44,614 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (login: root/root)
2025-10-30 20:54:44,614 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-10-30 20:54:44,614 - run - INFO - 
2025-10-30 20:54:44,615 - run - INFO - Log Sources Active:
2025-10-30 20:54:44,615 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-30 20:54:44,615 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-30 20:54:44,615 - run - INFO -    [*] Windows System logs (real system events)
2025-10-30 20:54:44,618 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-30 20:54:44,619 - run - INFO - 
2025-10-30 20:54:44,619 - run - INFO - ======================================================================
2025-10-30 20:54:44,619 - run - INFO - 
2025-10-30 21:04:25,569 - run - INFO - ======================================================================
2025-10-30 21:04:25,569 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 21:04:25,570 - run - INFO - ======================================================================
2025-10-30 21:04:25,570 - run - INFO - 
2025-10-30 21:04:25,570 - run - INFO - ======================================================================
2025-10-30 21:04:25,571 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 21:04:25,571 - run - INFO - ======================================================================
2025-10-30 21:04:25,591 - run - INFO - [OK] OpenSearch started
2025-10-30 21:04:25,591 - run - INFO -   Waiting 30 seconds for initialization...
2025-10-30 21:04:30,574 - run - INFO - Interrupted by user
2025-10-30 21:04:35,606 - run - INFO - ======================================================================
2025-10-30 21:04:35,607 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-30 21:04:35,607 - run - INFO - ======================================================================
2025-10-30 21:04:35,608 - run - INFO - 
2025-10-30 21:04:35,609 - run - INFO - ======================================================================
2025-10-30 21:04:35,609 - run - INFO - [1/3] Starting OpenSearch...
2025-10-30 21:04:35,609 - run - INFO - ======================================================================
2025-10-30 21:04:35,625 - run - INFO - [OK] OpenSearch started
2025-10-30 21:04:35,626 - run - INFO -   Waiting 30 seconds for initialization...
2025-10-30 21:05:09,958 - run - WARNING - OpenSearch may still be starting: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001DF1E66CD70>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-10-30 21:05:09,958 - run - INFO - 
2025-10-30 21:05:09,959 - run - INFO - ======================================================================
2025-10-30 21:05:09,959 - run - INFO - [2/3] Starting Filebeat...
2025-10-30 21:05:09,960 - run - INFO - ======================================================================
2025-10-30 21:05:09,971 - run - INFO - [OK] Filebeat started
2025-10-30 21:05:09,971 - run - INFO -   Waiting 10 seconds for connection...
2025-10-30 21:05:19,975 - run - INFO - 
2025-10-30 21:05:19,977 - run - INFO - ======================================================================
2025-10-30 21:05:19,978 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-10-30 21:05:19,979 - run - INFO - ======================================================================
2025-10-30 21:05:20,001 - run - INFO - [OK] OpenSearch Dashboards started
2025-10-30 21:05:20,003 - run - INFO -   URL: http://localhost:5601
2025-10-30 21:05:20,004 - run - INFO -   Login: root / root
2025-10-30 21:05:20,047 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-10-30 21:05:20,047 - run - INFO - 
2025-10-30 21:05:20,048 - run - INFO - ======================================================================
2025-10-30 21:05:20,048 - run - INFO - [OK] All services started successfully!
2025-10-30 21:05:20,049 - run - INFO - ======================================================================
2025-10-30 21:05:20,049 - run - INFO - 
2025-10-30 21:05:20,050 - run - INFO - 
2025-10-30 21:05:20,050 - run - INFO - ======================================================================
2025-10-30 21:05:20,051 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-30 21:05:20,051 - run - INFO - ======================================================================
2025-10-30 21:05:23,939 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-30 21:05:23,940 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-30 21:05:23,994 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 21:05:23,995 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-30 21:05:23,997 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-30 21:05:23,997 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-30 21:05:23,998 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-30 21:05:23,998 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-30 21:05:23,999 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-30 21:05:23,999 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-30 21:05:24,000 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-30 21:05:24,000 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-30 21:05:24,001 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-30 21:05:24,001 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-30 21:05:24,002 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-30 21:05:24,002 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-30 21:05:24,003 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-30 21:05:24,004 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-30 21:05:24,004 - run - INFO - Initialization complete
2025-10-30 21:05:24,006 - run - INFO - [OK] Pipeline initialized
2025-10-30 21:05:24,006 - run - INFO - 
2025-10-30 21:05:24,006 - run - INFO - 
2025-10-30 21:05:24,006 - run - INFO - ======================================================================
2025-10-30 21:05:24,007 - run - INFO - [5/7] Running Attack Simulation...
2025-10-30 21:05:24,007 - run - INFO - ======================================================================
2025-10-30 21:05:24,008 - run - INFO - === Running Attack Simulation ===
2025-10-30 21:05:24,010 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-30 21:05:24,011 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-30 21:05:24,012 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-30 21:05:24,013 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-30 21:05:24,014 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-30 21:05:24,015 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-30 21:05:24,016 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-30 21:05:24,016 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-30 21:05:24,017 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-30 21:05:24,017 - run - INFO - Generated 390 simulated attack log entries
2025-10-30 21:05:24,024 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-30 21:05:24,033 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251030_210524_20251030_210524.json
2025-10-30 21:05:24,033 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-30 21:05:24,035 - run - INFO - [OK] Simulation complete
2025-10-30 21:05:24,035 - run - INFO - 
2025-10-30 21:05:24,035 - run - INFO -   Waiting 15 seconds for log indexing...
2025-10-30 21:05:39,036 - run - INFO - 
2025-10-30 21:05:39,037 - run - INFO - ======================================================================
2025-10-30 21:05:39,037 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-30 21:05:39,038 - run - INFO - ======================================================================
2025-10-30 21:05:39,040 - run - INFO - ========================================
2025-10-30 21:05:39,040 - run - INFO - Running Full SIEM Pipeline
2025-10-30 21:05:39,040 - run - INFO - ========================================
2025-10-30 21:05:39,041 - run - INFO - === Running Threat Detection ===
2025-10-30 21:05:39,183 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.142s]
2025-10-30 21:05:39,185 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-10-30 21:05:39,185 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-30 21:05:39,186 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-30 21:05:39,187 - run - INFO - [OK] Pipeline complete
2025-10-30 21:05:39,188 - run - INFO - 
2025-10-30 21:05:39,188 - run - INFO - 
2025-10-30 21:05:39,188 - run - INFO - ======================================================================
2025-10-30 21:05:39,189 - run - INFO - [7/7] Opening ThreatOps Dashboard...
2025-10-30 21:05:39,189 - run - INFO - ======================================================================
2025-10-30 21:05:39,200 - run - INFO - [OK] Dashboard starting...
2025-10-30 21:05:39,201 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-30 21:05:44,202 - run - INFO - Opening browser: http://localhost:8501
2025-10-30 21:05:44,339 - run - INFO - [OK] Dashboard opened in browser
2025-10-30 21:05:44,339 - run - INFO - ======================================================================
2025-10-30 21:05:44,340 - run - INFO - 
2025-10-30 21:05:44,340 - run - INFO - 
2025-10-30 21:05:44,341 - run - INFO - ======================================================================
2025-10-30 21:05:44,341 - run - INFO - COMPLETE! All systems operational!
2025-10-30 21:05:44,341 - run - INFO - ======================================================================
2025-10-30 21:05:44,342 - run - INFO - 
2025-10-30 21:05:44,342 - run - INFO - Services running:
2025-10-30 21:05:44,343 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-10-30 21:05:44,343 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (login: root/root)
2025-10-30 21:05:44,343 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-10-30 21:05:44,344 - run - INFO - 
2025-10-30 21:05:44,344 - run - INFO - Log Sources Active:
2025-10-30 21:05:44,345 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-30 21:05:44,345 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-30 21:05:44,346 - run - INFO -    [*] Windows System logs (real system events)
2025-10-30 21:05:44,347 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-30 21:05:44,347 - run - INFO - 
2025-10-30 21:05:44,347 - run - INFO - ======================================================================
2025-10-30 21:05:44,348 - run - INFO - 
2025-10-31 09:36:03,396 - run - INFO - ======================================================================
2025-10-31 09:36:03,397 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-31 09:36:03,397 - run - INFO - ======================================================================
2025-10-31 09:36:03,398 - run - INFO - 
2025-10-31 09:36:03,398 - run - INFO - ======================================================================
2025-10-31 09:36:03,398 - run - INFO - [1/3] Starting OpenSearch...
2025-10-31 09:36:03,398 - run - INFO - ======================================================================
2025-10-31 09:36:03,450 - run - INFO - [OK] OpenSearch started
2025-10-31 09:36:03,451 - run - INFO -   Waiting 30 seconds for initialization...
2025-10-31 09:36:34,113 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-10-31 09:36:34,114 - run - INFO - 
2025-10-31 09:36:34,114 - run - INFO - ======================================================================
2025-10-31 09:36:34,114 - run - INFO - [2/3] Starting Filebeat...
2025-10-31 09:36:34,115 - run - INFO - ======================================================================
2025-10-31 09:36:34,214 - run - INFO - [OK] Filebeat started
2025-10-31 09:36:34,214 - run - INFO -   Waiting 10 seconds for connection...
2025-10-31 09:36:44,214 - run - INFO - 
2025-10-31 09:36:44,215 - run - INFO - ======================================================================
2025-10-31 09:36:44,215 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-10-31 09:36:44,215 - run - INFO - ======================================================================
2025-10-31 09:36:44,263 - run - INFO - [OK] OpenSearch Dashboards started
2025-10-31 09:36:44,264 - run - INFO -   URL: http://localhost:5601
2025-10-31 09:36:44,264 - run - INFO -   Login: root / root
2025-10-31 09:36:44,265 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-10-31 09:36:44,265 - run - INFO - 
2025-10-31 09:36:44,265 - run - INFO - ======================================================================
2025-10-31 09:36:44,265 - run - INFO - [OK] All services started successfully!
2025-10-31 09:36:44,266 - run - INFO - ======================================================================
2025-10-31 09:36:44,266 - run - INFO - 
2025-10-31 09:36:44,267 - run - INFO - 
2025-10-31 09:36:44,267 - run - INFO - ======================================================================
2025-10-31 09:36:44,268 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-31 09:36:44,268 - run - INFO - ======================================================================
2025-10-31 09:36:59,642 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-31 09:36:59,642 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-31 09:36:59,663 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-31 09:36:59,664 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-31 09:36:59,667 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-31 09:36:59,668 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-31 09:36:59,669 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-31 09:36:59,669 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-31 09:36:59,669 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-31 09:36:59,670 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-31 09:36:59,670 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-31 09:36:59,670 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-31 09:36:59,670 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-31 09:36:59,671 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-31 09:36:59,671 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-31 09:36:59,671 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-31 09:36:59,671 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-31 09:36:59,672 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-31 09:36:59,672 - run - INFO - Initialization complete
2025-10-31 09:36:59,673 - run - INFO - [OK] Pipeline initialized
2025-10-31 09:36:59,673 - run - INFO - 
2025-10-31 09:36:59,673 - run - INFO - 
2025-10-31 09:36:59,673 - run - INFO - ======================================================================
2025-10-31 09:36:59,673 - run - INFO - [5/7] Running Attack Simulation...
2025-10-31 09:36:59,674 - run - INFO - ======================================================================
2025-10-31 09:36:59,676 - run - INFO - === Running Attack Simulation ===
2025-10-31 09:36:59,677 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-31 09:36:59,678 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-31 09:36:59,680 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-31 09:36:59,681 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-31 09:36:59,682 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-31 09:36:59,682 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-31 09:36:59,683 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-31 09:36:59,684 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-31 09:36:59,684 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-31 09:36:59,685 - run - INFO - Generated 390 simulated attack log entries
2025-10-31 09:36:59,689 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-31 09:36:59,693 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251031_093659_20251031_093659.json
2025-10-31 09:36:59,693 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-31 09:36:59,694 - run - INFO - [OK] Simulation complete
2025-10-31 09:36:59,694 - run - INFO - 
2025-10-31 09:36:59,694 - run - INFO -   Waiting 15 seconds for log indexing...
2025-10-31 09:37:14,695 - run - INFO - 
2025-10-31 09:37:14,696 - run - INFO - ======================================================================
2025-10-31 09:37:14,696 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-31 09:37:14,696 - run - INFO - ======================================================================
2025-10-31 09:37:14,698 - run - INFO - ========================================
2025-10-31 09:37:14,698 - run - INFO - Running Full SIEM Pipeline
2025-10-31 09:37:14,698 - run - INFO - ========================================
2025-10-31 09:37:14,698 - run - INFO - === Running Threat Detection ===
2025-10-31 09:37:14,773 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.074s]
2025-10-31 09:37:14,773 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-10-31 09:37:14,774 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-31 09:37:14,774 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-31 09:37:14,774 - run - INFO - [OK] Pipeline complete
2025-10-31 09:37:14,774 - run - INFO - 
2025-10-31 09:37:14,775 - run - INFO - 
2025-10-31 09:37:14,775 - run - INFO - ======================================================================
2025-10-31 09:37:14,775 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-10-31 09:37:14,775 - run - INFO - ======================================================================
2025-10-31 09:37:14,782 - run - INFO - [OK] Dashboard starting...
2025-10-31 09:37:14,782 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-31 09:37:19,783 - run - INFO - 
2025-10-31 09:37:19,784 - run - INFO - Waiting 90 seconds for OpenSearch Dashboards to fully start...
2025-10-31 09:37:19,784 - run - INFO - (This is normal - OpenSearch Dashboards takes time to initialize)
2025-10-31 09:38:49,785 - run - INFO - 
2025-10-31 09:38:49,785 - run - INFO - ======================================================================
2025-10-31 09:38:49,785 - run - INFO - Opening all dashboards in browser...
2025-10-31 09:38:49,786 - run - INFO - ======================================================================
2025-10-31 09:38:49,786 - run - INFO - Opening ThreatOps Dashboard...
2025-10-31 09:38:50,897 - run - INFO - Opening OpenSearch Dashboards...
2025-10-31 09:38:51,931 - run - INFO - Opening OpenSearch API...
2025-10-31 09:38:52,965 - run - INFO - 
2025-10-31 09:38:52,966 - run - INFO - [OK] All dashboards opened!
2025-10-31 09:38:52,966 - run - INFO - ======================================================================
2025-10-31 09:38:52,966 - run - INFO - 
2025-10-31 09:38:52,967 - run - INFO - 
2025-10-31 09:38:52,967 - run - INFO - ======================================================================
2025-10-31 09:38:52,967 - run - INFO - COMPLETE! All systems operational!
2025-10-31 09:38:52,967 - run - INFO - ======================================================================
2025-10-31 09:38:52,968 - run - INFO - 
2025-10-31 09:38:52,968 - run - INFO - Services running:
2025-10-31 09:38:52,969 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-10-31 09:38:52,969 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (login: root/root)
2025-10-31 09:38:52,969 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-10-31 09:38:52,969 - run - INFO - 
2025-10-31 09:38:52,970 - run - INFO - Log Sources Active:
2025-10-31 09:38:52,970 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-31 09:38:52,970 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-31 09:38:52,971 - run - INFO -    [*] Windows System logs (real system events)
2025-10-31 09:38:52,971 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-31 09:38:52,971 - run - INFO - 
2025-10-31 09:38:52,971 - run - INFO - ======================================================================
2025-10-31 09:38:52,972 - run - INFO - 
2025-10-31 09:38:53,033 - run - INFO - ======================================================================
2025-10-31 09:42:01,365 - run - INFO - 
2025-10-31 09:42:01,365 - run - INFO - ======================================================================
2025-10-31 09:42:01,365 - run - INFO - Cleaning up all background processes...
2025-10-31 09:42:01,366 - run - INFO - ======================================================================
2025-10-31 09:52:52,810 - run - INFO - ======================================================================
2025-10-31 09:52:52,810 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-10-31 09:52:52,810 - run - INFO - ======================================================================
2025-10-31 09:52:52,811 - run - INFO - 
2025-10-31 09:52:52,811 - run - INFO - ======================================================================
2025-10-31 09:52:52,811 - run - INFO - [1/3] Starting OpenSearch...
2025-10-31 09:52:52,811 - run - INFO - ======================================================================
2025-10-31 09:52:52,823 - run - INFO - [OK] OpenSearch started
2025-10-31 09:52:52,824 - run - INFO -   Waiting 30 seconds for initialization...
2025-10-31 09:53:23,613 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-10-31 09:53:23,614 - run - INFO - 
2025-10-31 09:53:23,614 - run - INFO - ======================================================================
2025-10-31 09:53:23,614 - run - INFO - [2/3] Starting Filebeat...
2025-10-31 09:53:23,614 - run - INFO - ======================================================================
2025-10-31 09:53:23,719 - run - INFO - [OK] Filebeat started
2025-10-31 09:53:23,719 - run - INFO -   Waiting 10 seconds for connection...
2025-10-31 09:53:33,722 - run - INFO - 
2025-10-31 09:53:33,724 - run - INFO - ======================================================================
2025-10-31 09:53:33,725 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-10-31 09:53:33,726 - run - INFO - ======================================================================
2025-10-31 09:53:33,744 - run - INFO - [OK] OpenSearch Dashboards started
2025-10-31 09:53:33,748 - run - INFO -   URL: http://localhost:5601
2025-10-31 09:53:33,749 - run - INFO -   Login: root / root
2025-10-31 09:53:33,750 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-10-31 09:53:33,750 - run - INFO - 
2025-10-31 09:53:33,750 - run - INFO - ======================================================================
2025-10-31 09:53:33,751 - run - INFO - [OK] All services started successfully!
2025-10-31 09:53:33,751 - run - INFO - ======================================================================
2025-10-31 09:53:33,752 - run - INFO - 
2025-10-31 09:53:33,753 - run - INFO - 
2025-10-31 09:53:33,754 - run - INFO - ======================================================================
2025-10-31 09:53:33,755 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-10-31 09:53:33,755 - run - INFO - ======================================================================
2025-10-31 09:53:51,449 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-10-31 09:53:51,449 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-10-31 09:53:51,462 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-31 09:53:51,464 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-10-31 09:53:51,467 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-10-31 09:53:51,468 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-10-31 09:53:51,469 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-10-31 09:53:51,470 - detection.threat_detector - INFO - Initializing threat detector...
2025-10-31 09:53:51,488 - detection.threat_detector - INFO - Connected to OpenSearch
2025-10-31 09:53:51,489 - detection.threat_detector - INFO - Initializing ML detector...
2025-10-31 09:53:51,490 - detection.threat_detector - INFO - ML detector initialized successfully
2025-10-31 09:53:51,490 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-10-31 09:53:51,491 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-10-31 09:53:51,491 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-10-31 09:53:51,492 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-10-31 09:53:51,492 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-10-31 09:53:51,498 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-10-31 09:53:51,499 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-10-31 09:53:51,500 - run - INFO - Initialization complete
2025-10-31 09:53:51,501 - run - INFO - [OK] Pipeline initialized
2025-10-31 09:53:51,502 - run - INFO - 
2025-10-31 09:53:51,502 - run - INFO - 
2025-10-31 09:53:51,503 - run - INFO - ======================================================================
2025-10-31 09:53:51,503 - run - INFO - [5/7] Running Attack Simulation...
2025-10-31 09:53:51,503 - run - INFO - ======================================================================
2025-10-31 09:53:51,504 - run - INFO - === Running Attack Simulation ===
2025-10-31 09:53:51,505 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-10-31 09:53:51,506 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-10-31 09:53:51,508 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-10-31 09:53:51,509 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-10-31 09:53:51,509 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-10-31 09:53:51,509 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-10-31 09:53:51,510 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-10-31 09:53:51,510 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-10-31 09:53:51,510 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-10-31 09:53:51,510 - run - INFO - Generated 390 simulated attack log entries
2025-10-31 09:53:51,517 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-10-31 09:53:51,527 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251031_095351_20251031_095351.json
2025-10-31 09:53:51,529 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-10-31 09:53:51,531 - run - INFO - [OK] Simulation complete
2025-10-31 09:53:51,531 - run - INFO - 
2025-10-31 09:53:51,532 - run - INFO -   Waiting 15 seconds for log indexing...
2025-10-31 09:54:06,533 - run - INFO - 
2025-10-31 09:54:06,533 - run - INFO - ======================================================================
2025-10-31 09:54:06,534 - run - INFO - [6/7] Running Detection Pipeline...
2025-10-31 09:54:06,534 - run - INFO - ======================================================================
2025-10-31 09:54:06,536 - run - INFO - ========================================
2025-10-31 09:54:06,536 - run - INFO - Running Full SIEM Pipeline
2025-10-31 09:54:06,536 - run - INFO - ========================================
2025-10-31 09:54:06,537 - run - INFO - === Running Threat Detection ===
2025-10-31 09:54:06,613 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.076s]
2025-10-31 09:54:06,614 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-10-31 09:54:06,614 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-10-31 09:54:06,615 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-10-31 09:54:06,615 - run - INFO - [OK] Pipeline complete
2025-10-31 09:54:06,616 - run - INFO - 
2025-10-31 09:54:06,616 - run - INFO - 
2025-10-31 09:54:06,616 - run - INFO - ======================================================================
2025-10-31 09:54:06,616 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-10-31 09:54:06,616 - run - INFO - ======================================================================
2025-10-31 09:54:06,627 - run - INFO - [OK] Dashboard starting...
2025-10-31 09:54:06,628 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-10-31 09:54:11,630 - run - INFO - 
2025-10-31 09:54:11,631 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-10-31 09:54:11,632 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-10-31 09:54:15,708 - run - INFO - Waiting... (1/12)
2025-10-31 09:54:29,792 - run - INFO - Waiting... (2/12)
2025-10-31 09:54:43,871 - run - INFO - Waiting... (3/12)
2025-10-31 09:54:57,972 - run - INFO - Waiting... (4/12)
2025-10-31 09:55:12,014 - run - INFO - Waiting... (5/12)
2025-10-31 09:55:26,044 - run - INFO - Waiting... (6/12)
2025-10-31 09:55:40,159 - run - INFO - Waiting... (7/12)
2025-10-31 09:55:54,210 - run - INFO - Waiting... (8/12)
2025-10-31 09:56:08,257 - run - INFO - Waiting... (9/12)
2025-10-31 09:56:22,354 - run - INFO - Waiting... (10/12)
2025-10-31 09:56:36,407 - run - INFO - Waiting... (11/12)
2025-10-31 09:56:50,443 - run - WARNING - [!] OpenSearch Dashboards may still be starting - will try to open anyway
2025-10-31 09:56:50,445 - run - INFO - 
2025-10-31 09:56:50,446 - run - INFO - ======================================================================
2025-10-31 09:56:50,446 - run - INFO - Opening all dashboards in browser...
2025-10-31 09:56:50,447 - run - INFO - ======================================================================
2025-10-31 09:56:50,447 - run - INFO - Opening ThreatOps Dashboard...
2025-10-31 09:56:50,539 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-10-31 09:56:51,541 - run - INFO - Opening OpenSearch Dashboards...
2025-10-31 09:56:51,571 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (login: root/root)
2025-10-31 09:56:52,572 - run - INFO - Opening OpenSearch API...
2025-10-31 09:56:52,612 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-10-31 09:56:53,613 - run - INFO - 
2025-10-31 09:56:53,614 - run - INFO - [OK] All dashboards opened!
2025-10-31 09:56:53,614 - run - INFO - ======================================================================
2025-10-31 09:56:53,614 - run - INFO - 
2025-10-31 09:56:53,615 - run - INFO - 
2025-10-31 09:56:53,615 - run - INFO - ======================================================================
2025-10-31 09:56:53,616 - run - INFO - COMPLETE! All systems operational!
2025-10-31 09:56:53,617 - run - INFO - ======================================================================
2025-10-31 09:56:53,617 - run - INFO - 
2025-10-31 09:56:53,617 - run - INFO - Services running:
2025-10-31 09:56:53,618 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-10-31 09:56:53,618 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (login: root/root)
2025-10-31 09:56:53,619 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-10-31 09:56:53,619 - run - INFO - 
2025-10-31 09:56:53,619 - run - INFO - Log Sources Active:
2025-10-31 09:56:53,620 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-10-31 09:56:53,620 - run - INFO -    [*] Windows Security logs (real system events)
2025-10-31 09:56:53,620 - run - INFO -    [*] Windows System logs (real system events)
2025-10-31 09:56:53,620 - run - INFO -    [*] Windows Application logs (real system events)
2025-10-31 09:56:53,621 - run - INFO - 
2025-10-31 09:56:53,621 - run - INFO - ======================================================================
2025-10-31 09:56:53,621 - run - INFO - 
2025-10-31 09:56:53,621 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-10-31 09:56:53,622 - run - INFO - ======================================================================
2025-10-31 09:57:38,283 - run - INFO - 
2025-10-31 09:57:38,283 - run - INFO - ======================================================================
2025-10-31 09:57:38,284 - run - INFO - Cleaning up all background processes...
2025-10-31 09:57:38,284 - run - INFO - ======================================================================
2025-10-31 09:57:38,285 - run - INFO -   [OK] Killed process PID 13284
2025-10-31 09:57:38,286 - run - INFO -   [OK] Killed process PID 13084
2025-10-31 09:57:38,300 - run - INFO -   [OK] Killed python.exe (PID 8208)
2025-11-01 02:13:39,174 - run - INFO - ======================================================================
2025-11-01 02:13:39,174 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-01 02:13:39,175 - run - INFO - ======================================================================
2025-11-01 02:13:39,175 - run - INFO - 
2025-11-01 02:13:39,175 - run - INFO - ======================================================================
2025-11-01 02:13:39,175 - run - INFO - [1/3] Starting OpenSearch...
2025-11-01 02:13:39,176 - run - INFO - ======================================================================
2025-11-01 02:13:39,262 - run - INFO - [OK] OpenSearch started
2025-11-01 02:13:39,263 - run - INFO -   Waiting 30 seconds for initialization...
2025-11-01 02:14:14,068 - run - WARNING - OpenSearch may still be starting: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x00000188640B23C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-11-01 02:14:14,070 - run - INFO - 
2025-11-01 02:14:14,071 - run - INFO - ======================================================================
2025-11-01 02:14:14,071 - run - INFO - [2/3] Starting Filebeat...
2025-11-01 02:14:14,071 - run - INFO - ======================================================================
2025-11-01 02:14:14,199 - run - INFO - [OK] Filebeat started
2025-11-01 02:14:14,200 - run - INFO -   Waiting 10 seconds for connection...
2025-11-01 02:14:24,201 - run - INFO - 
2025-11-01 02:14:24,203 - run - INFO - ======================================================================
2025-11-01 02:14:24,204 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-01 02:14:24,204 - run - INFO - ======================================================================
2025-11-01 02:14:24,269 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-01 02:14:24,269 - run - INFO -   URL: http://localhost:5601
2025-11-01 02:14:24,270 - run - INFO -   Login: root / root
2025-11-01 02:14:24,270 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-11-01 02:14:24,270 - run - INFO - 
2025-11-01 02:14:24,270 - run - INFO - ======================================================================
2025-11-01 02:14:24,271 - run - INFO - [OK] All services started successfully!
2025-11-01 02:14:24,271 - run - INFO - ======================================================================
2025-11-01 02:14:24,271 - run - INFO - 
2025-11-01 02:14:24,271 - run - INFO - 
2025-11-01 02:14:24,271 - run - INFO - ======================================================================
2025-11-01 02:14:24,272 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-01 02:14:24,272 - run - INFO - ======================================================================
2025-11-01 02:14:50,451 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-01 02:14:50,454 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-01 02:14:50,480 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-01 02:14:50,483 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-01 02:14:50,487 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-01 02:14:50,491 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-01 02:14:50,494 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-01 02:14:50,495 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-01 02:14:50,497 - detection.threat_detector - INFO - Connected to OpenSearch
2025-11-01 02:14:50,498 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-01 02:14:50,498 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-01 02:14:50,499 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-01 02:14:50,500 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-01 02:14:50,501 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-11-01 02:14:50,502 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-11-01 02:14:50,503 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-01 02:14:50,504 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-11-01 02:14:50,507 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-01 02:14:50,508 - run - INFO - Initialization complete
2025-11-01 02:14:50,510 - run - INFO - [OK] Pipeline initialized
2025-11-01 02:14:50,512 - run - INFO - 
2025-11-01 02:14:50,513 - run - INFO - 
2025-11-01 02:14:50,514 - run - INFO - ======================================================================
2025-11-01 02:14:50,515 - run - INFO - [5/7] Running Attack Simulation...
2025-11-01 02:14:50,516 - run - INFO - ======================================================================
2025-11-01 02:14:50,519 - run - INFO - === Running Attack Simulation ===
2025-11-01 02:14:50,522 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-01 02:14:50,526 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-01 02:14:50,527 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-01 02:14:50,530 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-01 02:14:50,531 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-01 02:14:50,532 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-01 02:14:50,534 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-01 02:14:50,537 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-01 02:14:50,537 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-01 02:14:50,538 - run - INFO - Generated 390 simulated attack log entries
2025-11-01 02:14:50,592 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-01 02:14:50,608 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251101_021450_20251101_021450.json
2025-11-01 02:14:50,610 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-01 02:14:50,613 - run - INFO - [OK] Simulation complete
2025-11-01 02:14:50,614 - run - INFO - 
2025-11-01 02:14:50,614 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-01 02:15:05,615 - run - INFO - 
2025-11-01 02:15:05,616 - run - INFO - ======================================================================
2025-11-01 02:15:05,617 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-01 02:15:05,617 - run - INFO - ======================================================================
2025-11-01 02:15:05,620 - run - INFO - ========================================
2025-11-01 02:15:05,621 - run - INFO - Running Full SIEM Pipeline
2025-11-01 02:15:05,622 - run - INFO - ========================================
2025-11-01 02:15:05,623 - run - INFO - === Running Threat Detection ===
2025-11-01 02:15:05,874 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.250s]
2025-11-01 02:15:05,874 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-01 02:15:05,875 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-01 02:15:05,875 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-01 02:15:05,877 - run - INFO - [OK] Pipeline complete
2025-11-01 02:15:05,877 - run - INFO - 
2025-11-01 02:15:05,878 - run - INFO - 
2025-11-01 02:15:05,878 - run - INFO - ======================================================================
2025-11-01 02:15:05,878 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-01 02:15:05,879 - run - INFO - ======================================================================
2025-11-01 02:15:05,891 - run - INFO - [OK] Dashboard starting...
2025-11-01 02:15:05,892 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-01 02:15:10,893 - run - INFO - 
2025-11-01 02:15:10,894 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-01 02:15:10,895 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-01 02:15:14,983 - run - INFO - Waiting... (1/12)
2025-11-01 02:15:29,047 - run - INFO - Waiting... (2/12)
2025-11-01 02:15:43,126 - run - INFO - Waiting... (3/12)
2025-11-01 02:15:57,183 - run - INFO - Waiting... (4/12)
2025-11-01 02:16:11,245 - run - INFO - Waiting... (5/12)
2025-11-01 02:16:25,334 - run - INFO - Waiting... (6/12)
2025-11-01 02:16:39,411 - run - INFO - Waiting... (7/12)
2025-11-01 02:16:53,455 - run - INFO - Waiting... (8/12)
2025-11-01 02:17:07,528 - run - INFO - Waiting... (9/12)
2025-11-01 02:17:21,590 - run - INFO - Waiting... (10/12)
2025-11-01 02:17:35,678 - run - INFO - Waiting... (11/12)
2025-11-01 02:17:49,778 - run - WARNING - [!] OpenSearch Dashboards may still be starting - will try to open anyway
2025-11-01 02:17:49,779 - run - INFO - 
2025-11-01 02:17:49,780 - run - INFO - ======================================================================
2025-11-01 02:17:49,780 - run - INFO - Opening all dashboards in browser...
2025-11-01 02:17:49,780 - run - INFO - ======================================================================
2025-11-01 02:17:49,783 - run - INFO - Opening ThreatOps Dashboard...
2025-11-01 02:17:50,006 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-01 02:17:51,008 - run - INFO - Opening OpenSearch Dashboards...
2025-11-01 02:17:51,093 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (login: root/root)
2025-11-01 02:17:52,095 - run - INFO - Opening OpenSearch API...
2025-11-01 02:17:52,167 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-01 02:17:53,169 - run - INFO - 
2025-11-01 02:17:53,170 - run - INFO - [OK] All dashboards opened!
2025-11-01 02:17:53,170 - run - INFO - ======================================================================
2025-11-01 02:17:53,171 - run - INFO - 
2025-11-01 02:17:53,171 - run - INFO - 
2025-11-01 02:17:53,171 - run - INFO - ======================================================================
2025-11-01 02:17:53,172 - run - INFO - COMPLETE! All systems operational!
2025-11-01 02:17:53,172 - run - INFO - ======================================================================
2025-11-01 02:17:53,173 - run - INFO - 
2025-11-01 02:17:53,173 - run - INFO - Services running:
2025-11-01 02:17:53,174 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-01 02:17:53,174 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (login: root/root)
2025-11-01 02:17:53,175 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-01 02:17:53,175 - run - INFO - 
2025-11-01 02:17:53,176 - run - INFO - Log Sources Active:
2025-11-01 02:17:53,176 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-01 02:17:53,177 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-01 02:17:53,178 - run - INFO -    [*] Windows System logs (real system events)
2025-11-01 02:17:53,178 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-01 02:17:53,179 - run - INFO - 
2025-11-01 02:17:53,179 - run - INFO - ======================================================================
2025-11-01 02:17:53,180 - run - INFO - 
2025-11-01 02:17:53,180 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-01 02:17:53,181 - run - INFO - ======================================================================
2025-11-01 02:18:03,997 - run - INFO - 
2025-11-01 02:18:03,998 - run - INFO - ======================================================================
2025-11-01 02:18:03,999 - run - INFO - Cleaning up all background processes...
2025-11-01 02:18:03,999 - run - INFO - ======================================================================
2025-11-01 02:18:04,001 - run - INFO -   [OK] Killed process PID 15140
2025-11-01 02:18:04,002 - run - INFO -   [OK] Killed process PID 14576
2025-11-02 07:24:56,023 - run - INFO - ======================================================================
2025-11-02 07:24:56,024 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-02 07:24:56,024 - run - INFO - ======================================================================
2025-11-02 07:24:56,024 - run - INFO - 
2025-11-02 07:24:56,025 - run - INFO - ======================================================================
2025-11-02 07:24:56,025 - run - INFO - [1/3] Starting OpenSearch...
2025-11-02 07:24:56,025 - run - INFO - ======================================================================
2025-11-02 07:24:56,050 - run - INFO - [OK] OpenSearch started
2025-11-02 07:24:56,051 - run - INFO -   Waiting 30 seconds for initialization...
2025-11-02 07:25:26,860 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-11-02 07:25:26,861 - run - INFO - 
2025-11-02 07:25:26,862 - run - INFO - ======================================================================
2025-11-02 07:25:26,862 - run - INFO - [2/3] Starting Filebeat...
2025-11-02 07:25:26,862 - run - INFO - ======================================================================
2025-11-02 07:25:26,984 - run - INFO - [OK] Filebeat started
2025-11-02 07:25:26,984 - run - INFO -   Waiting 10 seconds for connection...
2025-11-02 07:25:36,985 - run - INFO - 
2025-11-02 07:25:36,986 - run - INFO - ======================================================================
2025-11-02 07:25:36,986 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-02 07:25:36,986 - run - INFO - ======================================================================
2025-11-02 07:25:37,049 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-02 07:25:37,049 - run - INFO -   URL: http://localhost:5601
2025-11-02 07:25:37,050 - run - INFO -   Login: root / root
2025-11-02 07:25:37,050 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-11-02 07:25:37,050 - run - INFO - 
2025-11-02 07:25:37,050 - run - INFO - ======================================================================
2025-11-02 07:25:37,051 - run - INFO - [OK] All services started successfully!
2025-11-02 07:25:37,051 - run - INFO - ======================================================================
2025-11-02 07:25:37,051 - run - INFO - 
2025-11-02 07:25:37,052 - run - INFO - 
2025-11-02 07:25:37,052 - run - INFO - ======================================================================
2025-11-02 07:25:37,052 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-02 07:25:37,052 - run - INFO - ======================================================================
2025-11-02 07:26:07,607 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-02 07:26:07,608 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-02 07:26:07,731 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-02 07:26:07,733 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-02 07:26:07,736 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-02 07:26:07,737 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-02 07:26:07,738 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-02 07:26:07,741 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-02 07:26:07,743 - detection.threat_detector - INFO - Connected to OpenSearch
2025-11-02 07:26:07,744 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-02 07:26:07,745 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-02 07:26:07,745 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-02 07:26:07,746 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-02 07:26:07,747 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-11-02 07:26:07,748 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-11-02 07:26:07,749 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-02 07:26:07,749 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-11-02 07:26:07,751 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-02 07:26:07,752 - run - INFO - Initialization complete
2025-11-02 07:26:07,754 - run - INFO - [OK] Pipeline initialized
2025-11-02 07:26:07,756 - run - INFO - 
2025-11-02 07:26:07,757 - run - INFO - 
2025-11-02 07:26:07,757 - run - INFO - ======================================================================
2025-11-02 07:26:07,757 - run - INFO - [5/7] Running Attack Simulation...
2025-11-02 07:26:07,758 - run - INFO - ======================================================================
2025-11-02 07:26:07,759 - run - INFO - === Running Attack Simulation ===
2025-11-02 07:26:07,762 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-02 07:26:07,763 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-02 07:26:07,764 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-02 07:26:07,765 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-02 07:26:07,766 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-02 07:26:07,766 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-02 07:26:07,767 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-02 07:26:07,768 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-02 07:26:07,769 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-02 07:26:07,769 - run - INFO - Generated 390 simulated attack log entries
2025-11-02 07:26:07,778 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-02 07:26:07,785 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251102_072607_20251102_072607.json
2025-11-02 07:26:07,785 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-02 07:26:07,786 - run - INFO - [OK] Simulation complete
2025-11-02 07:26:07,786 - run - INFO - 
2025-11-02 07:26:07,787 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-02 07:26:22,787 - run - INFO - 
2025-11-02 07:26:22,788 - run - INFO - ======================================================================
2025-11-02 07:26:22,788 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-02 07:26:22,788 - run - INFO - ======================================================================
2025-11-02 07:26:22,790 - run - INFO - ========================================
2025-11-02 07:26:22,790 - run - INFO - Running Full SIEM Pipeline
2025-11-02 07:26:22,791 - run - INFO - ========================================
2025-11-02 07:26:22,791 - run - INFO - === Running Threat Detection ===
2025-11-02 07:26:22,815 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.023s]
2025-11-02 07:26:22,816 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-02 07:26:22,816 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-02 07:26:22,817 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-02 07:26:22,818 - run - INFO - [OK] Pipeline complete
2025-11-02 07:26:22,819 - run - INFO - 
2025-11-02 07:26:22,819 - run - INFO - 
2025-11-02 07:26:22,820 - run - INFO - ======================================================================
2025-11-02 07:26:22,820 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-02 07:26:22,820 - run - INFO - ======================================================================
2025-11-02 07:26:22,828 - run - INFO - [OK] Dashboard starting...
2025-11-02 07:26:22,828 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-02 07:26:27,830 - run - INFO - 
2025-11-02 07:26:27,831 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-02 07:26:27,831 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-02 07:26:31,897 - run - INFO - Waiting... (1/12)
2025-11-02 07:26:45,968 - run - INFO - Waiting... (2/12)
2025-11-02 07:27:00,033 - run - INFO - Waiting... (3/12)
2025-11-02 07:27:14,092 - run - INFO - Waiting... (4/12)
2025-11-02 07:27:28,186 - run - INFO - Waiting... (5/12)
2025-11-02 07:27:42,250 - run - INFO - Waiting... (6/12)
2025-11-02 07:27:56,331 - run - INFO - Waiting... (7/12)
2025-11-02 07:28:10,405 - run - INFO - Waiting... (8/12)
2025-11-02 07:28:24,461 - run - INFO - Waiting... (9/12)
2025-11-02 07:28:38,563 - run - INFO - Waiting... (10/12)
2025-11-02 16:01:22,605 - run - INFO - ======================================================================
2025-11-02 16:01:22,605 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-02 16:01:22,605 - run - INFO - ======================================================================
2025-11-02 16:01:22,605 - run - INFO - 
2025-11-02 16:01:22,605 - run - INFO - ======================================================================
2025-11-02 16:01:22,605 - run - INFO - [1/3] Starting OpenSearch...
2025-11-02 16:01:22,606 - run - INFO - ======================================================================
2025-11-02 16:01:22,676 - run - INFO - [OK] OpenSearch started
2025-11-02 16:01:22,676 - run - INFO -   Waiting 30 seconds for initialization...
2025-11-02 16:01:57,579 - run - WARNING - OpenSearch may still be starting: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001AFCB7DE3C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-11-02 16:01:57,579 - run - INFO - 
2025-11-02 16:01:57,580 - run - INFO - ======================================================================
2025-11-02 16:01:57,580 - run - INFO - [2/3] Starting Filebeat...
2025-11-02 16:01:57,580 - run - INFO - ======================================================================
2025-11-02 16:01:57,727 - run - INFO - [OK] Filebeat started
2025-11-02 16:01:57,727 - run - INFO -   Waiting 10 seconds for connection...
2025-11-02 16:02:01,574 - run - INFO - ======================================================================
2025-11-02 16:02:01,574 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-02 16:02:01,574 - run - INFO - ======================================================================
2025-11-02 16:02:01,575 - run - INFO - 
2025-11-02 16:02:01,575 - run - INFO - ======================================================================
2025-11-02 16:02:01,575 - run - INFO - [1/3] Starting OpenSearch...
2025-11-02 16:02:01,575 - run - INFO - ======================================================================
2025-11-02 16:02:01,597 - run - INFO - [OK] OpenSearch started
2025-11-02 16:02:01,597 - run - INFO -   Waiting 30 seconds for initialization...
2025-11-02 16:02:07,728 - run - INFO - 
2025-11-02 16:02:07,728 - run - INFO - ======================================================================
2025-11-02 16:02:07,728 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-02 16:02:07,728 - run - INFO - ======================================================================
2025-11-02 16:02:07,787 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-02 16:02:07,787 - run - INFO -   URL: http://localhost:5601
2025-11-02 16:02:07,787 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-11-02 16:02:07,787 - run - INFO - 
2025-11-02 16:02:07,787 - run - INFO - ======================================================================
2025-11-02 16:02:07,787 - run - INFO - [OK] All services started successfully!
2025-11-02 16:02:07,787 - run - INFO - ======================================================================
2025-11-02 16:02:07,787 - run - INFO - 
2025-11-02 16:02:07,787 - run - INFO - 
2025-11-02 16:02:07,787 - run - INFO - ======================================================================
2025-11-02 16:02:07,787 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-02 16:02:07,787 - run - INFO - ======================================================================
2025-11-02 16:02:32,245 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-11-02 16:02:32,246 - run - INFO - 
2025-11-02 16:02:32,246 - run - INFO - ======================================================================
2025-11-02 16:02:32,246 - run - INFO - [2/3] Starting Filebeat...
2025-11-02 16:02:32,246 - run - INFO - ======================================================================
2025-11-02 16:02:32,254 - run - INFO - [OK] Filebeat started
2025-11-02 16:02:32,254 - run - INFO -   Waiting 10 seconds for connection...
2025-11-02 16:02:36,247 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-02 16:02:36,248 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-02 16:02:36,267 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-02 16:02:36,267 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-02 16:02:36,269 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-02 16:02:36,269 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-02 16:02:36,270 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-02 16:02:36,270 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-02 16:02:36,270 - detection.threat_detector - INFO - Connected to OpenSearch
2025-11-02 16:02:36,271 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-02 16:02:36,271 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-02 16:02:36,271 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-02 16:02:36,271 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-02 16:02:36,271 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-11-02 16:02:36,271 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-11-02 16:02:36,271 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-02 16:02:36,271 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-11-02 16:02:36,272 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-02 16:02:36,272 - run - INFO - Initialization complete
2025-11-02 16:02:36,273 - run - INFO - [OK] Pipeline initialized
2025-11-02 16:02:36,273 - run - INFO - 
2025-11-02 16:02:36,273 - run - INFO - 
2025-11-02 16:02:36,273 - run - INFO - ======================================================================
2025-11-02 16:02:36,273 - run - INFO - [5/7] Running Attack Simulation...
2025-11-02 16:02:36,273 - run - INFO - ======================================================================
2025-11-02 16:02:36,274 - run - INFO - === Running Attack Simulation ===
2025-11-02 16:02:36,275 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-02 16:02:36,275 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-02 16:02:36,276 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-02 16:02:36,277 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-02 16:02:36,278 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-02 16:02:36,278 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-02 16:02:36,279 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-02 16:02:36,279 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-02 16:02:36,279 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-02 16:02:36,279 - run - INFO - Generated 390 simulated attack log entries
2025-11-02 16:02:36,286 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-02 16:02:36,291 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251102_160236_20251102_160236.json
2025-11-02 16:02:36,292 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-02 16:02:36,292 - run - INFO - [OK] Simulation complete
2025-11-02 16:02:36,292 - run - INFO - 
2025-11-02 16:02:36,292 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-02 16:02:42,255 - run - INFO - 
2025-11-02 16:02:42,255 - run - INFO - ======================================================================
2025-11-02 16:02:42,255 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-02 16:02:42,256 - run - INFO - ======================================================================
2025-11-02 16:02:42,274 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-02 16:02:42,274 - run - INFO -   URL: http://localhost:5601
2025-11-02 16:02:42,274 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-11-02 16:02:42,274 - run - INFO - 
2025-11-02 16:02:42,274 - run - INFO - ======================================================================
2025-11-02 16:02:42,274 - run - INFO - [OK] All services started successfully!
2025-11-02 16:02:42,274 - run - INFO - ======================================================================
2025-11-02 16:02:42,275 - run - INFO - 
2025-11-02 16:02:42,275 - run - INFO - 
2025-11-02 16:02:42,275 - run - INFO - ======================================================================
2025-11-02 16:02:42,275 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-02 16:02:42,275 - run - INFO - ======================================================================
2025-11-02 16:02:45,257 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-02 16:02:45,257 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-02 16:02:45,269 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-02 16:02:45,269 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-02 16:02:45,271 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-02 16:02:45,271 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-02 16:02:45,271 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-02 16:02:45,272 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-02 16:02:45,272 - detection.threat_detector - INFO - Connected to OpenSearch
2025-11-02 16:02:45,272 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-02 16:02:45,272 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-02 16:02:45,272 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-02 16:02:45,272 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-02 16:02:45,272 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-11-02 16:02:45,273 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-11-02 16:02:45,273 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-02 16:02:45,273 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-11-02 16:02:45,273 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-02 16:02:45,273 - run - INFO - Initialization complete
2025-11-02 16:02:45,274 - run - INFO - [OK] Pipeline initialized
2025-11-02 16:02:45,274 - run - INFO - 
2025-11-02 16:02:45,274 - run - INFO - 
2025-11-02 16:02:45,274 - run - INFO - ======================================================================
2025-11-02 16:02:45,274 - run - INFO - [5/7] Running Attack Simulation...
2025-11-02 16:02:45,274 - run - INFO - ======================================================================
2025-11-02 16:02:45,275 - run - INFO - === Running Attack Simulation ===
2025-11-02 16:02:45,275 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-02 16:02:45,276 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-02 16:02:45,277 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-02 16:02:45,278 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-02 16:02:45,278 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-02 16:02:45,279 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-02 16:02:45,279 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-02 16:02:45,280 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-02 16:02:45,280 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-02 16:02:45,280 - run - INFO - Generated 390 simulated attack log entries
2025-11-02 16:02:45,285 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-02 16:02:45,291 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251102_160245_20251102_160245.json
2025-11-02 16:02:45,291 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-02 16:02:45,292 - run - INFO - [OK] Simulation complete
2025-11-02 16:02:45,292 - run - INFO - 
2025-11-02 16:02:45,292 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-02 16:02:51,293 - run - INFO - 
2025-11-02 16:02:51,293 - run - INFO - ======================================================================
2025-11-02 16:02:51,293 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-02 16:02:51,294 - run - INFO - ======================================================================
2025-11-02 16:02:51,295 - run - INFO - ========================================
2025-11-02 16:02:51,295 - run - INFO - Running Full SIEM Pipeline
2025-11-02 16:02:51,295 - run - INFO - ========================================
2025-11-02 16:02:51,295 - run - INFO - === Running Threat Detection ===
2025-11-02 16:02:51,450 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.154s]
2025-11-02 16:02:51,450 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-02 16:02:51,451 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-02 16:02:51,451 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-02 16:02:51,451 - run - INFO - [OK] Pipeline complete
2025-11-02 16:02:51,452 - run - INFO - 
2025-11-02 16:02:51,452 - run - INFO - 
2025-11-02 16:02:51,452 - run - INFO - ======================================================================
2025-11-02 16:02:51,452 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-02 16:02:51,452 - run - INFO - ======================================================================
2025-11-02 16:02:51,552 - run - INFO - [OK] Dashboard starting...
2025-11-02 16:02:51,553 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-02 16:02:56,553 - run - INFO - 
2025-11-02 16:02:56,554 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-02 16:02:56,554 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-02 16:03:00,294 - run - INFO - 
2025-11-02 16:03:00,296 - run - INFO - ======================================================================
2025-11-02 16:03:00,297 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-02 16:03:00,297 - run - INFO - ======================================================================
2025-11-02 16:03:00,303 - run - INFO - ========================================
2025-11-02 16:03:00,303 - run - INFO - Running Full SIEM Pipeline
2025-11-02 16:03:00,306 - run - INFO - ========================================
2025-11-02 16:03:00,306 - run - INFO - === Running Threat Detection ===
2025-11-02 16:03:00,340 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.033s]
2025-11-02 16:03:00,340 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-02 16:03:00,341 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-02 16:03:00,341 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-02 16:03:00,342 - run - INFO - [OK] Pipeline complete
2025-11-02 16:03:00,342 - run - INFO - 
2025-11-02 16:03:00,343 - run - INFO - 
2025-11-02 16:03:00,343 - run - INFO - ======================================================================
2025-11-02 16:03:00,343 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-02 16:03:00,344 - run - INFO - ======================================================================
2025-11-02 16:03:00,361 - run - INFO - [OK] Dashboard starting...
2025-11-02 16:03:00,362 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-02 16:03:00,594 - run - INFO - Waiting... (1/12)
2025-11-02 16:03:05,362 - run - INFO - 
2025-11-02 16:03:05,363 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-02 16:03:05,363 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-02 16:03:09,427 - run - INFO - Waiting... (1/12)
2025-11-02 16:03:14,632 - run - INFO - Waiting... (2/12)
2025-11-02 16:03:23,501 - run - INFO - Waiting... (2/12)
2025-11-02 16:03:28,699 - run - INFO - Waiting... (3/12)
2025-11-02 16:03:37,595 - run - INFO - Waiting... (3/12)
2025-11-02 16:03:42,777 - run - INFO - Waiting... (4/12)
2025-11-02 16:03:51,659 - run - INFO - Waiting... (4/12)
2025-11-02 16:03:56,812 - run - INFO - Waiting... (5/12)
2025-11-02 16:04:05,711 - run - INFO - Waiting... (5/12)
2025-11-02 16:04:10,866 - run - INFO - Waiting... (6/12)
2025-11-02 16:04:19,785 - run - INFO - Waiting... (6/12)
2025-11-02 16:04:24,942 - run - INFO - Waiting... (7/12)
2025-11-02 16:04:33,877 - run - INFO - Waiting... (7/12)
2025-11-02 16:04:38,970 - run - INFO - Waiting... (8/12)
2025-11-02 16:04:47,947 - run - INFO - Waiting... (8/12)
2025-11-02 16:04:53,016 - run - INFO - Waiting... (9/12)
2025-11-02 16:05:02,060 - run - INFO - Waiting... (9/12)
2025-11-02 16:05:07,095 - run - INFO - Waiting... (10/12)
2025-11-02 16:05:16,145 - run - INFO - Waiting... (10/12)
2025-11-02 16:05:21,158 - run - INFO - Waiting... (11/12)
2025-11-02 16:05:30,198 - run - INFO - Waiting... (11/12)
2025-11-02 16:05:35,204 - run - WARNING - [!] OpenSearch Dashboards may still be starting - will try to open anyway
2025-11-02 16:05:35,204 - run - INFO - 
2025-11-02 16:05:35,205 - run - INFO - ======================================================================
2025-11-02 16:05:35,205 - run - INFO - Opening all dashboards in browser...
2025-11-02 16:05:35,205 - run - INFO - ======================================================================
2025-11-02 16:05:35,205 - run - INFO - Opening ThreatOps Dashboard...
2025-11-02 16:05:35,320 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-02 16:05:36,321 - run - INFO - Opening OpenSearch Dashboards...
2025-11-02 16:05:36,357 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (login: root/root)
2025-11-02 16:05:37,358 - run - INFO - Opening OpenSearch API...
2025-11-02 16:05:37,399 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-02 16:05:38,400 - run - INFO - 
2025-11-02 16:05:38,400 - run - INFO - [OK] All dashboards opened!
2025-11-02 16:05:38,400 - run - INFO - ======================================================================
2025-11-02 16:05:38,400 - run - INFO - 
2025-11-02 16:05:38,400 - run - INFO - 
2025-11-02 16:05:38,400 - run - INFO - ======================================================================
2025-11-02 16:05:38,400 - run - INFO - COMPLETE! All systems operational!
2025-11-02 16:05:38,400 - run - INFO - ======================================================================
2025-11-02 16:05:38,400 - run - INFO - 
2025-11-02 16:05:38,400 - run - INFO - Services running:
2025-11-02 16:05:38,400 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-02 16:05:38,401 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (login: root/root)
2025-11-02 16:05:38,401 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-02 16:05:38,401 - run - INFO - 
2025-11-02 16:05:38,401 - run - INFO - Log Sources Active:
2025-11-02 16:05:38,401 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-02 16:05:38,401 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-02 16:05:38,401 - run - INFO -    [*] Windows System logs (real system events)
2025-11-02 16:05:38,401 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-02 16:05:38,401 - run - INFO - 
2025-11-02 16:05:38,401 - run - INFO - ======================================================================
2025-11-02 16:05:38,401 - run - INFO - 
2025-11-02 16:05:38,401 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-02 16:05:38,401 - run - INFO - ======================================================================
2025-11-02 16:05:38,401 - run - ERROR - Fatal error: EOF when reading a line
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 646, in main
    input()
    ~~~~~^^
EOFError: EOF when reading a line
2025-11-02 16:05:44,271 - run - WARNING - [!] OpenSearch Dashboards may still be starting - will try to open anyway
2025-11-02 16:05:44,272 - run - INFO - 
2025-11-02 16:05:44,272 - run - INFO - ======================================================================
2025-11-02 16:05:44,272 - run - INFO - Opening all dashboards in browser...
2025-11-02 16:05:44,272 - run - INFO - ======================================================================
2025-11-02 16:05:44,272 - run - INFO - Opening ThreatOps Dashboard...
2025-11-02 16:05:44,372 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-02 16:05:45,373 - run - INFO - Opening OpenSearch Dashboards...
2025-11-02 16:05:45,433 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (login: root/root)
2025-11-02 16:05:46,433 - run - INFO - Opening OpenSearch API...
2025-11-02 16:05:46,539 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-02 16:05:47,542 - run - INFO - 
2025-11-02 16:05:47,543 - run - INFO - [OK] All dashboards opened!
2025-11-02 16:05:47,543 - run - INFO - ======================================================================
2025-11-02 16:05:47,544 - run - INFO - 
2025-11-02 16:05:47,544 - run - INFO - 
2025-11-02 16:05:47,544 - run - INFO - ======================================================================
2025-11-02 16:05:47,544 - run - INFO - COMPLETE! All systems operational!
2025-11-02 16:05:47,544 - run - INFO - ======================================================================
2025-11-02 16:05:47,544 - run - INFO - 
2025-11-02 16:05:47,544 - run - INFO - Services running:
2025-11-02 16:05:47,544 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-02 16:05:47,544 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (login: root/root)
2025-11-02 16:05:47,544 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-02 16:05:47,545 - run - INFO - 
2025-11-02 16:05:47,545 - run - INFO - Log Sources Active:
2025-11-02 16:05:47,545 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-02 16:05:47,545 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-02 16:05:47,546 - run - INFO -    [*] Windows System logs (real system events)
2025-11-02 16:05:47,546 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-02 16:05:47,546 - run - INFO - 
2025-11-02 16:05:47,546 - run - INFO - ======================================================================
2025-11-02 16:05:47,546 - run - INFO - 
2025-11-02 16:05:47,546 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-02 16:05:47,546 - run - INFO - ======================================================================
2025-11-02 16:05:47,547 - run - ERROR - Fatal error: EOF when reading a line
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 646, in main
    input()
    ~~~~~^^
EOFError: EOF when reading a line
2025-11-03 05:02:02,777 - run - INFO - ======================================================================
2025-11-03 05:02:02,777 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-03 05:02:02,777 - run - INFO - ======================================================================
2025-11-03 05:02:02,777 - run - INFO - 
2025-11-03 05:02:02,778 - run - INFO - ======================================================================
2025-11-03 05:02:02,778 - run - INFO - [1/3] Starting OpenSearch...
2025-11-03 05:02:02,778 - run - INFO - ======================================================================
2025-11-03 05:02:02,790 - run - INFO - [OK] OpenSearch started
2025-11-03 05:02:02,790 - run - INFO -   Waiting 30 seconds for initialization...
2025-11-03 05:02:33,451 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-11-03 05:02:33,452 - run - INFO - 
2025-11-03 05:02:33,452 - run - INFO - ======================================================================
2025-11-03 05:02:33,452 - run - INFO - [2/3] Starting Filebeat...
2025-11-03 05:02:33,452 - run - INFO - ======================================================================
2025-11-03 05:02:33,569 - run - INFO - [OK] Filebeat started
2025-11-03 05:02:33,569 - run - INFO -   Waiting 10 seconds for connection...
2025-11-03 05:02:43,570 - run - INFO - 
2025-11-03 05:02:43,571 - run - INFO - ======================================================================
2025-11-03 05:02:43,571 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-03 05:02:43,571 - run - INFO - ======================================================================
2025-11-03 05:02:43,592 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-03 05:02:43,592 - run - INFO -   URL: http://localhost:5601
2025-11-03 05:02:43,593 - run - INFO -   (Wait 30-60 seconds for it to fully start)
2025-11-03 05:02:43,593 - run - INFO - 
2025-11-03 05:02:43,593 - run - INFO - ======================================================================
2025-11-03 05:02:43,593 - run - INFO - [OK] All services started successfully!
2025-11-03 05:02:43,593 - run - INFO - ======================================================================
2025-11-03 05:02:43,593 - run - INFO - 
2025-11-03 05:02:43,595 - run - INFO - 
2025-11-03 05:02:43,595 - run - INFO - ======================================================================
2025-11-03 05:02:43,596 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-03 05:02:43,596 - run - INFO - ======================================================================
2025-11-03 05:03:03,955 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 05:03:03,956 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 05:03:03,973 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 05:03:03,973 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 05:03:03,975 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 05:03:03,975 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 05:03:03,975 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 05:03:03,975 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 05:03:03,976 - detection.threat_detector - INFO - Connected to OpenSearch
2025-11-03 05:03:03,976 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 05:03:03,976 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 05:03:03,976 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 05:03:03,976 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 05:03:03,976 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-11-03 05:03:03,976 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-11-03 05:03:03,976 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 05:03:03,976 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-11-03 05:03:03,977 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 05:03:03,977 - run - INFO - Initialization complete
2025-11-03 05:03:03,977 - run - INFO - [OK] Pipeline initialized
2025-11-03 05:03:03,978 - run - INFO - 
2025-11-03 05:03:03,978 - run - INFO - 
2025-11-03 05:03:03,978 - run - INFO - ======================================================================
2025-11-03 05:03:03,978 - run - INFO - [5/7] Running Attack Simulation...
2025-11-03 05:03:03,978 - run - INFO - ======================================================================
2025-11-03 05:03:03,978 - run - INFO - === Running Attack Simulation ===
2025-11-03 05:03:03,979 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 05:03:03,980 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 05:03:03,980 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 05:03:03,980 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 05:03:03,981 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 05:03:03,981 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 05:03:03,981 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 05:03:03,982 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 05:03:03,982 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 05:03:03,982 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 05:03:03,986 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 05:03:03,993 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_050303_20251103_050303.json
2025-11-03 05:03:03,993 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 05:03:03,994 - run - INFO - [OK] Simulation complete
2025-11-03 05:03:03,994 - run - INFO - 
2025-11-03 05:03:03,994 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-03 05:03:18,994 - run - INFO - 
2025-11-03 05:03:18,995 - run - INFO - ======================================================================
2025-11-03 05:03:18,995 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-03 05:03:18,995 - run - INFO - ======================================================================
2025-11-03 05:03:18,996 - run - INFO - ========================================
2025-11-03 05:03:18,997 - run - INFO - Running Full SIEM Pipeline
2025-11-03 05:03:18,997 - run - INFO - ========================================
2025-11-03 05:03:18,997 - run - INFO - === Running Threat Detection ===
2025-11-03 05:03:19,078 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.080s]
2025-11-03 05:03:19,078 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-03 05:03:19,078 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-03 05:03:19,078 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-03 05:03:19,079 - run - INFO - [OK] Pipeline complete
2025-11-03 05:03:19,079 - run - INFO - 
2025-11-03 05:03:19,079 - run - INFO - 
2025-11-03 05:03:19,079 - run - INFO - ======================================================================
2025-11-03 05:03:19,079 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-03 05:03:19,079 - run - INFO - ======================================================================
2025-11-03 05:03:19,202 - run - INFO - [OK] Dashboard starting...
2025-11-03 05:03:19,202 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-03 05:03:24,203 - run - INFO - 
2025-11-03 05:03:24,204 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-03 05:03:24,205 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-03 05:03:28,283 - run - INFO - Waiting... (1/12)
2025-11-03 05:03:42,366 - run - INFO - Waiting... (2/12)
2025-11-03 05:03:56,477 - run - INFO - Waiting... (3/12)
2025-11-03 05:04:10,564 - run - INFO - Waiting... (4/12)
2025-11-03 05:04:24,659 - run - INFO - Waiting... (5/12)
2025-11-03 05:04:38,734 - run - INFO - Waiting... (6/12)
2025-11-03 05:04:52,841 - run - INFO - Waiting... (7/12)
2025-11-03 05:05:06,924 - run - INFO - Waiting... (8/12)
2025-11-03 05:05:21,001 - run - INFO - Waiting... (9/12)
2025-11-03 05:05:35,099 - run - INFO - Waiting... (10/12)
2025-11-03 05:05:49,217 - run - INFO - Waiting... (11/12)
2025-11-03 05:06:03,293 - run - WARNING - [!] OpenSearch Dashboards may still be starting - will try to open anyway
2025-11-03 05:06:03,293 - run - INFO - 
2025-11-03 05:06:03,293 - run - INFO - ======================================================================
2025-11-03 05:06:03,293 - run - INFO - Opening all dashboards in browser...
2025-11-03 05:06:03,293 - run - INFO - ======================================================================
2025-11-03 05:06:03,293 - run - INFO - Opening ThreatOps Dashboard...
2025-11-03 05:06:03,414 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-03 05:06:04,415 - run - INFO - Opening OpenSearch Dashboards...
2025-11-03 05:06:04,440 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (no login required)
2025-11-03 05:06:05,441 - run - INFO - Opening OpenSearch API...
2025-11-03 05:06:05,481 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-03 05:06:06,482 - run - INFO - 
2025-11-03 05:06:06,483 - run - INFO - [OK] All dashboards opened!
2025-11-03 05:06:06,483 - run - INFO - ======================================================================
2025-11-03 05:06:06,484 - run - INFO - 
2025-11-03 05:06:06,484 - run - INFO - 
2025-11-03 05:06:06,484 - run - INFO - ======================================================================
2025-11-03 05:06:06,485 - run - INFO - COMPLETE! All systems operational!
2025-11-03 05:06:06,485 - run - INFO - ======================================================================
2025-11-03 05:06:06,485 - run - INFO - 
2025-11-03 05:06:06,486 - run - INFO - Services running:
2025-11-03 05:06:06,486 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-03 05:06:06,487 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (no login required)
2025-11-03 05:06:06,487 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-03 05:06:06,487 - run - INFO - 
2025-11-03 05:06:06,487 - run - INFO - Log Sources Active:
2025-11-03 05:06:06,487 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-03 05:06:06,488 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-03 05:06:06,488 - run - INFO -    [*] Windows System logs (real system events)
2025-11-03 05:06:06,488 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-03 05:06:06,488 - run - INFO - 
2025-11-03 05:06:06,488 - run - INFO - ======================================================================
2025-11-03 05:06:06,488 - run - INFO - 
2025-11-03 05:06:06,488 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-03 05:06:06,489 - run - INFO - ======================================================================
2025-11-03 05:06:06,489 - run - ERROR - Fatal error: EOF when reading a line
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 646, in main
    input()
    ~~~~~^^
EOFError: EOF when reading a line
2025-11-03 05:24:09,021 - run - INFO - ======================================================================
2025-11-03 05:24:09,021 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-03 05:24:09,022 - run - INFO - ======================================================================
2025-11-03 05:24:09,022 - run - INFO - 
2025-11-03 05:24:09,022 - run - INFO - ======================================================================
2025-11-03 05:24:09,022 - run - INFO - [1/3] Starting OpenSearch...
2025-11-03 05:24:09,022 - run - INFO - ======================================================================
2025-11-03 05:24:09,032 - run - INFO - [OK] OpenSearch started
2025-11-03 05:24:09,032 - run - INFO -   Waiting 30 seconds for initialization...
2025-11-03 05:24:39,644 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-11-03 05:24:39,644 - run - INFO - 
2025-11-03 05:24:39,645 - run - INFO - ======================================================================
2025-11-03 05:24:39,645 - run - INFO - [2/3] Starting Filebeat...
2025-11-03 05:24:39,645 - run - INFO - ======================================================================
2025-11-03 05:24:39,719 - run - INFO - [OK] Filebeat started
2025-11-03 05:24:39,719 - run - INFO -   Waiting 10 seconds for connection...
2025-11-03 05:24:49,720 - run - INFO - 
2025-11-03 05:24:49,722 - run - INFO - ======================================================================
2025-11-03 05:24:49,723 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-03 05:24:49,723 - run - INFO - ======================================================================
2025-11-03 05:24:49,736 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-03 05:24:49,736 - run - INFO -   URL: http://localhost:5601
2025-11-03 05:24:49,736 - run - INFO -   (Wait 90-120 seconds for it to fully start)
2025-11-03 05:24:49,736 - run - INFO - 
2025-11-03 05:24:49,736 - run - INFO - ======================================================================
2025-11-03 05:24:49,736 - run - INFO - [OK] All services started successfully!
2025-11-03 05:24:49,736 - run - INFO - ======================================================================
2025-11-03 05:24:49,736 - run - INFO - 
2025-11-03 05:24:49,741 - run - INFO - 
2025-11-03 05:24:49,741 - run - INFO - ======================================================================
2025-11-03 05:24:49,742 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-03 05:24:49,742 - run - INFO - ======================================================================
2025-11-03 05:25:08,087 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 05:25:08,087 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 05:25:08,103 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 05:25:08,103 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 05:25:08,104 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 05:25:08,104 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 05:25:08,105 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 05:25:08,105 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 05:25:08,106 - detection.threat_detector - INFO - Connected to OpenSearch
2025-11-03 05:25:08,106 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 05:25:08,106 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 05:25:08,106 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 05:25:08,107 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 05:25:08,107 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-11-03 05:25:08,107 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-11-03 05:25:08,107 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 05:25:08,108 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-11-03 05:25:08,108 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 05:25:08,108 - run - INFO - Initialization complete
2025-11-03 05:25:08,109 - run - INFO - [OK] Pipeline initialized
2025-11-03 05:25:08,109 - run - INFO - 
2025-11-03 05:25:08,109 - run - INFO - 
2025-11-03 05:25:08,110 - run - INFO - ======================================================================
2025-11-03 05:25:08,110 - run - INFO - [5/7] Running Attack Simulation...
2025-11-03 05:25:08,110 - run - INFO - ======================================================================
2025-11-03 05:25:08,112 - run - INFO - === Running Attack Simulation ===
2025-11-03 05:25:08,114 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 05:25:08,115 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 05:25:08,116 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 05:25:08,117 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 05:25:08,117 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 05:25:08,118 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 05:25:08,118 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 05:25:08,119 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 05:25:08,119 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 05:25:08,119 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 05:25:08,123 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 05:25:08,134 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_052508_20251103_052508.json
2025-11-03 05:25:08,134 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 05:25:08,135 - run - INFO - [OK] Simulation complete
2025-11-03 05:25:08,135 - run - INFO - 
2025-11-03 05:25:08,135 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-03 05:25:23,136 - run - INFO - 
2025-11-03 05:25:23,136 - run - INFO - ======================================================================
2025-11-03 05:25:23,136 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-03 05:25:23,136 - run - INFO - ======================================================================
2025-11-03 05:25:23,138 - run - INFO - ========================================
2025-11-03 05:25:23,138 - run - INFO - Running Full SIEM Pipeline
2025-11-03 05:25:23,138 - run - INFO - ========================================
2025-11-03 05:25:23,139 - run - INFO - === Running Threat Detection ===
2025-11-03 05:25:23,186 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.046s]
2025-11-03 05:25:23,186 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-03 05:25:23,186 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-03 05:25:23,186 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-03 05:25:23,186 - run - INFO - [OK] Pipeline complete
2025-11-03 05:25:23,187 - run - INFO - 
2025-11-03 05:25:23,187 - run - INFO - 
2025-11-03 05:25:23,187 - run - INFO - ======================================================================
2025-11-03 05:25:23,187 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-03 05:25:23,187 - run - INFO - ======================================================================
2025-11-03 05:25:23,292 - run - INFO - [OK] Dashboard starting...
2025-11-03 05:25:23,292 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-03 05:25:28,292 - run - INFO - 
2025-11-03 05:25:28,293 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-03 05:25:28,293 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-03 05:25:28,321 - run - INFO - [OK] OpenSearch Dashboards is ready! (attempt 1/12)
2025-11-03 05:25:28,321 - run - INFO - 
2025-11-03 05:25:28,321 - run - INFO - ======================================================================
2025-11-03 05:25:28,321 - run - INFO - Opening all dashboards in browser...
2025-11-03 05:25:28,321 - run - INFO - ======================================================================
2025-11-03 05:25:28,322 - run - INFO - Opening ThreatOps Dashboard...
2025-11-03 05:25:28,380 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-03 05:25:29,381 - run - INFO - Opening OpenSearch Dashboards...
2025-11-03 05:25:29,408 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (no login required)
2025-11-03 05:25:30,409 - run - INFO - Opening OpenSearch API...
2025-11-03 05:25:30,436 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-03 05:25:31,437 - run - INFO - 
2025-11-03 05:25:31,437 - run - INFO - [OK] All dashboards opened!
2025-11-03 05:25:31,437 - run - INFO - ======================================================================
2025-11-03 05:25:31,438 - run - INFO - 
2025-11-03 05:25:31,438 - run - INFO - 
2025-11-03 05:25:31,438 - run - INFO - ======================================================================
2025-11-03 05:25:31,438 - run - INFO - COMPLETE! All systems operational!
2025-11-03 05:25:31,438 - run - INFO - ======================================================================
2025-11-03 05:25:31,438 - run - INFO - 
2025-11-03 05:25:31,438 - run - INFO - Services running:
2025-11-03 05:25:31,438 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-03 05:25:31,438 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (no login required)
2025-11-03 05:25:31,439 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-03 05:25:31,439 - run - INFO - 
2025-11-03 05:25:31,439 - run - INFO - Log Sources Active:
2025-11-03 05:25:31,439 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-03 05:25:31,439 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-03 05:25:31,439 - run - INFO -    [*] Windows System logs (real system events)
2025-11-03 05:25:31,439 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-03 05:25:31,439 - run - INFO - 
2025-11-03 05:25:31,439 - run - INFO - ======================================================================
2025-11-03 05:25:31,439 - run - INFO - 
2025-11-03 05:25:31,439 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-03 05:25:31,439 - run - INFO - ======================================================================
2025-11-03 05:25:31,440 - run - ERROR - Fatal error: EOF when reading a line
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 655, in main
    input()
    ~~~~~^^
EOFError: EOF when reading a line
2025-11-03 05:36:17,085 - run - INFO - ======================================================================
2025-11-03 05:36:17,086 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-03 05:36:17,086 - run - INFO - ======================================================================
2025-11-03 05:36:17,086 - run - INFO - 
2025-11-03 05:36:17,086 - run - INFO - ======================================================================
2025-11-03 05:36:17,086 - run - INFO - [1/3] Starting OpenSearch...
2025-11-03 05:36:17,086 - run - INFO - ======================================================================
2025-11-03 05:36:17,101 - run - INFO - [OK] OpenSearch started
2025-11-03 05:36:17,102 - run - INFO -   Waiting 30 seconds for initialization...
2025-11-03 05:36:47,496 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-11-03 05:36:47,497 - run - INFO - 
2025-11-03 05:36:47,497 - run - INFO - ======================================================================
2025-11-03 05:36:47,497 - run - INFO - [2/3] Starting Filebeat...
2025-11-03 05:36:47,497 - run - INFO - ======================================================================
2025-11-03 05:36:47,507 - run - INFO - [OK] Filebeat started
2025-11-03 05:36:47,507 - run - INFO -   Waiting 10 seconds for connection...
2025-11-03 05:36:57,507 - run - INFO - 
2025-11-03 05:36:57,507 - run - INFO - ======================================================================
2025-11-03 05:36:57,507 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-03 05:36:57,508 - run - INFO - ======================================================================
2025-11-03 05:36:57,515 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-03 05:36:57,515 - run - INFO -   URL: http://localhost:5601
2025-11-03 05:36:57,516 - run - INFO -   (Wait 90-120 seconds for it to fully start)
2025-11-03 05:36:57,516 - run - INFO - 
2025-11-03 05:36:57,516 - run - INFO - ======================================================================
2025-11-03 05:36:57,516 - run - INFO - [OK] All services started successfully!
2025-11-03 05:36:57,516 - run - INFO - ======================================================================
2025-11-03 05:36:57,516 - run - INFO - 
2025-11-03 05:36:57,516 - run - INFO - 
2025-11-03 05:36:57,516 - run - INFO - ======================================================================
2025-11-03 05:36:57,517 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-03 05:36:57,517 - run - INFO - ======================================================================
2025-11-03 05:36:59,945 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 05:36:59,946 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 05:36:59,957 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 05:36:59,957 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 05:36:59,958 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 05:36:59,958 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 05:36:59,958 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 05:36:59,958 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 05:36:59,959 - detection.threat_detector - INFO - Connected to OpenSearch
2025-11-03 05:36:59,959 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 05:36:59,959 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 05:36:59,959 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 05:36:59,959 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 05:36:59,960 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-11-03 05:36:59,960 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-11-03 05:36:59,960 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 05:36:59,960 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-11-03 05:36:59,960 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 05:36:59,960 - run - INFO - Initialization complete
2025-11-03 05:36:59,961 - run - INFO - [OK] Pipeline initialized
2025-11-03 05:36:59,961 - run - INFO - 
2025-11-03 05:36:59,961 - run - INFO - 
2025-11-03 05:36:59,961 - run - INFO - ======================================================================
2025-11-03 05:36:59,961 - run - INFO - [5/7] Running Attack Simulation...
2025-11-03 05:36:59,962 - run - INFO - ======================================================================
2025-11-03 05:36:59,962 - run - INFO - === Running Attack Simulation ===
2025-11-03 05:36:59,963 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 05:36:59,963 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 05:36:59,963 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 05:36:59,964 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 05:36:59,964 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 05:36:59,964 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 05:36:59,965 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 05:36:59,965 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 05:36:59,965 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 05:36:59,965 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 05:36:59,968 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 05:36:59,973 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_053659_20251103_053659.json
2025-11-03 05:36:59,973 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 05:36:59,973 - run - INFO - [OK] Simulation complete
2025-11-03 05:36:59,973 - run - INFO - 
2025-11-03 05:36:59,974 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-03 05:37:14,974 - run - INFO - 
2025-11-03 05:37:14,974 - run - INFO - ======================================================================
2025-11-03 05:37:14,974 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-03 05:37:14,974 - run - INFO - ======================================================================
2025-11-03 05:37:14,976 - run - INFO - ========================================
2025-11-03 05:37:14,976 - run - INFO - Running Full SIEM Pipeline
2025-11-03 05:37:14,976 - run - INFO - ========================================
2025-11-03 05:37:14,976 - run - INFO - === Running Threat Detection ===
2025-11-03 05:37:15,015 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.039s]
2025-11-03 05:37:15,015 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-03 05:37:15,015 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-03 05:37:15,016 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-03 05:37:15,016 - run - INFO - [OK] Pipeline complete
2025-11-03 05:37:15,016 - run - INFO - 
2025-11-03 05:37:15,017 - run - INFO - 
2025-11-03 05:37:15,017 - run - INFO - ======================================================================
2025-11-03 05:37:15,017 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-03 05:37:15,017 - run - INFO - ======================================================================
2025-11-03 05:37:15,026 - run - INFO - [OK] Dashboard starting...
2025-11-03 05:37:15,026 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-03 05:37:20,027 - run - INFO - 
2025-11-03 05:37:20,027 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-03 05:37:20,027 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-03 05:37:20,054 - run - INFO - [OK] OpenSearch Dashboards is ready! (attempt 1/12)
2025-11-03 05:37:20,054 - run - INFO - 
2025-11-03 05:37:20,054 - run - INFO - ======================================================================
2025-11-03 05:37:20,054 - run - INFO - Opening all dashboards in browser...
2025-11-03 05:37:20,054 - run - INFO - ======================================================================
2025-11-03 05:37:20,055 - run - INFO - Opening ThreatOps Dashboard...
2025-11-03 05:37:20,114 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-03 05:37:21,114 - run - INFO - Opening OpenSearch Dashboards...
2025-11-03 05:37:21,138 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (no login required)
2025-11-03 05:37:22,139 - run - INFO - Opening OpenSearch API...
2025-11-03 05:37:22,173 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-03 05:37:23,174 - run - INFO - 
2025-11-03 05:37:23,174 - run - INFO - [OK] All dashboards opened!
2025-11-03 05:37:23,174 - run - INFO - ======================================================================
2025-11-03 05:37:23,174 - run - INFO - 
2025-11-03 05:37:23,174 - run - INFO - 
2025-11-03 05:37:23,174 - run - INFO - ======================================================================
2025-11-03 05:37:23,174 - run - INFO - COMPLETE! All systems operational!
2025-11-03 05:37:23,174 - run - INFO - ======================================================================
2025-11-03 05:37:23,174 - run - INFO - 
2025-11-03 05:37:23,174 - run - INFO - Services running:
2025-11-03 05:37:23,175 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-03 05:37:23,175 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (no login required)
2025-11-03 05:37:23,175 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-03 05:37:23,175 - run - INFO - 
2025-11-03 05:37:23,175 - run - INFO - Log Sources Active:
2025-11-03 05:37:23,175 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-03 05:37:23,176 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-03 05:37:23,176 - run - INFO -    [*] Windows System logs (real system events)
2025-11-03 05:37:23,176 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-03 05:37:23,176 - run - INFO - 
2025-11-03 05:37:23,176 - run - INFO - ======================================================================
2025-11-03 05:37:23,176 - run - INFO - 
2025-11-03 05:37:23,176 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-03 05:37:23,176 - run - INFO - ======================================================================
2025-11-03 05:37:23,176 - run - ERROR - Fatal error: EOF when reading a line
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 655, in main
    input()
    ~~~~~^^
EOFError: EOF when reading a line
2025-11-03 05:41:09,416 - run - INFO - ======================================================================
2025-11-03 05:41:09,416 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-03 05:41:09,417 - run - INFO - ======================================================================
2025-11-03 05:41:09,417 - run - INFO - 
2025-11-03 05:41:09,417 - run - INFO - ======================================================================
2025-11-03 05:41:09,418 - run - INFO - [1/3] Starting OpenSearch...
2025-11-03 05:41:09,418 - run - INFO - ======================================================================
2025-11-03 05:41:09,429 - run - INFO - [OK] OpenSearch started
2025-11-03 05:41:09,430 - run - INFO -   Waiting 30 seconds for initialization...
2025-11-03 05:41:39,925 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-11-03 05:41:39,926 - run - INFO - 
2025-11-03 05:41:39,927 - run - INFO - ======================================================================
2025-11-03 05:41:39,927 - run - INFO - [2/3] Starting Filebeat...
2025-11-03 05:41:39,928 - run - INFO - ======================================================================
2025-11-03 05:41:39,943 - run - INFO - [OK] Filebeat started
2025-11-03 05:41:39,943 - run - INFO -   Waiting 10 seconds for connection...
2025-11-03 05:41:49,944 - run - INFO - 
2025-11-03 05:41:49,945 - run - INFO - ======================================================================
2025-11-03 05:41:49,945 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-03 05:41:49,945 - run - INFO - ======================================================================
2025-11-03 05:41:49,955 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-03 05:41:49,955 - run - INFO -   URL: http://localhost:5601
2025-11-03 05:41:49,956 - run - INFO -   (Wait 90-120 seconds for it to fully start)
2025-11-03 05:41:49,956 - run - INFO - 
2025-11-03 05:41:49,956 - run - INFO - ======================================================================
2025-11-03 05:41:49,956 - run - INFO - [OK] All services started successfully!
2025-11-03 05:41:49,957 - run - INFO - ======================================================================
2025-11-03 05:41:49,957 - run - INFO - 
2025-11-03 05:41:49,957 - run - INFO - 
2025-11-03 05:41:49,957 - run - INFO - ======================================================================
2025-11-03 05:41:49,957 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-03 05:41:49,957 - run - INFO - ======================================================================
2025-11-03 05:41:59,936 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 05:41:59,937 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 05:41:59,943 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 05:41:59,944 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 05:41:59,944 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 05:41:59,945 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 05:41:59,945 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 05:41:59,945 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 05:41:59,946 - detection.threat_detector - INFO - Connected to OpenSearch
2025-11-03 05:41:59,946 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 05:41:59,946 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 05:41:59,947 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 05:41:59,947 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 05:41:59,947 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-11-03 05:41:59,948 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-11-03 05:41:59,948 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 05:41:59,948 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-11-03 05:41:59,949 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 05:41:59,949 - run - INFO - Initialization complete
2025-11-03 05:41:59,950 - run - INFO - [OK] Pipeline initialized
2025-11-03 05:41:59,951 - run - INFO - 
2025-11-03 05:41:59,951 - run - INFO - 
2025-11-03 05:41:59,951 - run - INFO - ======================================================================
2025-11-03 05:41:59,951 - run - INFO - [5/7] Running Attack Simulation...
2025-11-03 05:41:59,952 - run - INFO - ======================================================================
2025-11-03 05:41:59,953 - run - INFO - === Running Attack Simulation ===
2025-11-03 05:41:59,954 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 05:41:59,955 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 05:41:59,955 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 05:41:59,956 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 05:41:59,956 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 05:41:59,956 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 05:41:59,957 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 05:41:59,957 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 05:41:59,958 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 05:41:59,958 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 05:41:59,961 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 05:41:59,964 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_054159_20251103_054159.json
2025-11-03 05:41:59,965 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 05:41:59,966 - run - INFO - [OK] Simulation complete
2025-11-03 05:41:59,966 - run - INFO - 
2025-11-03 05:41:59,966 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-03 05:42:14,967 - run - INFO - 
2025-11-03 05:42:14,968 - run - INFO - ======================================================================
2025-11-03 05:42:14,969 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-03 05:42:14,969 - run - INFO - ======================================================================
2025-11-03 05:42:14,970 - run - INFO - ========================================
2025-11-03 05:42:14,971 - run - INFO - Running Full SIEM Pipeline
2025-11-03 05:42:14,971 - run - INFO - ========================================
2025-11-03 05:42:14,972 - run - INFO - === Running Threat Detection ===
2025-11-03 05:42:15,007 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.035s]
2025-11-03 05:42:15,008 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-03 05:42:15,008 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-03 05:42:15,009 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-03 05:42:15,010 - run - INFO - [OK] Pipeline complete
2025-11-03 05:42:15,010 - run - INFO - 
2025-11-03 05:42:15,010 - run - INFO - 
2025-11-03 05:42:15,011 - run - INFO - ======================================================================
2025-11-03 05:42:15,011 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-03 05:42:15,011 - run - INFO - ======================================================================
2025-11-03 05:42:15,021 - run - INFO - [OK] Dashboard starting...
2025-11-03 05:42:15,022 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-03 05:42:20,023 - run - INFO - 
2025-11-03 05:42:20,023 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-03 05:42:20,024 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-03 05:42:20,044 - run - INFO - [OK] OpenSearch Dashboards is ready! (attempt 1/12)
2025-11-03 05:42:20,044 - run - INFO - 
2025-11-03 05:42:20,045 - run - INFO - ======================================================================
2025-11-03 05:42:20,045 - run - INFO - Opening all dashboards in browser...
2025-11-03 05:42:20,045 - run - INFO - ======================================================================
2025-11-03 05:42:20,045 - run - INFO - Opening ThreatOps Dashboard...
2025-11-03 05:42:20,118 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-03 05:42:21,118 - run - INFO - Opening OpenSearch Dashboards...
2025-11-03 05:42:21,139 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (no login required)
2025-11-03 05:42:22,140 - run - INFO - Opening OpenSearch API...
2025-11-03 05:42:22,169 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-03 05:42:23,170 - run - INFO - 
2025-11-03 05:42:23,171 - run - INFO - [OK] All dashboards opened!
2025-11-03 05:42:23,171 - run - INFO - ======================================================================
2025-11-03 05:42:23,171 - run - INFO - 
2025-11-03 05:42:23,171 - run - INFO - 
2025-11-03 05:42:23,172 - run - INFO - ======================================================================
2025-11-03 05:42:23,172 - run - INFO - COMPLETE! All systems operational!
2025-11-03 05:42:23,172 - run - INFO - ======================================================================
2025-11-03 05:42:23,172 - run - INFO - 
2025-11-03 05:42:23,172 - run - INFO - Services running:
2025-11-03 05:42:23,172 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-03 05:42:23,173 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (no login required)
2025-11-03 05:42:23,173 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-03 05:42:23,173 - run - INFO - 
2025-11-03 05:42:23,173 - run - INFO - Log Sources Active:
2025-11-03 05:42:23,173 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-03 05:42:23,174 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-03 05:42:23,174 - run - INFO -    [*] Windows System logs (real system events)
2025-11-03 05:42:23,174 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-03 05:42:23,174 - run - INFO - 
2025-11-03 05:42:23,174 - run - INFO - ======================================================================
2025-11-03 05:42:23,175 - run - INFO - 
2025-11-03 05:42:23,175 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-03 05:42:23,175 - run - INFO - ======================================================================
2025-11-03 05:45:37,099 - run - INFO - ======================================================================
2025-11-03 05:45:37,099 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-03 05:45:37,099 - run - INFO - ======================================================================
2025-11-03 05:45:37,099 - run - INFO - 
2025-11-03 05:45:37,099 - run - INFO - ======================================================================
2025-11-03 05:45:37,099 - run - INFO - [1/3] Starting OpenSearch...
2025-11-03 05:45:37,099 - run - INFO - ======================================================================
2025-11-03 05:45:37,109 - run - INFO - [OK] OpenSearch started
2025-11-03 05:45:37,109 - run - INFO -   Waiting 30 seconds for initialization...
2025-11-03 05:46:07,417 - run - INFO - [OK] OpenSearch is responding (status: 200)
2025-11-03 05:46:07,417 - run - INFO - 
2025-11-03 05:46:07,417 - run - INFO - ======================================================================
2025-11-03 05:46:07,417 - run - INFO - [2/3] Starting Filebeat...
2025-11-03 05:46:07,417 - run - INFO - ======================================================================
2025-11-03 05:46:07,424 - run - INFO - [OK] Filebeat started
2025-11-03 05:46:07,424 - run - INFO -   Waiting 10 seconds for connection...
2025-11-03 05:46:17,425 - run - INFO - 
2025-11-03 05:46:17,425 - run - INFO - ======================================================================
2025-11-03 05:46:17,425 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-03 05:46:17,425 - run - INFO - ======================================================================
2025-11-03 05:46:17,432 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-03 05:46:17,433 - run - INFO -   URL: http://localhost:5601
2025-11-03 05:46:17,433 - run - INFO -   (Wait 90-120 seconds for it to fully start)
2025-11-03 05:46:17,433 - run - INFO - 
2025-11-03 05:46:17,433 - run - INFO - ======================================================================
2025-11-03 05:46:17,433 - run - INFO - [OK] All services started successfully!
2025-11-03 05:46:17,433 - run - INFO - ======================================================================
2025-11-03 05:46:17,433 - run - INFO - 
2025-11-03 05:46:17,434 - run - INFO - 
2025-11-03 05:46:17,434 - run - INFO - ======================================================================
2025-11-03 05:46:17,434 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-03 05:46:17,434 - run - INFO - ======================================================================
2025-11-03 05:46:19,208 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 05:46:19,208 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 05:46:19,225 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 05:46:19,225 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 05:46:19,226 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 05:46:19,226 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 05:46:19,227 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 05:46:19,227 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 05:46:19,227 - detection.threat_detector - INFO - Connected to OpenSearch
2025-11-03 05:46:19,227 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 05:46:19,228 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 05:46:19,228 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 05:46:19,228 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 05:46:19,228 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-11-03 05:46:19,228 - enrichment.intel_enricher - INFO - Initialized 0 threat intelligence APIs
2025-11-03 05:46:19,228 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 05:46:19,228 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-11-03 05:46:19,228 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 05:46:19,228 - run - INFO - Initialization complete
2025-11-03 05:46:19,229 - run - INFO - [OK] Pipeline initialized
2025-11-03 05:46:19,229 - run - INFO - 
2025-11-03 05:46:19,229 - run - INFO - 
2025-11-03 05:46:19,229 - run - INFO - ======================================================================
2025-11-03 05:46:19,229 - run - INFO - [5/7] Running Attack Simulation...
2025-11-03 05:46:19,229 - run - INFO - ======================================================================
2025-11-03 05:46:19,229 - run - INFO - === Running Attack Simulation ===
2025-11-03 05:46:19,230 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 05:46:19,230 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 05:46:19,230 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 05:46:19,231 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 05:46:19,231 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 05:46:19,231 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 05:46:19,231 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 05:46:19,232 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 05:46:19,232 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 05:46:19,232 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 05:46:19,234 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 05:46:19,240 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_054619_20251103_054619.json
2025-11-03 05:46:19,240 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 05:46:19,241 - run - INFO - [OK] Simulation complete
2025-11-03 05:46:19,241 - run - INFO - 
2025-11-03 05:46:19,241 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-03 05:46:34,242 - run - INFO - 
2025-11-03 05:46:34,242 - run - INFO - ======================================================================
2025-11-03 05:46:34,242 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-03 05:46:34,243 - run - INFO - ======================================================================
2025-11-03 05:46:34,244 - run - INFO - ========================================
2025-11-03 05:46:34,245 - run - INFO - Running Full SIEM Pipeline
2025-11-03 05:46:34,245 - run - INFO - ========================================
2025-11-03 05:46:34,245 - run - INFO - === Running Threat Detection ===
2025-11-03 05:46:34,289 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.044s]
2025-11-03 05:46:34,289 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-03 05:46:34,290 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-03 05:46:34,290 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-03 05:46:34,291 - run - INFO - [OK] Pipeline complete
2025-11-03 05:46:34,291 - run - INFO - 
2025-11-03 05:46:34,291 - run - INFO - 
2025-11-03 05:46:34,291 - run - INFO - ======================================================================
2025-11-03 05:46:34,291 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-03 05:46:34,291 - run - INFO - ======================================================================
2025-11-03 05:46:34,307 - run - INFO - [OK] Dashboard starting...
2025-11-03 05:46:34,307 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-03 05:46:39,308 - run - INFO - 
2025-11-03 05:46:39,309 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-03 05:46:39,310 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-03 05:46:39,324 - run - INFO - [OK] OpenSearch Dashboards is ready! (attempt 1/12)
2025-11-03 05:46:39,324 - run - INFO - 
2025-11-03 05:46:39,324 - run - INFO - ======================================================================
2025-11-03 05:46:39,324 - run - INFO - Opening all dashboards in browser...
2025-11-03 05:46:39,324 - run - INFO - ======================================================================
2025-11-03 05:46:39,324 - run - INFO - Opening ThreatOps Dashboard...
2025-11-03 05:46:39,424 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-03 05:46:40,424 - run - INFO - Opening OpenSearch Dashboards...
2025-11-03 05:46:40,447 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (no login required)
2025-11-03 05:46:41,447 - run - INFO - Opening OpenSearch API...
2025-11-03 05:46:41,477 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-03 05:46:42,478 - run - INFO - 
2025-11-03 05:46:42,478 - run - INFO - [OK] All dashboards opened!
2025-11-03 05:46:42,478 - run - INFO - ======================================================================
2025-11-03 05:46:42,479 - run - INFO - 
2025-11-03 05:46:42,479 - run - INFO - 
2025-11-03 05:46:42,479 - run - INFO - ======================================================================
2025-11-03 05:46:42,479 - run - INFO - COMPLETE! All systems operational!
2025-11-03 05:46:42,479 - run - INFO - ======================================================================
2025-11-03 05:46:42,479 - run - INFO - 
2025-11-03 05:46:42,479 - run - INFO - Services running:
2025-11-03 05:46:42,479 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-03 05:46:42,479 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (no login required)
2025-11-03 05:46:42,479 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-03 05:46:42,479 - run - INFO - 
2025-11-03 05:46:42,479 - run - INFO - Log Sources Active:
2025-11-03 05:46:42,479 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-03 05:46:42,479 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-03 05:46:42,479 - run - INFO -    [*] Windows System logs (real system events)
2025-11-03 05:46:42,479 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-03 05:46:42,480 - run - INFO - 
2025-11-03 05:46:42,480 - run - INFO - ======================================================================
2025-11-03 05:46:42,480 - run - INFO - 
2025-11-03 05:46:42,480 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-03 05:46:42,480 - run - INFO - ======================================================================
2025-11-03 05:46:42,480 - run - ERROR - Fatal error: EOF when reading a line
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\run.py", line 655, in main
    input()
    ~~~~~^^
EOFError: EOF when reading a line
2025-11-03 05:52:59,590 - run - INFO - 
2025-11-03 05:52:59,590 - run - INFO - ======================================================================
2025-11-03 05:52:59,591 - run - INFO - Cleaning up all background processes...
2025-11-03 05:52:59,591 - run - INFO - ======================================================================
2025-11-03 05:52:59,592 - run - INFO -   [OK] Killed process PID 19844
2025-11-03 05:52:59,596 - run - INFO -   [OK] Killed python.exe (PID 2184)
2025-11-03 17:35:47,923 - run - INFO - ======================================================================
2025-11-03 17:35:47,928 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-03 17:35:47,930 - run - INFO - ======================================================================
2025-11-03 17:35:47,931 - run - INFO - 
2025-11-03 17:35:47,932 - run - INFO - ======================================================================
2025-11-03 17:35:47,932 - run - INFO - [1/3] Starting OpenSearch...
2025-11-03 17:35:47,932 - run - INFO - ======================================================================
2025-11-03 17:35:48,023 - run - INFO - [OK] OpenSearch started
2025-11-03 17:35:48,024 - run - INFO -   Waiting 30 seconds for initialization...
2025-11-03 17:36:22,720 - run - WARNING - OpenSearch may still be starting: HTTPConnectionPool(host='localhost', port=9200): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001C578E8E900>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-11-03 17:36:22,720 - run - INFO - 
2025-11-03 17:36:22,721 - run - INFO - ======================================================================
2025-11-03 17:36:22,721 - run - INFO - [2/3] Starting Filebeat...
2025-11-03 17:36:22,721 - run - INFO - ======================================================================
2025-11-03 17:36:22,878 - run - INFO - [OK] Filebeat started
2025-11-03 17:36:22,879 - run - INFO -   Waiting 10 seconds for connection...
2025-11-03 17:36:32,880 - run - INFO - 
2025-11-03 17:36:32,887 - run - INFO - ======================================================================
2025-11-03 17:36:32,887 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-03 17:36:32,888 - run - INFO - ======================================================================
2025-11-03 17:36:34,703 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-03 17:36:34,703 - run - INFO -   URL: http://localhost:5601
2025-11-03 17:36:34,704 - run - INFO -   (Wait 90-120 seconds for it to fully start)
2025-11-03 17:36:34,704 - run - INFO - 
2025-11-03 17:36:34,704 - run - INFO - ======================================================================
2025-11-03 17:36:34,704 - run - INFO - [OK] All services started successfully!
2025-11-03 17:36:34,705 - run - INFO - ======================================================================
2025-11-03 17:36:34,705 - run - INFO - 
2025-11-03 17:36:34,706 - run - INFO - 
2025-11-03 17:36:34,706 - run - INFO - ======================================================================
2025-11-03 17:36:34,706 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-03 17:36:34,707 - run - INFO - ======================================================================
2025-11-03 17:37:01,328 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 17:37:01,329 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 17:37:01,344 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 17:37:01,346 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 17:37:01,350 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 17:37:01,350 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 17:37:01,351 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 17:37:01,351 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 17:37:01,352 - detection.threat_detector - INFO - Connected to OpenSearch
2025-11-03 17:37:01,353 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 17:37:01,353 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 17:37:01,353 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 17:37:01,354 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 17:37:01,354 - enrichment.intel_enricher - INFO - Connected to OpenSearch
2025-11-03 17:37:01,355 - enrichment.intel_enricher - INFO - Initialized 3 threat intelligence APIs
2025-11-03 17:37:01,355 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 17:37:01,355 - scoring.risk_scorer - INFO - Connected to OpenSearch
2025-11-03 17:37:01,356 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 17:37:01,356 - run - INFO - Initialization complete
2025-11-03 17:37:01,358 - run - INFO - [OK] Pipeline initialized
2025-11-03 17:37:01,358 - run - INFO - 
2025-11-03 17:37:01,358 - run - INFO - 
2025-11-03 17:37:01,359 - run - INFO - ======================================================================
2025-11-03 17:37:01,360 - run - INFO - [5/7] Running Attack Simulation...
2025-11-03 17:37:01,361 - run - INFO - ======================================================================
2025-11-03 17:37:01,363 - run - INFO - === Running Attack Simulation ===
2025-11-03 17:37:01,364 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 17:37:01,364 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 17:37:01,365 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 17:37:01,366 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 17:37:01,367 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 17:37:01,368 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 17:37:01,368 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 17:37:01,369 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 17:37:01,370 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 17:37:01,370 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 17:37:01,377 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 17:37:01,386 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_173701_20251103_173701.json
2025-11-03 17:37:01,386 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 17:37:01,387 - run - INFO - [OK] Simulation complete
2025-11-03 17:37:01,388 - run - INFO - 
2025-11-03 17:37:01,388 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-03 17:37:16,389 - run - INFO - 
2025-11-03 17:37:16,389 - run - INFO - ======================================================================
2025-11-03 17:37:16,390 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-03 17:37:16,390 - run - INFO - ======================================================================
2025-11-03 17:37:16,391 - run - INFO - ========================================
2025-11-03 17:37:16,392 - run - INFO - Running Full SIEM Pipeline
2025-11-03 17:37:16,392 - run - INFO - ========================================
2025-11-03 17:37:16,392 - run - INFO - === Running Threat Detection ===
2025-11-03 17:37:20,497 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.104s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001C554A21D10>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:37:24,744 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.046s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001C554A21E50>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:37:28,828 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.078s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001C554907820>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:37:32,921 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.085s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001C554907950>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:37:32,927 - detection.threat_detector - ERROR - Error querying OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x000001C554907950>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x000001C554907950>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 17:37:32,927 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-03 17:37:32,928 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-03 17:37:32,929 - run - INFO - [OK] Pipeline complete
2025-11-03 17:37:32,929 - run - INFO - 
2025-11-03 17:37:32,930 - run - INFO - 
2025-11-03 17:37:32,930 - run - INFO - ======================================================================
2025-11-03 17:37:32,930 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-03 17:37:32,930 - run - INFO - ======================================================================
2025-11-03 17:37:32,941 - run - INFO - [OK] Dashboard starting...
2025-11-03 17:37:32,942 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-03 17:37:37,943 - run - INFO - 
2025-11-03 17:37:37,944 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-03 17:37:37,944 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-03 17:37:42,026 - run - INFO - Waiting... (1/12)
2025-11-03 17:37:56,128 - run - INFO - Waiting... (2/12)
2025-11-03 17:38:10,196 - run - INFO - Waiting... (3/12)
2025-11-03 17:38:24,259 - run - INFO - Waiting... (4/12)
2025-11-03 17:38:38,327 - run - INFO - Waiting... (5/12)
2025-11-03 17:38:52,402 - run - INFO - Waiting... (6/12)
2025-11-03 17:39:06,514 - run - INFO - Waiting... (7/12)
2025-11-03 17:39:20,594 - run - INFO - Waiting... (8/12)
2025-11-03 17:39:34,663 - run - INFO - Waiting... (9/12)
2025-11-03 17:39:48,694 - run - INFO - Waiting... (10/12)
2025-11-03 17:40:02,793 - run - INFO - Waiting... (11/12)
2025-11-03 17:40:16,859 - run - WARNING - [!] OpenSearch Dashboards may still be starting - will try to open anyway
2025-11-03 17:40:16,860 - run - INFO - 
2025-11-03 17:40:16,860 - run - INFO - ======================================================================
2025-11-03 17:40:16,861 - run - INFO - Opening all dashboards in browser...
2025-11-03 17:40:16,861 - run - INFO - ======================================================================
2025-11-03 17:40:16,862 - run - INFO - Opening ThreatOps Dashboard...
2025-11-03 17:40:17,071 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-03 17:40:18,072 - run - INFO - Opening OpenSearch Dashboards...
2025-11-03 17:40:18,170 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (no login required)
2025-11-03 17:40:19,173 - run - INFO - Opening OpenSearch API...
2025-11-03 17:40:19,252 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-03 17:40:20,254 - run - INFO - 
2025-11-03 17:40:20,255 - run - INFO - [OK] All dashboards opened!
2025-11-03 17:40:20,256 - run - INFO - ======================================================================
2025-11-03 17:40:20,256 - run - INFO - 
2025-11-03 17:40:20,257 - run - INFO - 
2025-11-03 17:40:20,258 - run - INFO - ======================================================================
2025-11-03 17:40:20,258 - run - INFO - COMPLETE! All systems operational!
2025-11-03 17:40:20,259 - run - INFO - ======================================================================
2025-11-03 17:40:20,259 - run - INFO - 
2025-11-03 17:40:20,260 - run - INFO - Services running:
2025-11-03 17:40:20,260 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-03 17:40:20,261 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (no login required)
2025-11-03 17:40:20,262 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-03 17:40:20,262 - run - INFO - 
2025-11-03 17:40:20,263 - run - INFO - Log Sources Active:
2025-11-03 17:40:20,264 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-03 17:40:20,264 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-03 17:40:20,265 - run - INFO -    [*] Windows System logs (real system events)
2025-11-03 17:40:20,265 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-03 17:40:20,265 - run - INFO - 
2025-11-03 17:40:20,266 - run - INFO - ======================================================================
2025-11-03 17:40:20,266 - run - INFO - 
2025-11-03 17:40:20,267 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-03 17:40:20,268 - run - INFO - ======================================================================
2025-11-03 17:40:43,954 - run - INFO - 
2025-11-03 17:40:43,955 - run - INFO - ======================================================================
2025-11-03 17:40:43,956 - run - INFO - Cleaning up all background processes...
2025-11-03 17:40:43,956 - run - INFO - ======================================================================
2025-11-03 17:40:43,958 - run - INFO -   [OK] Killed process PID 4676
2025-11-03 17:40:43,959 - run - INFO -   [OK] Killed process PID 1648
2025-11-03 17:40:43,959 - run - INFO -   [OK] Killed process PID 20508
2025-11-03 17:40:43,963 - run - INFO -   [OK] Killed node.exe (PID 1648)
2025-11-03 17:40:43,978 - run - INFO -   [OK] Killed python.exe (PID 5400)
2025-11-03 17:55:01,681 - run - INFO - ============================================================
2025-11-03 17:55:01,682 - run - INFO - ThreatOps SIEM Pipeline
2025-11-03 17:55:01,682 - run - INFO - ============================================================
2025-11-03 17:55:01,682 - run - INFO - Checking OpenSearch connection...
2025-11-03 17:55:05,968 - run - ERROR - [X] OpenSearch is not responding after all retry attempts
2025-11-03 17:55:05,969 - run - ERROR - [X] OpenSearch is not running!
2025-11-03 17:55:05,969 - run - ERROR - Please start OpenSearch first or use: python run.py --mode all
2025-11-03 17:55:23,411 - run - INFO - ============================================================
2025-11-03 17:55:23,411 - run - INFO - ThreatOps SIEM Pipeline
2025-11-03 17:55:23,411 - run - INFO - ============================================================
2025-11-03 17:55:27,632 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 17:55:27,632 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 17:55:27,685 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 17:55:27,685 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 17:55:27,686 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 17:55:27,686 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 17:55:27,687 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 17:55:27,687 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 17:55:31,773 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.086s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07E99940>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:55:35,840 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.054s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07D9FD90>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:55:39,907 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.060s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07D9FED0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:55:43,971 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.054s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07DEE9E0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:55:43,979 - detection.threat_detector - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x0000028F07DEE9E0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x0000028F07DEE9E0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 17:55:43,979 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 17:55:43,979 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 17:55:43,979 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 17:55:43,979 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 17:55:48,033 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.053s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07DEEC40>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:55:52,092 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.048s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07E09EB0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:55:56,157 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.059s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07E649E0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:56:00,260 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.097s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07E648D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:56:00,268 - enrichment.intel_enricher - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x0000028F07E648D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x0000028F07E648D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 17:56:00,268 - enrichment.intel_enricher - INFO - Initialized 3 threat intelligence APIs
2025-11-03 17:56:00,268 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 17:56:04,341 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.072s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07E65590>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:56:08,424 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.076s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07E65480>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:56:12,486 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.054s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07E656A0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:56:16,558 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.064s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000028F07E658C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 17:56:16,565 - scoring.risk_scorer - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x0000028F07E658C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x0000028F07E658C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 17:56:16,566 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 17:56:16,566 - run - INFO - Initialization complete
2025-11-03 17:56:16,567 - run - INFO - Mode: Attack Simulation
2025-11-03 17:56:16,569 - run - INFO - === Running Attack Simulation ===
2025-11-03 17:56:16,570 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 17:56:16,571 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 17:56:16,572 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 17:56:16,575 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 17:56:16,575 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 17:56:16,576 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 17:56:16,577 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 17:56:16,577 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 17:56:16,577 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 17:56:16,577 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 17:56:16,586 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 17:56:16,595 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_175616_20251103_175616.json
2025-11-03 17:56:16,595 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 17:56:16,596 - run - INFO - ============================================================
2025-11-03 17:56:16,596 - run - INFO - Run completed successfully
2025-11-03 17:56:16,596 - run - INFO - ============================================================
2025-11-03 17:56:59,721 - run - INFO - ======================================================================
2025-11-03 17:56:59,722 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-03 17:56:59,722 - run - INFO - ======================================================================
2025-11-03 17:56:59,723 - run - INFO - 
2025-11-03 17:56:59,723 - run - INFO - ======================================================================
2025-11-03 17:56:59,724 - run - INFO - [1/3] Starting OpenSearch...
2025-11-03 17:56:59,724 - run - INFO - ======================================================================
2025-11-03 17:56:59,748 - run - INFO - [OK] OpenSearch started
2025-11-03 17:56:59,753 - run - INFO -   Waiting for OpenSearch to become ready...
2025-11-03 17:57:04,052 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 1/12)
2025-11-03 17:57:18,075 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 2/12)
2025-11-03 17:57:32,131 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 3/12)
2025-11-03 17:57:46,010 - run - INFO - [OK] OpenSearch is healthy and ready
2025-11-03 17:57:46,011 - run - INFO - [OK] OpenSearch is ready and healthy
2025-11-03 17:57:46,012 - run - INFO - 
2025-11-03 17:57:46,013 - run - INFO - ======================================================================
2025-11-03 17:57:46,013 - run - INFO - [2/3] Starting Filebeat...
2025-11-03 17:57:46,014 - run - INFO - ======================================================================
2025-11-03 17:57:46,024 - run - INFO - [OK] Filebeat started
2025-11-03 17:57:46,024 - run - INFO -   Waiting 10 seconds for connection...
2025-11-03 17:57:56,027 - run - INFO - 
2025-11-03 17:57:56,027 - run - INFO - ======================================================================
2025-11-03 17:57:56,028 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-03 17:57:56,031 - run - INFO - ======================================================================
2025-11-03 17:57:56,043 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-03 17:57:56,044 - run - INFO -   URL: http://localhost:5601
2025-11-03 17:57:56,044 - run - INFO -   (Wait 90-120 seconds for it to fully start)
2025-11-03 17:57:56,044 - run - INFO - 
2025-11-03 17:57:56,045 - run - INFO - ======================================================================
2025-11-03 17:57:56,045 - run - INFO - [OK] All services started successfully!
2025-11-03 17:57:56,045 - run - INFO - ======================================================================
2025-11-03 17:57:56,046 - run - INFO - 
2025-11-03 17:57:56,047 - run - INFO - 
2025-11-03 17:57:56,047 - run - INFO - ======================================================================
2025-11-03 17:57:56,048 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-03 17:57:56,048 - run - INFO - ======================================================================
2025-11-03 17:58:00,762 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 17:58:00,763 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 17:58:00,811 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 17:58:00,812 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 17:58:00,813 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 17:58:00,814 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 17:58:00,815 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 17:58:00,815 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 17:58:00,849 - opensearch - INFO - GET http://localhost:9200/ [status:200 request:0.033s]
2025-11-03 17:58:00,850 - detection.threat_detector - INFO - Connected to OpenSearch and verified
2025-11-03 17:58:00,850 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 17:58:00,851 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 17:58:00,851 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 17:58:00,851 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 17:58:00,871 - opensearch - INFO - GET http://localhost:9200/ [status:200 request:0.019s]
2025-11-03 17:58:00,872 - enrichment.intel_enricher - INFO - Connected to OpenSearch and verified
2025-11-03 17:58:00,873 - enrichment.intel_enricher - INFO - Initialized 3 threat intelligence APIs
2025-11-03 17:58:00,874 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 17:58:00,899 - opensearch - INFO - GET http://localhost:9200/ [status:200 request:0.024s]
2025-11-03 17:58:00,899 - scoring.risk_scorer - INFO - Connected to OpenSearch and verified
2025-11-03 17:58:00,900 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 17:58:00,901 - run - INFO - Initialization complete
2025-11-03 17:58:00,902 - run - INFO - [OK] Pipeline initialized
2025-11-03 17:58:00,902 - run - INFO - 
2025-11-03 17:58:00,902 - run - INFO - 
2025-11-03 17:58:00,902 - run - INFO - ======================================================================
2025-11-03 17:58:00,902 - run - INFO - [5/7] Running Attack Simulation...
2025-11-03 17:58:00,903 - run - INFO - ======================================================================
2025-11-03 17:58:00,904 - run - INFO - === Running Attack Simulation ===
2025-11-03 17:58:00,906 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 17:58:00,906 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 17:58:00,907 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 17:58:00,908 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 17:58:00,909 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 17:58:00,910 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 17:58:00,911 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 17:58:00,912 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 17:58:00,913 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 17:58:00,913 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 17:58:00,921 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 17:58:00,929 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_175800_20251103_175800.json
2025-11-03 17:58:00,929 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 17:58:00,930 - run - INFO - [OK] Simulation complete
2025-11-03 17:58:00,931 - run - INFO - 
2025-11-03 17:58:00,931 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-03 17:58:15,932 - run - INFO - 
2025-11-03 17:58:15,934 - run - INFO - ======================================================================
2025-11-03 17:58:15,935 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-03 17:58:15,936 - run - INFO - ======================================================================
2025-11-03 17:58:15,939 - run - INFO - ========================================
2025-11-03 17:58:15,940 - run - INFO - Running Full SIEM Pipeline
2025-11-03 17:58:15,941 - run - INFO - ========================================
2025-11-03 17:58:15,942 - run - INFO - === Running Threat Detection ===
2025-11-03 17:58:16,194 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.251s]
2025-11-03 17:58:16,197 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-03 17:58:16,198 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-03 17:58:16,201 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-03 17:58:16,204 - run - INFO - [OK] Pipeline complete
2025-11-03 17:58:16,207 - run - INFO - 
2025-11-03 17:58:16,211 - run - INFO - 
2025-11-03 17:58:16,217 - run - INFO - ======================================================================
2025-11-03 17:58:16,226 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-03 17:58:16,233 - run - INFO - ======================================================================
2025-11-03 17:58:16,270 - run - INFO - [OK] Dashboard starting...
2025-11-03 17:58:16,273 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-03 17:58:21,278 - run - INFO - 
2025-11-03 17:58:21,279 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-03 17:58:21,279 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-03 17:58:25,340 - run - INFO - Waiting... (1/12)
2025-11-03 17:58:39,420 - run - INFO - Waiting... (2/12)
2025-11-03 17:58:53,527 - run - INFO - Waiting... (3/12)
2025-11-03 17:59:07,590 - run - INFO - Waiting... (4/12)
2025-11-03 17:59:21,655 - run - INFO - Waiting... (5/12)
2025-11-03 17:59:35,760 - run - INFO - Waiting... (6/12)
2025-11-03 17:59:49,809 - run - INFO - Waiting... (7/12)
2025-11-03 18:00:03,876 - run - INFO - Waiting... (8/12)
2025-11-03 18:00:17,951 - run - INFO - Waiting... (9/12)
2025-11-03 18:00:32,040 - run - INFO - Waiting... (10/12)
2025-11-03 18:00:45,063 - run - INFO - Waiting... (11/12)
2025-11-03 18:00:58,069 - run - WARNING - [!] OpenSearch Dashboards may still be starting - will try to open anyway
2025-11-03 18:00:58,070 - run - INFO - 
2025-11-03 18:00:58,070 - run - INFO - ======================================================================
2025-11-03 18:00:58,071 - run - INFO - Opening all dashboards in browser...
2025-11-03 18:00:58,071 - run - INFO - ======================================================================
2025-11-03 18:00:58,072 - run - INFO - Opening ThreatOps Dashboard...
2025-11-03 18:00:58,282 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-03 18:00:59,285 - run - INFO - Opening OpenSearch Dashboards...
2025-11-03 18:00:59,372 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (no login required)
2025-11-03 18:01:00,374 - run - INFO - Opening OpenSearch API...
2025-11-03 18:01:00,453 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-03 18:01:01,455 - run - INFO - 
2025-11-03 18:01:01,456 - run - INFO - [OK] All dashboards opened!
2025-11-03 18:01:01,456 - run - INFO - ======================================================================
2025-11-03 18:01:01,457 - run - INFO - 
2025-11-03 18:01:01,458 - run - INFO - 
2025-11-03 18:01:01,458 - run - INFO - ======================================================================
2025-11-03 18:01:01,459 - run - INFO - COMPLETE! All systems operational!
2025-11-03 18:01:01,459 - run - INFO - ======================================================================
2025-11-03 18:01:01,460 - run - INFO - 
2025-11-03 18:01:01,460 - run - INFO - Services running:
2025-11-03 18:01:01,460 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-03 18:01:01,461 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (no login required)
2025-11-03 18:01:01,461 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-03 18:01:01,462 - run - INFO - 
2025-11-03 18:01:01,462 - run - INFO - Log Sources Active:
2025-11-03 18:01:01,463 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-03 18:01:01,463 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-03 18:01:01,463 - run - INFO -    [*] Windows System logs (real system events)
2025-11-03 18:01:01,464 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-03 18:01:01,464 - run - INFO - 
2025-11-03 18:01:01,465 - run - INFO - ======================================================================
2025-11-03 18:01:01,465 - run - INFO - 
2025-11-03 18:01:01,466 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-03 18:01:01,467 - run - INFO - ======================================================================
2025-11-03 18:04:53,565 - run - INFO - 
2025-11-03 18:04:53,566 - run - INFO - ======================================================================
2025-11-03 18:04:53,566 - run - INFO - Cleaning up all background processes...
2025-11-03 18:04:53,567 - run - INFO - ======================================================================
2025-11-03 18:04:53,568 - run - INFO -   [OK] Killed process PID 21908
2025-11-03 18:04:53,569 - run - INFO -   [OK] Killed process PID 4072
2025-11-03 18:04:53,570 - run - INFO -   [OK] Killed process PID 18576
2025-11-03 21:29:38,596 - run - INFO - ============================================================
2025-11-03 21:29:38,596 - run - INFO - ThreatOps SIEM Pipeline
2025-11-03 21:29:38,596 - run - INFO - ============================================================
2025-11-03 21:29:44,625 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 21:29:44,625 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 21:29:44,642 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 21:29:44,642 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 21:29:44,645 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 21:29:44,645 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 21:29:44,646 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 21:29:44,646 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 21:29:48,762 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.115s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F509EE9940>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:38:47,223 - run - INFO - ============================================================
2025-11-03 21:38:47,223 - run - INFO - ThreatOps SIEM Pipeline
2025-11-03 21:38:47,223 - run - INFO - ============================================================
2025-11-03 21:38:50,844 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 21:38:50,844 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 21:38:50,896 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 21:38:50,896 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 21:38:50,897 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 21:38:50,897 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 21:38:50,898 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 21:38:50,898 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 21:38:54,969 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.070s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000024902A0D7F0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:38:59,024 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.044s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000024902913D90>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:03,094 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.063s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000024902913ED0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:07,161 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.061s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000002490295A8B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:07,167 - detection.threat_detector - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x000002490295A8B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x000002490295A8B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 21:39:07,167 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 21:39:07,168 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 21:39:07,168 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 21:39:07,168 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 21:39:11,202 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.034s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000002490295AB10>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:15,268 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.058s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000024902979EB0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:19,320 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.045s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x00000249029D49E0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:23,385 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.057s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x00000249029D48D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:23,393 - enrichment.intel_enricher - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x00000249029D48D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x00000249029D48D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 21:39:23,393 - enrichment.intel_enricher - INFO - Initialized 3 threat intelligence APIs
2025-11-03 21:39:23,393 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 21:39:27,461 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.068s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x00000249029D5590>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:31,544 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.077s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x00000249029D5480>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:35,618 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.067s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x00000249029D56A0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:39,672 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.044s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x00000249029D58C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:39:39,678 - scoring.risk_scorer - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x00000249029D58C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x00000249029D58C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 21:39:39,679 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 21:39:39,679 - run - INFO - Initialization complete
2025-11-03 21:39:39,680 - run - INFO - Mode: Attack Simulation
2025-11-03 21:39:39,681 - run - INFO - === Running Attack Simulation ===
2025-11-03 21:39:39,682 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 21:39:39,683 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 21:39:39,683 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 21:39:39,684 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 21:39:39,685 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 21:39:39,685 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 21:39:39,686 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 21:39:39,686 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 21:39:39,686 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 21:39:39,686 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 21:39:39,695 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 21:39:39,702 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_213939_20251103_213939.json
2025-11-03 21:39:39,702 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 21:39:39,703 - run - INFO - ============================================================
2025-11-03 21:39:39,703 - run - INFO - Run completed successfully
2025-11-03 21:39:39,703 - run - INFO - ============================================================
2025-11-03 21:43:41,332 - run - INFO - ============================================================
2025-11-03 21:43:41,333 - run - INFO - ThreatOps SIEM Pipeline
2025-11-03 21:43:41,333 - run - INFO - ============================================================
2025-11-03 21:43:45,100 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 21:43:45,100 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 21:43:45,153 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 21:43:45,153 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 21:43:45,155 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 21:43:45,155 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 21:43:45,155 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 21:43:45,156 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 21:43:49,223 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.067s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E539D7F0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:43:53,273 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.036s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E52A3D90>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:43:57,339 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.057s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E52A3ED0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:01,433 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.088s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E52F28B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:01,439 - detection.threat_detector - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x000001F1E52F28B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x000001F1E52F28B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 21:44:01,440 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 21:44:01,440 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 21:44:01,440 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 21:44:01,440 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 21:44:05,511 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.070s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E52F2B10>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:09,571 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.052s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E5309EB0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:13,624 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.045s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E53688D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:17,681 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.052s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E53687C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:17,687 - enrichment.intel_enricher - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x000001F1E53687C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x000001F1E53687C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 21:44:17,687 - enrichment.intel_enricher - INFO - Initialized 3 threat intelligence APIs
2025-11-03 21:44:17,687 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 21:44:21,772 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.084s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E5369480>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:25,851 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.072s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E5369370>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:29,906 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.050s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E5369590>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:33,956 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.042s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001F1E53697B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:33,963 - scoring.risk_scorer - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x000001F1E53697B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x000001F1E53697B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 21:44:33,963 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 21:44:33,963 - run - INFO - Initialization complete
2025-11-03 21:44:33,964 - run - INFO - Mode: Attack Simulation
2025-11-03 21:44:33,965 - run - INFO - === Running Attack Simulation ===
2025-11-03 21:44:33,966 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 21:44:33,966 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 21:44:33,967 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 21:44:33,968 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 21:44:33,968 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 21:44:33,969 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 21:44:33,969 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 21:44:33,970 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 21:44:33,970 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 21:44:33,970 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 21:44:33,977 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 21:44:33,984 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_214433_20251103_214433.json
2025-11-03 21:44:33,984 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 21:44:33,985 - run - INFO - ============================================================
2025-11-03 21:44:33,985 - run - INFO - Run completed successfully
2025-11-03 21:44:33,985 - run - INFO - ============================================================
2025-11-03 21:44:48,069 - run - INFO - ============================================================
2025-11-03 21:44:48,069 - run - INFO - ThreatOps SIEM Pipeline
2025-11-03 21:44:48,069 - run - INFO - ============================================================
2025-11-03 21:44:51,504 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 21:44:51,504 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 21:44:51,556 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 21:44:51,556 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 21:44:51,559 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 21:44:51,559 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 21:44:51,560 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 21:44:51,560 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 21:44:55,641 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.081s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F258ED7F0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:44:59,707 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.054s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F257F3D90>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:03,778 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.063s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F257F3ED0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:07,879 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.094s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F258428B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:07,886 - detection.threat_detector - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019F258428B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019F258428B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 21:45:07,886 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 21:45:07,887 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 21:45:07,887 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 21:45:07,887 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 21:45:11,943 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.055s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F25842B10>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:16,028 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.077s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F25859EB0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:20,108 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.075s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F258B88D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:24,190 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.075s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F258B87C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:24,199 - enrichment.intel_enricher - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019F258B87C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019F258B87C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 21:45:24,199 - enrichment.intel_enricher - INFO - Initialized 3 threat intelligence APIs
2025-11-03 21:45:24,199 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 21:45:28,291 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.091s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F258B9480>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:32,381 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.083s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F258B9370>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:36,443 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.055s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F258B9590>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:40,509 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.059s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019F258B97B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-03 21:45:40,515 - scoring.risk_scorer - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019F258B97B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019F258B97B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-03 21:45:40,515 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 21:45:40,515 - run - INFO - Initialization complete
2025-11-03 21:45:40,516 - run - INFO - Mode: Attack Simulation
2025-11-03 21:45:40,517 - run - INFO - === Running Attack Simulation ===
2025-11-03 21:45:40,519 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 21:45:40,519 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 21:45:40,519 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 21:45:40,520 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 21:45:40,521 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 21:45:40,521 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 21:45:40,522 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 21:45:40,522 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 21:45:40,522 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 21:45:40,522 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 21:45:40,529 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 21:45:40,537 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_214540_20251103_214540.json
2025-11-03 21:45:40,537 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 21:45:40,538 - run - INFO - ============================================================
2025-11-03 21:45:40,538 - run - INFO - Run completed successfully
2025-11-03 21:45:40,538 - run - INFO - ============================================================
2025-11-03 22:02:31,045 - run - INFO - ======================================================================
2025-11-03 22:02:31,046 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-03 22:02:31,046 - run - INFO - ======================================================================
2025-11-03 22:02:31,046 - run - INFO - 
2025-11-03 22:02:31,047 - run - INFO - ======================================================================
2025-11-03 22:02:31,047 - run - INFO - [1/3] Starting OpenSearch...
2025-11-03 22:02:31,047 - run - INFO - ======================================================================
2025-11-03 22:02:31,134 - run - INFO - [OK] OpenSearch started
2025-11-03 22:02:31,135 - run - INFO -   Waiting for OpenSearch to become ready...
2025-11-03 22:02:35,421 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 1/12)
2025-11-03 22:02:49,491 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 2/12)
2025-11-03 22:03:03,562 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 3/12)
2025-11-03 22:03:17,630 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 4/12)
2025-11-03 22:03:31,168 - run - INFO - [OK] OpenSearch is healthy and ready
2025-11-03 22:03:31,169 - run - INFO - [OK] OpenSearch is ready and healthy
2025-11-03 22:03:31,171 - run - INFO - 
2025-11-03 22:03:31,171 - run - INFO - ======================================================================
2025-11-03 22:03:31,171 - run - INFO - [2/3] Starting Filebeat...
2025-11-03 22:03:31,172 - run - INFO - ======================================================================
2025-11-03 22:03:31,343 - run - INFO - [OK] Filebeat started
2025-11-03 22:03:31,344 - run - INFO -   Waiting 10 seconds for connection...
2025-11-03 22:03:41,345 - run - INFO - 
2025-11-03 22:03:41,347 - run - INFO - ======================================================================
2025-11-03 22:03:41,349 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-03 22:03:41,349 - run - INFO - ======================================================================
2025-11-03 22:03:43,953 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-03 22:03:43,954 - run - INFO -   URL: http://localhost:5601
2025-11-03 22:03:43,954 - run - INFO -   (Wait 90-120 seconds for it to fully start)
2025-11-03 22:03:43,954 - run - INFO - 
2025-11-03 22:03:43,955 - run - INFO - ======================================================================
2025-11-03 22:03:43,955 - run - INFO - [OK] All services started successfully!
2025-11-03 22:03:43,956 - run - INFO - ======================================================================
2025-11-03 22:03:43,956 - run - INFO - 
2025-11-03 22:03:43,960 - run - INFO - 
2025-11-03 22:03:43,961 - run - INFO - ======================================================================
2025-11-03 22:03:43,964 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-03 22:03:43,970 - run - INFO - ======================================================================
2025-11-03 22:03:48,248 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 22:03:48,249 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 22:03:48,304 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 22:03:48,305 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 22:03:48,307 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 22:03:48,309 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 22:03:48,310 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 22:03:48,310 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 22:03:48,332 - opensearch - INFO - GET http://localhost:9200/ [status:200 request:0.021s]
2025-11-03 22:03:48,333 - detection.threat_detector - INFO - Connected to OpenSearch and verified
2025-11-03 22:03:48,333 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 22:03:48,334 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 22:03:48,335 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 22:03:48,335 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 22:03:48,364 - opensearch - INFO - GET http://localhost:9200/ [status:200 request:0.028s]
2025-11-03 22:03:48,365 - enrichment.intel_enricher - INFO - Connected to OpenSearch and verified
2025-11-03 22:03:48,365 - enrichment.intel_enricher - INFO - Initialized 3 threat intelligence APIs
2025-11-03 22:03:48,365 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 22:03:48,386 - opensearch - INFO - GET http://localhost:9200/ [status:200 request:0.020s]
2025-11-03 22:03:48,386 - scoring.risk_scorer - INFO - Connected to OpenSearch and verified
2025-11-03 22:03:48,387 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 22:03:48,388 - run - INFO - Initialization complete
2025-11-03 22:03:48,389 - run - INFO - [OK] Pipeline initialized
2025-11-03 22:03:48,389 - run - INFO - 
2025-11-03 22:03:48,389 - run - INFO - 
2025-11-03 22:03:48,390 - run - INFO - ======================================================================
2025-11-03 22:03:48,390 - run - INFO - [5/7] Running Attack Simulation...
2025-11-03 22:03:48,391 - run - INFO - ======================================================================
2025-11-03 22:03:48,392 - run - INFO - === Running Attack Simulation ===
2025-11-03 22:03:48,394 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 22:03:48,395 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 22:03:48,396 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 22:03:48,397 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 22:03:48,398 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 22:03:48,399 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 22:03:48,400 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 22:03:48,401 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 22:03:48,401 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 22:03:48,401 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 22:03:48,409 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 22:03:48,415 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_220348_20251103_220348.json
2025-11-03 22:03:48,416 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 22:03:48,417 - run - INFO - [OK] Simulation complete
2025-11-03 22:03:48,418 - run - INFO - 
2025-11-03 22:03:48,418 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-03 22:04:03,418 - run - INFO - 
2025-11-03 22:04:03,419 - run - INFO - ======================================================================
2025-11-03 22:04:03,420 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-03 22:04:03,421 - run - INFO - ======================================================================
2025-11-03 22:04:03,423 - run - INFO - ========================================
2025-11-03 22:04:03,423 - run - INFO - Running Full SIEM Pipeline
2025-11-03 22:04:03,423 - run - INFO - ========================================
2025-11-03 22:04:03,424 - run - INFO - === Running Threat Detection ===
2025-11-03 22:04:03,575 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.150s]
2025-11-03 22:04:03,576 - detection.threat_detector - ERROR - Error querying OpenSearch: RequestError(400, 'search_phase_execution_exception', 'No mapping found for [@timestamp] in order to sort on')
2025-11-03 22:04:03,576 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-03 22:04:03,577 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-03 22:04:03,578 - run - INFO - [OK] Pipeline complete
2025-11-03 22:04:03,578 - run - INFO - 
2025-11-03 22:04:03,579 - run - INFO - 
2025-11-03 22:04:03,579 - run - INFO - ======================================================================
2025-11-03 22:04:03,579 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-03 22:04:03,580 - run - INFO - ======================================================================
2025-11-03 22:04:03,595 - run - INFO - [OK] Dashboard starting...
2025-11-03 22:04:03,596 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-03 22:04:08,597 - run - INFO - 
2025-11-03 22:04:08,598 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-03 22:04:08,598 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-03 22:04:12,646 - run - INFO - Waiting... (1/12)
2025-11-03 22:04:22,733 - run - INFO - [OK] OpenSearch Dashboards is ready! (attempt 2/12)
2025-11-03 22:04:22,734 - run - INFO - 
2025-11-03 22:04:22,734 - run - INFO - ======================================================================
2025-11-03 22:04:22,734 - run - INFO - Opening all dashboards in browser...
2025-11-03 22:04:22,735 - run - INFO - ======================================================================
2025-11-03 22:04:22,735 - run - INFO - Opening ThreatOps Dashboard...
2025-11-03 22:04:22,858 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-03 22:04:23,859 - run - INFO - Opening OpenSearch Dashboards...
2025-11-03 22:04:23,918 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (no login required)
2025-11-03 22:04:24,920 - run - INFO - Opening OpenSearch API...
2025-11-03 22:04:24,969 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-03 22:04:25,970 - run - INFO - 
2025-11-03 22:04:25,972 - run - INFO - [OK] All dashboards opened!
2025-11-03 22:04:25,973 - run - INFO - ======================================================================
2025-11-03 22:04:25,973 - run - INFO - 
2025-11-03 22:04:25,974 - run - INFO - 
2025-11-03 22:04:25,974 - run - INFO - ======================================================================
2025-11-03 22:04:25,974 - run - INFO - COMPLETE! All systems operational!
2025-11-03 22:04:25,975 - run - INFO - ======================================================================
2025-11-03 22:04:25,975 - run - INFO - 
2025-11-03 22:04:25,976 - run - INFO - Services running:
2025-11-03 22:04:25,976 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-03 22:04:25,977 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (no login required)
2025-11-03 22:04:25,978 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-03 22:04:25,978 - run - INFO - 
2025-11-03 22:04:25,978 - run - INFO - Log Sources Active:
2025-11-03 22:04:25,979 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-03 22:04:25,979 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-03 22:04:25,979 - run - INFO -    [*] Windows System logs (real system events)
2025-11-03 22:04:25,980 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-03 22:04:25,980 - run - INFO - 
2025-11-03 22:04:25,980 - run - INFO - ======================================================================
2025-11-03 22:04:25,981 - run - INFO - 
2025-11-03 22:04:25,981 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-03 22:04:25,982 - run - INFO - ======================================================================
2025-11-03 22:06:09,305 - run - INFO - 
2025-11-03 22:06:09,306 - run - INFO - ======================================================================
2025-11-03 22:06:09,306 - run - INFO - Cleaning up all background processes...
2025-11-03 22:06:09,307 - run - INFO - ======================================================================
2025-11-03 22:06:09,308 - run - INFO -   [OK] Killed process PID 19632
2025-11-03 22:06:09,309 - run - INFO -   [OK] Killed process PID 13724
2025-11-03 22:06:09,311 - run - INFO -   [OK] Killed process PID 2432
2025-11-03 22:06:09,330 - run - INFO -   [OK] Killed python.exe (PID 8536)
2025-11-03 22:10:06,700 - run - INFO - ======================================================================
2025-11-03 22:10:06,701 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-03 22:10:06,701 - run - INFO - ======================================================================
2025-11-03 22:10:06,702 - run - INFO - 
2025-11-03 22:10:06,702 - run - INFO - ======================================================================
2025-11-03 22:10:06,702 - run - INFO - [1/3] Starting OpenSearch...
2025-11-03 22:10:06,702 - run - INFO - ======================================================================
2025-11-03 22:10:06,725 - run - INFO - [OK] OpenSearch started
2025-11-03 22:10:06,725 - run - INFO -   Waiting for OpenSearch to become ready...
2025-11-03 22:10:11,007 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 1/12)
2025-11-03 22:10:25,092 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 2/12)
2025-11-03 22:10:39,146 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 3/12)
2025-11-03 22:10:53,200 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 4/12)
2025-11-03 22:11:04,123 - run - INFO - [OK] OpenSearch is healthy and ready
2025-11-03 22:11:04,123 - run - INFO - [OK] OpenSearch is ready and healthy
2025-11-03 22:11:04,124 - run - INFO - 
2025-11-03 22:11:04,125 - run - INFO - ======================================================================
2025-11-03 22:11:04,125 - run - INFO - [2/3] Starting Filebeat...
2025-11-03 22:11:04,126 - run - INFO - ======================================================================
2025-11-03 22:11:04,137 - run - INFO - [OK] Filebeat started
2025-11-03 22:11:04,137 - run - INFO -   Waiting 10 seconds for connection...
2025-11-03 22:11:14,138 - run - INFO - 
2025-11-03 22:11:14,139 - run - INFO - ======================================================================
2025-11-03 22:11:14,140 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-03 22:11:14,140 - run - INFO - ======================================================================
2025-11-03 22:11:14,151 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-03 22:11:14,152 - run - INFO -   URL: http://localhost:5601
2025-11-03 22:11:14,152 - run - INFO -   (Wait 90-120 seconds for it to fully start)
2025-11-03 22:11:14,152 - run - INFO - 
2025-11-03 22:11:14,153 - run - INFO - ======================================================================
2025-11-03 22:11:14,153 - run - INFO - [OK] All services started successfully!
2025-11-03 22:11:14,154 - run - INFO - ======================================================================
2025-11-03 22:11:14,154 - run - INFO - 
2025-11-03 22:11:14,155 - run - INFO - 
2025-11-03 22:11:14,155 - run - INFO - ======================================================================
2025-11-03 22:11:14,155 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-03 22:11:14,156 - run - INFO - ======================================================================
2025-11-03 22:11:18,584 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-03 22:11:18,584 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-03 22:11:18,640 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 22:11:18,641 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-03 22:11:18,642 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-03 22:11:18,643 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-03 22:11:18,644 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-03 22:11:18,644 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-03 22:11:18,665 - opensearch - INFO - GET http://localhost:9200/ [status:200 request:0.020s]
2025-11-03 22:11:18,666 - detection.threat_detector - INFO - Connected to OpenSearch and verified
2025-11-03 22:11:18,666 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-03 22:11:18,667 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-03 22:11:18,667 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-03 22:11:18,668 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-03 22:11:18,694 - opensearch - INFO - GET http://localhost:9200/ [status:200 request:0.025s]
2025-11-03 22:11:18,695 - enrichment.intel_enricher - INFO - Connected to OpenSearch and verified
2025-11-03 22:11:18,695 - enrichment.intel_enricher - INFO - Initialized 3 threat intelligence APIs
2025-11-03 22:11:18,695 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-03 22:11:18,721 - opensearch - INFO - GET http://localhost:9200/ [status:200 request:0.025s]
2025-11-03 22:11:18,722 - scoring.risk_scorer - INFO - Connected to OpenSearch and verified
2025-11-03 22:11:18,723 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-03 22:11:18,723 - run - INFO - Initialization complete
2025-11-03 22:11:18,724 - run - INFO - [OK] Pipeline initialized
2025-11-03 22:11:18,724 - run - INFO - 
2025-11-03 22:11:18,725 - run - INFO - 
2025-11-03 22:11:18,725 - run - INFO - ======================================================================
2025-11-03 22:11:18,726 - run - INFO - [5/7] Running Attack Simulation...
2025-11-03 22:11:18,726 - run - INFO - ======================================================================
2025-11-03 22:11:18,738 - run - INFO - === Running Attack Simulation ===
2025-11-03 22:11:18,741 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-03 22:11:18,741 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-03 22:11:18,742 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-03 22:11:18,743 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-03 22:11:18,744 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-03 22:11:18,744 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-03 22:11:18,745 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-03 22:11:18,746 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-03 22:11:18,746 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-03 22:11:18,747 - run - INFO - Generated 390 simulated attack log entries
2025-11-03 22:11:18,754 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-03 22:11:18,768 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251103_221118_20251103_221118.json
2025-11-03 22:11:18,769 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-03 22:11:18,770 - run - INFO - [OK] Simulation complete
2025-11-03 22:11:18,770 - run - INFO - 
2025-11-03 22:11:18,771 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-03 22:11:33,772 - run - INFO - 
2025-11-03 22:11:33,772 - run - INFO - ======================================================================
2025-11-03 22:11:33,773 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-03 22:11:33,773 - run - INFO - ======================================================================
2025-11-03 22:11:33,774 - run - INFO - ========================================
2025-11-03 22:11:33,775 - run - INFO - Running Full SIEM Pipeline
2025-11-03 22:11:33,775 - run - INFO - ========================================
2025-11-03 22:11:33,775 - run - INFO - === Running Threat Detection ===
2025-11-03 22:11:33,810 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:400 request:0.034s]
2025-11-03 22:11:33,811 - detection.threat_detector - INFO - No @timestamp field found in indices, querying all logs without timestamp filter
2025-11-03 22:11:34,280 - opensearch - INFO - POST http://localhost:9200/filebeat-*/_search [status:200 request:0.467s]
2025-11-03 22:11:34,349 - detection.threat_detector - INFO - Retrieved 5460 logs from OpenSearch
2025-11-03 22:11:34,355 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-03 22:11:34,355 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-03 22:11:34,356 - run - INFO - [OK] Pipeline complete
2025-11-03 22:11:34,356 - run - INFO - 
2025-11-03 22:11:34,357 - run - INFO - 
2025-11-03 22:11:34,357 - run - INFO - ======================================================================
2025-11-03 22:11:34,357 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-03 22:11:34,357 - run - INFO - ======================================================================
2025-11-03 22:11:34,370 - run - INFO - [OK] Dashboard starting...
2025-11-03 22:11:34,370 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-03 22:11:39,371 - run - INFO - 
2025-11-03 22:11:39,372 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-03 22:11:39,373 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-03 22:11:39,421 - run - INFO - [OK] OpenSearch Dashboards is ready! (attempt 1/12)
2025-11-03 22:11:39,422 - run - INFO - 
2025-11-03 22:11:39,423 - run - INFO - ======================================================================
2025-11-03 22:11:39,423 - run - INFO - Opening all dashboards in browser...
2025-11-03 22:11:39,424 - run - INFO - ======================================================================
2025-11-03 22:11:39,424 - run - INFO - Opening ThreatOps Dashboard...
2025-11-03 22:11:39,571 - run - INFO -   [OK] http://localhost:8501 - Main SIEM interface
2025-11-03 22:11:40,573 - run - INFO - Opening OpenSearch Dashboards...
2025-11-03 22:11:40,655 - run - INFO -   [OK] http://localhost:5601 - Advanced analytics (no login required)
2025-11-03 22:11:41,657 - run - INFO - Opening OpenSearch API...
2025-11-03 22:11:41,726 - run - INFO -   [OK] http://localhost:9200 - Backend API & cluster info
2025-11-03 22:11:42,728 - run - INFO - 
2025-11-03 22:11:42,729 - run - INFO - [OK] All dashboards opened!
2025-11-03 22:11:42,729 - run - INFO - ======================================================================
2025-11-03 22:11:42,730 - run - INFO - 
2025-11-03 22:11:42,731 - run - INFO - 
2025-11-03 22:11:42,732 - run - INFO - ======================================================================
2025-11-03 22:11:42,732 - run - INFO - COMPLETE! All systems operational!
2025-11-03 22:11:42,733 - run - INFO - ======================================================================
2025-11-03 22:11:42,734 - run - INFO - 
2025-11-03 22:11:42,734 - run - INFO - Services running:
2025-11-03 22:11:42,735 - run - INFO -    ThreatOps UI:      http://localhost:8501  <- Your main SIEM dashboard
2025-11-03 22:11:42,735 - run - INFO -    OpenSearch DB:     http://localhost:5601  <- Advanced analytics (NO LOGIN NEEDED - anonymous access enabled)
2025-11-03 22:11:42,736 - run - INFO -    OpenSearch API:    http://localhost:9200  <- Backend (for developers)
2025-11-03 22:11:42,737 - run - INFO - 
2025-11-03 22:11:42,737 - run - INFO - Log Sources Active:
2025-11-03 22:11:42,738 - run - INFO -    [*] Simulated attacks (MITRE ATT&CK scenarios)
2025-11-03 22:11:42,738 - run - INFO -    [*] Windows Security logs (real system events)
2025-11-03 22:11:42,738 - run - INFO -    [*] Windows System logs (real system events)
2025-11-03 22:11:42,739 - run - INFO -    [*] Windows Application logs (real system events)
2025-11-03 22:11:42,740 - run - INFO - 
2025-11-03 22:11:42,742 - run - INFO - ======================================================================
2025-11-03 22:11:42,742 - run - INFO - 
2025-11-03 22:11:42,743 - run - INFO - [!] Press Enter to EXIT and close all background services
2025-11-03 22:11:42,744 - run - INFO - 
2025-11-03 22:11:42,744 - run - INFO - NOTE: Java warnings in OpenSearch console are harmless - they're from
2025-11-03 22:11:42,744 - run - INFO -       deprecated Java APIs that OpenSearch uses. The window stays
2025-11-03 22:11:42,745 - run - INFO -       open because OpenSearch runs continuously in the background.
2025-11-03 22:11:42,745 - run - INFO - ======================================================================
2025-11-04 08:39:49,175 - run - INFO - ======================================================================
2025-11-04 08:39:49,177 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-04 08:39:49,177 - run - INFO - ======================================================================
2025-11-04 08:39:49,178 - run - INFO - 
2025-11-04 08:39:49,178 - run - INFO - ======================================================================
2025-11-04 08:39:49,178 - run - INFO - [1/3] Starting OpenSearch...
2025-11-04 08:39:49,179 - run - INFO - ======================================================================
2025-11-04 08:39:49,259 - run - INFO - [OK] OpenSearch started
2025-11-04 08:39:49,260 - run - INFO -   Waiting for OpenSearch to become ready...
2025-11-04 08:39:53,670 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 1/12)
2025-11-04 08:40:07,735 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 2/12)
2025-11-04 08:40:21,801 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 3/12)
2025-11-04 08:40:35,928 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 4/12)
2025-11-04 08:40:49,997 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 5/12)
2025-11-04 08:41:04,063 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 6/12)
2025-11-04 08:41:18,159 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 7/12)
2025-11-04 08:41:32,249 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 8/12)
2025-11-04 08:41:46,319 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 9/12)
2025-11-04 08:42:00,392 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 10/12)
2025-11-04 08:42:14,453 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 11/12)
2025-11-04 08:42:28,552 - run - ERROR - [X] OpenSearch is not responding after all retry attempts
2025-11-04 08:42:28,553 - run - ERROR - [X] OpenSearch failed to become healthy - pipeline may not work correctly
2025-11-04 08:42:28,554 - run - INFO - 
2025-11-04 08:42:28,554 - run - INFO - ======================================================================
2025-11-04 08:42:28,555 - run - INFO - [2/3] Starting Filebeat...
2025-11-04 08:42:28,555 - run - INFO - ======================================================================
2025-11-04 08:42:28,820 - run - INFO - [OK] Filebeat started
2025-11-04 08:42:28,821 - run - INFO -   Waiting 10 seconds for connection...
2025-11-04 08:42:38,823 - run - INFO - 
2025-11-04 08:42:38,823 - run - INFO - ======================================================================
2025-11-04 08:42:38,824 - run - INFO - [3/3] Starting OpenSearch Dashboards...
2025-11-04 08:42:38,824 - run - INFO - ======================================================================
2025-11-04 08:42:40,569 - run - INFO - [OK] OpenSearch Dashboards started
2025-11-04 08:42:40,570 - run - INFO -   URL: http://localhost:5601
2025-11-04 08:42:40,571 - run - INFO -   (Wait 90-120 seconds for it to fully start)
2025-11-04 08:42:40,572 - run - INFO - 
2025-11-04 08:42:40,572 - run - INFO - ======================================================================
2025-11-04 08:42:40,573 - run - INFO - [OK] All services started successfully!
2025-11-04 08:42:40,573 - run - INFO - ======================================================================
2025-11-04 08:42:40,573 - run - INFO - 
2025-11-04 08:42:40,574 - run - INFO - 
2025-11-04 08:42:40,577 - run - INFO - ======================================================================
2025-11-04 08:42:40,578 - run - INFO - [4/7] Initializing ThreatOps Pipeline...
2025-11-04 08:42:40,579 - run - INFO - ======================================================================
2025-11-04 08:43:10,747 - simulation.attack_simulator - INFO - Loaded 8 attack scenarios
2025-11-04 08:43:10,748 - detection.threat_detector - INFO - Loaded 3 detection rules
2025-11-04 08:43:10,769 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-04 08:43:10,770 - scoring.risk_scorer - INFO - Loaded 8 MITRE ATT&CK techniques
2025-11-04 08:43:10,775 - run - INFO - Initializing ThreatOps SIEM Pipeline components...
2025-11-04 08:43:10,776 - simulation.attack_simulator - INFO - Initializing attack simulator...
2025-11-04 08:43:10,779 - simulation.attack_simulator - INFO - Attack simulator initialized successfully
2025-11-04 08:43:10,780 - detection.threat_detector - INFO - Initializing threat detector...
2025-11-04 08:43:14,832 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.050s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A86B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:19,098 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.059s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A88D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:23,155 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.044s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A89E0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:27,226 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.061s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A8C00>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:27,236 - detection.threat_detector - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019CC98A8C00>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019CC98A8C00>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-04 08:43:27,237 - detection.threat_detector - INFO - Initializing ML detector...
2025-11-04 08:43:27,238 - detection.threat_detector - INFO - ML detector initialized successfully
2025-11-04 08:43:27,239 - detection.threat_detector - INFO - Threat detector initialized successfully
2025-11-04 08:43:27,239 - enrichment.intel_enricher - INFO - Initializing threat intelligence enricher...
2025-11-04 08:43:31,314 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.074s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A8E20>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:35,397 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.060s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A8C00>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:39,468 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.062s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A8F30>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:43,552 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.074s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A8D10>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:43,562 - enrichment.intel_enricher - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019CC98A8D10>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019CC98A8D10>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-04 08:43:43,563 - enrichment.intel_enricher - INFO - Initialized 3 threat intelligence APIs
2025-11-04 08:43:43,563 - scoring.risk_scorer - INFO - Initializing risk scorer...
2025-11-04 08:43:47,642 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.078s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A8AF0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:51,729 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.068s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A86B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:55,808 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.070s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A9150>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:59,887 - opensearch - WARNING - GET http://localhost:9200/ [status:N/A request:4.069s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A9480>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:43:59,897 - scoring.risk_scorer - ERROR - Failed to connect to OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019CC98A9480>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019CC98A9480>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-04 08:43:59,899 - scoring.risk_scorer - INFO - Risk scorer initialized successfully
2025-11-04 08:43:59,899 - run - INFO - Initialization complete
2025-11-04 08:43:59,902 - run - INFO - [OK] Pipeline initialized
2025-11-04 08:43:59,904 - run - INFO - 
2025-11-04 08:43:59,904 - run - INFO - 
2025-11-04 08:43:59,905 - run - INFO - ======================================================================
2025-11-04 08:43:59,905 - run - INFO - [5/7] Running Attack Simulation...
2025-11-04 08:43:59,906 - run - INFO - ======================================================================
2025-11-04 08:43:59,908 - run - INFO - === Running Attack Simulation ===
2025-11-04 08:43:59,911 - simulation.attack_simulator - INFO - Generated 100 logs for scenario: Brute Force Attack
2025-11-04 08:43:59,912 - simulation.attack_simulator - INFO - Generated 20 logs for scenario: Privilege Escalation
2025-11-04 08:43:59,914 - simulation.attack_simulator - INFO - Generated 30 logs for scenario: Suspicious PowerShell
2025-11-04 08:43:59,916 - simulation.attack_simulator - INFO - Generated 80 logs for scenario: Lateral Movement
2025-11-04 08:43:59,918 - simulation.attack_simulator - INFO - Generated 40 logs for scenario: Data Exfiltration
2025-11-04 08:43:59,920 - simulation.attack_simulator - INFO - Generated 25 logs for scenario: Malware Execution
2025-11-04 08:43:59,922 - simulation.attack_simulator - INFO - Generated 60 logs for scenario: Command and Control
2025-11-04 08:43:59,923 - simulation.attack_simulator - INFO - Generated 35 logs for scenario: Persistence
2025-11-04 08:43:59,924 - simulation.attack_simulator - INFO - Total attack logs generated: 390
2025-11-04 08:43:59,924 - run - INFO - Generated 390 simulated attack log entries
2025-11-04 08:43:59,939 - simulation.attack_simulator - INFO - Wrote 390 simulation logs to data\sim_attacks.log for Filebeat collection
2025-11-04 08:43:59,956 - simulation.attack_simulator - INFO - Saved 390 simulation logs to data\simulations\simulation_all_scenarios_20251104_084359_20251104_084359.json
2025-11-04 08:43:59,956 - run - INFO - [SUCCESS] Simulation complete - logs written to data/sim_attacks.log for Filebeat
2025-11-04 08:43:59,959 - run - INFO - [OK] Simulation complete
2025-11-04 08:43:59,960 - run - INFO - 
2025-11-04 08:43:59,960 - run - INFO -   Waiting 15 seconds for log indexing...
2025-11-04 08:44:14,961 - run - INFO - 
2025-11-04 08:44:14,963 - run - INFO - ======================================================================
2025-11-04 08:44:14,964 - run - INFO - [6/7] Running Detection Pipeline...
2025-11-04 08:44:14,964 - run - INFO - ======================================================================
2025-11-04 08:44:14,967 - run - INFO - ========================================
2025-11-04 08:44:14,967 - run - INFO - Running Full SIEM Pipeline
2025-11-04 08:44:14,969 - run - INFO - ========================================
2025-11-04 08:44:14,969 - run - INFO - === Running Threat Detection ===
2025-11-04 08:44:19,033 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.063s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A99D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:44:23,105 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.062s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A96A0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:44:27,174 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.060s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A9AE0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:44:31,250 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.066s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A9D00>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:44:31,260 - detection.threat_detector - INFO - No @timestamp field found in indices, querying all logs without timestamp filter
2025-11-04 08:44:35,345 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.084s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98A9F20>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:44:39,436 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.082s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98AA140>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:44:43,522 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.075s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98AA360>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:44:47,588 - opensearch - WARNING - POST http://localhost:9200/filebeat-*/_search [status:N/A request:4.057s]
Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\opensearchpy\connection\http_urllib3.py", line 280, in perform_request
    response = self.pool.urlopen(
        method, url, body, retries=Retry(False), headers=request_headers, **kw
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\util\util.py", line 39, in reraise
    raise value
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "C:\Users\Manichand Gupta\AppData\Local\Programs\Python\Python313\Lib\http\client.py", line 1037, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "D:\Cusor AI\threat_ops\.venv\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000019CC98AA580>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it
2025-11-04 08:44:47,599 - detection.threat_detector - ERROR - Error querying OpenSearch: ConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019CC98AA580>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it) caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x0000019CC98AA580>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it)
2025-11-04 08:44:47,600 - run - INFO - [SUCCESS] Detection complete - generated 0 alerts in OpenSearch
2025-11-04 08:44:47,600 - run - WARNING - No alerts detected, skipping enrichment and scoring
2025-11-04 08:44:47,602 - run - INFO - [OK] Pipeline complete
2025-11-04 08:44:47,603 - run - INFO - 
2025-11-04 08:44:47,603 - run - INFO - 
2025-11-04 08:44:47,604 - run - INFO - ======================================================================
2025-11-04 08:44:47,604 - run - INFO - [7/7] Starting ThreatOps Dashboard...
2025-11-04 08:44:47,605 - run - INFO - ======================================================================
2025-11-04 08:44:47,764 - run - INFO - [OK] Dashboard starting...
2025-11-04 08:44:47,766 - run - INFO -   Waiting 5 seconds for Streamlit to start...
2025-11-04 08:44:52,769 - run - INFO - 
2025-11-04 08:44:52,770 - run - INFO - Waiting for OpenSearch Dashboards to be ready...
2025-11-04 08:44:52,770 - run - INFO - (This can take 90-120 seconds - checking every 10 seconds)
2025-11-04 08:44:56,825 - run - INFO - Waiting... (1/12)
2025-11-04 08:45:10,926 - run - INFO - Waiting... (2/12)
2025-11-04 08:45:24,999 - run - INFO - Waiting... (3/12)
2025-11-04 08:45:39,122 - run - INFO - Waiting... (4/12)
2025-11-04 08:45:53,169 - run - INFO - Waiting... (5/12)
2025-11-04 08:46:07,271 - run - INFO - Waiting... (6/12)
2025-11-04 08:46:21,373 - run - INFO - Waiting... (7/12)
2025-11-04 08:46:33,442 - run - INFO - Waiting... (8/12)
2025-11-04 08:46:33,814 - run - INFO - Interrupted by user
2025-11-04 08:52:09,348 - run - INFO - ======================================================================
2025-11-04 08:52:09,348 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-04 08:52:09,349 - run - INFO - ======================================================================
2025-11-04 08:52:09,349 - run - INFO - 
2025-11-04 08:52:09,349 - run - INFO - ======================================================================
2025-11-04 08:52:09,350 - run - INFO - [1/3] Starting OpenSearch...
2025-11-04 08:52:09,350 - run - INFO - ======================================================================
2025-11-04 08:52:09,431 - run - INFO - [OK] OpenSearch started
2025-11-04 08:52:09,432 - run - INFO -   Waiting for OpenSearch to become ready...
2025-11-04 08:52:13,691 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 1/12)
2025-11-04 08:52:27,753 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 2/12)
2025-11-04 08:52:41,804 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 3/12)
2025-11-04 08:52:55,897 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 4/12)
2025-11-04 08:53:09,986 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 5/12)
2025-11-04 08:53:24,088 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 6/12)
2025-11-04 08:53:38,147 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 7/12)
2025-11-04 08:53:52,191 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 8/12)
2025-11-04 08:54:06,266 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 9/12)
2025-11-04 08:54:15,266 - run - INFO - Interrupted by user
2025-11-04 08:57:23,645 - run - INFO - ======================================================================
2025-11-04 08:57:23,645 - run - INFO - THREATOPS SIEM - COMPLETE STARTUP
2025-11-04 08:57:23,645 - run - INFO - ======================================================================
2025-11-04 08:57:23,645 - run - INFO - 
2025-11-04 08:57:23,645 - run - INFO - ======================================================================
2025-11-04 08:57:23,645 - run - INFO - [1/3] Starting OpenSearch...
2025-11-04 08:57:23,645 - run - INFO - ======================================================================
2025-11-04 08:57:23,655 - run - INFO - [OK] OpenSearch started
2025-11-04 08:57:23,656 - run - INFO -   Waiting for OpenSearch to become ready...
2025-11-04 08:57:27,871 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 1/12)
2025-11-04 08:57:41,910 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 2/12)
2025-11-04 08:57:55,962 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 3/12)
2025-11-04 08:58:10,038 - run - INFO - OpenSearch not responding, waiting 10s... (attempt 4/12)
2025-11-04 08:58:17,065 - run - INFO - Interrupted by user
